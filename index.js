import*as n from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import{klona as e}from'https://testingcf.jsdelivr.net/npm/klona/+esm';import{getScriptIdSafe as t}from'https://testingcf.jsdelivr.net/npm/ËÆ∞ÂøÜ/utils/+esm';var o={35:(e,t,o)=>{e.exports=(n=>{var e={};return o.d(e,n),e})({createPinia:()=>n.createPinia,defineStore:()=>n.defineStore,storeToRefs:()=>n.storeToRefs})},42:(n,e)=>{e.A=(n,e)=>{const t=n.__vccOpts||n;for(const[n,o]of e)t[n]=o;return t}},54:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t='',o=void 0!==e[5];return e[4]&&(t+='@supports ('.concat(e[4],') {')),e[2]&&(t+='@media '.concat(e[2],' {')),o&&(t+='@layer'.concat(e[5].length>0?' '.concat(e[5]):'',' {')),t+=n(e),o&&(t+='}'),e[2]&&(t+='}'),e[4]&&(t+='}'),t}).join('')},e.i=function(n,t,o,a,r){'string'==typeof n&&(n=[[null,n,void 0]]);var s={};if(o)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var d=0;d<n.length;d++){var c=[].concat(n[d]);o&&s[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]='@layer'.concat(c[5].length>0?' '.concat(c[5]):'',' {').concat(c[1],'}')),c[5]=r),t&&(c[2]?(c[1]='@media '.concat(c[2],' {').concat(c[1],'}'),c[2]=t):c[2]=t),a&&(c[4]?(c[1]='@supports ('.concat(c[4],') {').concat(c[1],'}'),c[4]=a):c[4]=''.concat(a)),e.push(c))}},e}},55:(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});var o=t(790),a=t.n(o),r=t(54),s=t.n(r)()(a());s.push([n.id,'.table-tab[data-v-0416f1c6]{height:100%;overflow-y:auto;padding:25px !important}.section-header[data-v-0416f1c6]{display:flex;justify-content:space-between;align-items:center;padding:20px 25px !important;border-bottom:1px solid #3a3a3a;margin-bottom:5px}.section-header h3[data-v-0416f1c6]{margin:0;color:#fff;font-size:15px !important;font-weight:bold;display:flex;align-items:center;gap:8px}.count-badge[data-v-0416f1c6]{background:#4a9eff;color:white;padding:4px 8px;border-radius:12px;font-size:12px}.empty-state[data-v-0416f1c6]{text-align:center;padding:40px 20px;color:#888}.empty-state i[data-v-0416f1c6]{font-size:48px;margin-bottom:10px;opacity:0.3}.empty-state p[data-v-0416f1c6]{margin:10px 0;font-size:14px}.empty-state small[data-v-0416f1c6]{color:#666;font-size:12px}.history-list[data-v-0416f1c6]{display:flex;flex-direction:column;gap:10px;padding:15px 20px}.history-item[data-v-0416f1c6]{background:#2a2a2a;border:1px solid #3a3a3a;border-radius:6px;overflow:hidden;transition:border-color 0.2s}.history-item[data-v-0416f1c6]:hover{border-color:#4a4a4a}.history-header[data-v-0416f1c6]{padding:12px 15px;background:#1a1a1a;display:flex;justify-content:space-between;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;transition:background 0.2s}.history-header[data-v-0416f1c6]:hover{background:#2a2a2a}.history-info[data-v-0416f1c6]{display:flex;align-items:center;gap:10px;flex:1}.history-number[data-v-0416f1c6]{color:#4a9eff;font-weight:bold}.history-range[data-v-0416f1c6]{color:#888;font-size:12px}.expand-icon[data-v-0416f1c6]{color:#888;font-size:12px}.history-content[data-v-0416f1c6]{padding:15px;background:#2a2a2a}.history-actions[data-v-0416f1c6]{display:flex;gap:8px;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #3a3a3a}.mini-button[data-v-0416f1c6]{flex:1;padding:6px 12px;background:#2a2a2a;border:1px solid #3a3a3a;border-radius:4px;color:#e0e0e0;cursor:pointer;font-size:12px;transition:background 0.2s}.mini-button[data-v-0416f1c6]:hover{background:#3a3a3a}.mini-button.delete-button[data-v-0416f1c6]:hover{background:#ff4444;border-color:#ff4444;color:white}.table-display[data-v-0416f1c6]{margin-top:15px;overflow-x:auto;max-height:400px;overflow-y:auto;border-radius:6px;background:#1a1a1a}.table-display table[data-v-0416f1c6]{width:100%;font-size:12px;border-collapse:collapse}.table-display th[data-v-0416f1c6],.table-display td[data-v-0416f1c6]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px;padding:8px;border:1px solid #444}.table-display th[data-v-0416f1c6]{background:#2a2a2a;font-weight:bold;color:#fff}.table-display td[data-v-0416f1c6]{color:#e0e0e0}.copy-button:hover .shimmer-effect[data-v-0416f1c6],.delete-button:hover .shimmer-effect[data-v-0416f1c6]{left:100%}.copy-button[data-v-0416f1c6]:hover{transform:translateY(-1px);box-shadow:0 5px 15px rgba(40,167,69,0.4)}.delete-button[data-v-0416f1c6]:hover{transform:translateY(-1px);box-shadow:0 5px 15px rgba(255,107,107,0.4)}\n','',{version:3,sources:['webpack://./src/ËÆ∞ÂøÜ/components/TableTab.vue'],names:[],mappings:'AAomBA,4BACE,WAAY,CACZ,eAAgB,CAChB,uBACF,CAEA,iCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,4BAA6B,CAC7B,+BAAgC,CAChC,iBACF,CAEA,oCACE,QAAS,CACT,UAAW,CACX,yBAA0B,CAC1B,gBAAiB,CACjB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,8BACE,kBAAmB,CACnB,WAAY,CACZ,eAAgB,CAChB,kBAAmB,CACnB,cACF,CAEA,8BACE,iBAAkB,CAClB,iBAAkB,CAClB,UACF,CAEA,gCACE,cAAe,CACf,kBAAmB,CACnB,WACF,CAEA,gCACE,aAAc,CACd,cACF,CAEA,oCACE,UAAW,CACX,cACF,CAEA,+BACE,YAAa,CACb,qBAAsB,CACtB,QAAS,CACT,iBACF,CAEA,+BACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,eAAgB,CAChB,4BACF,CAEA,qCACE,oBACF,CAEA,iCACE,iBAAkB,CAClB,kBAAmB,CACnB,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,cAAe,CACf,wBAAiB,CAAjB,gBAAiB,CACjB,0BACF,CAEA,uCACE,kBACF,CAEA,+BACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,MACF,CAEA,iCACE,aAAc,CACd,gBACF,CAEA,gCACE,UAAW,CACX,cACF,CAEA,8BACE,UAAW,CACX,cACF,CAEA,kCACE,YAAa,CACb,kBACF,CAEA,kCACE,YAAa,CACb,OAAQ,CACR,kBAAmB,CACnB,kBAAmB,CACnB,+BACF,CAEA,8BACE,MAAO,CACP,gBAAiB,CACjB,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,aAAc,CACd,cAAe,CACf,cAAe,CACf,0BACF,CAEA,oCACE,kBACF,CAEA,kDACE,kBAAmB,CACnB,oBAAqB,CACrB,WACF,CAEA,gCACE,eAAgB,CAChB,eAAgB,CAChB,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,kBACF,CAEA,sCACE,UAAW,CACX,cAAe,CACf,wBACF,CAEA,sEAEE,kBAAmB,CACnB,eAAgB,CAChB,sBAAuB,CACvB,eAAgB,CAChB,WAAY,CACZ,qBACF,CAEA,mCACE,kBAAmB,CACnB,gBAAiB,CACjB,UACF,CAEA,mCACE,aACF,CAGA,0GAEE,SACF,CAEA,oCACE,0BAA2B,CAC3B,yCACF,CAEA,sCACE,0BAA2B,CAC3B,2CACF',sourcesContent:['<template>\n  <div class="table-tab" style="padding: 25px !important; background: #1a1a1a !important">\n    <div\n      class="section-header"\n      style="\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 20px 25px !important;\n        border-bottom: 1px solid #3a3a3a;\n        margin-bottom: 5px;\n      "\n    >\n      <h3\n        style="\n          margin: 0;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        üìä Ë°®Ê†ºÂàÜÊûê\n      </h3>\n      <span\n        v-if="table_history.length > 0"\n        class="count-badge"\n        style="background: #4a9eff; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px"\n        >{{ table_history.length }} Êù°ËÆ∞ÂΩï</span\n      >\n    </div>\n\n    \x3c!-- Ë°®Ê†ºÂéÜÂè≤ÂàóË°® --\x3e\n    <div\n      v-if="table_history && table_history.length > 0"\n      class="history-list"\n      style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px"\n    >\n      <div\n        v-for="(item, index) in table_history"\n        :key="index"\n        class="history-item"\n        style="\n          background: #2a2a2a;\n          border: 1px solid #444;\n          border-radius: 8px;\n          padding: 15px;\n          transition: all 0.3s ease;\n        "\n      >\n        <div\n          class="history-header"\n          style="\n            padding: 12px 15px;\n            background: #1a1a1a;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            cursor: pointer;\n            user-select: none;\n            transition: background 0.2s;\n            border-radius: 6px;\n          "\n          @click="toggleTableExpanded(index)"\n        >\n          <div class="history-info" style="display: flex; align-items: center; gap: 10px; flex: 1">\n            <span class="history-number" style="color: #4a9eff; font-weight: bold">#{{ index + 1 }}</span>\n            <span class="history-range" style="color: #888; font-size: 12px"\n              >Ê•ºÂ±Ç {{ item.start_id }} - {{ item.end_id }}</span\n            >\n          </div>\n          <span class="expand-icon" style="color: #888; font-size: 12px">{{\n            isTableExpanded(index) ? \'‚ñº\' : \'‚ñ∂\'\n          }}</span>\n        </div>\n        <div\n          v-if="isTableExpanded(index)"\n          class="history-content"\n          style="padding: 15px; background: #2a2a2a; border-radius: 0 0 6px 6px"\n        >\n          <div\n            class="history-actions"\n            style="\n              display: flex;\n              gap: 10px;\n              margin-bottom: 12px;\n              padding-bottom: 8px;\n              border-bottom: 1px solid #3a3a3a;\n              flex-wrap: wrap;\n            "\n          >\n            <button\n              class="copy-button"\n              style="\n                padding: 8px 16px;\n                background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n                border: none;\n                border-radius: 6px;\n                color: white;\n                cursor: pointer;\n                font-size: 12px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                box-shadow: 0 3px 12px rgba(40, 167, 69, 0.3);\n                position: relative;\n                overflow: hidden;\n              "\n              @click="copyTable(item)"\n            >\n              <div\n                style="\n                  position: absolute;\n                  top: 0;\n                  left: -100%;\n                  width: 100%;\n                  height: 100%;\n                  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                  transition: left 0.5s;\n                "\n                class="shimmer-effect"\n              ></div>\n              <i class="fa-solid fa-copy" style="font-size: 12px"></i> Â§çÂà∂\n            </button>\n            <button\n              class="delete-button"\n              style="\n                padding: 8px 16px;\n                background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);\n                border: none;\n                border-radius: 6px;\n                color: white;\n                cursor: pointer;\n                font-size: 12px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                box-shadow: 0 3px 12px rgba(255, 107, 107, 0.3);\n                position: relative;\n                overflow: hidden;\n              "\n              @click="deleteTable(index)"\n            >\n              <div\n                style="\n                  position: absolute;\n                  top: 0;\n                  left: -100%;\n                  width: 100%;\n                  height: 100%;\n                  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                  transition: left 0.5s;\n                "\n                class="shimmer-effect"\n              ></div>\n              <i class="fa-solid fa-trash" style="font-size: 12px"></i> Âà†Èô§\n            </button>\n          </div>\n          <div class="table-display" style="overflow-x: auto; border-radius: 6px; border: 1px solid #3a3a3a">\n            <table style="width: 100%; border-collapse: collapse; background: #1a1a1a">\n              <thead style="background: #2a2a2a">\n                <tr>\n                  <th\n                    v-for="(header, idx) in item.headers"\n                    :key="idx"\n                    style="\n                      padding: 12px 16px;\n                      text-align: left;\n                      font-weight: bold;\n                      color: #fff;\n                      border-bottom: 2px solid #3a3a3a;\n                      border-right: 1px solid #3a3a3a;\n                    "\n                  >\n                    {{ header }}\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for="(row, rowIdx) in item.data" :key="rowIdx" style="border-bottom: 1px solid #3a3a3a">\n                  <td\n                    v-for="(cell, cellIdx) in row"\n                    :key="cellIdx"\n                    style="padding: 10px 16px; color: #e0e0e0; border-right: 1px solid #3a3a3a"\n                  >\n                    {{ cell }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-else class="empty-state" style="text-align: center; padding: 40px 20px; color: #888">\n      <i class="fa-solid fa-table" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3"></i>\n      <p style="margin: 10px 0; font-size: 16px">ËøòÊ≤°ÊúâË°®Ê†ºËÆ∞ÂΩï</p>\n      <small style="font-size: 12px; color: #666">‰ΩøÁî®"ËÆæÁΩÆ"Ê†áÁ≠æÈ°µÊâãÂä®ÁîüÊàêË°®Ê†º</small>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref } from \'vue\';\nimport { getChatIdSafe } from \'../utils\';\n\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\nconst table_history = ref<Array<{ start_id: number; end_id: number; headers: string[]; data: string[][] }>>([]);\nconst tableExpandedState = ref<Map<number, boolean>>(new Map());\n\n// Êõ¥Êñ∞Ë°®Ê†ºÂéÜÂè≤ÁöÑÂáΩÊï∞\nconst refreshTableHistory = () => {\n  try {\n    const chat_id = getChatIdSafe();\n    if (!chat_id) {\n      console.warn(\'Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåÊ∏ÖÁ©∫Ë°®Ê†ºÂéÜÂè≤\');\n      table_history.value = [];\n      return;\n    }\n\n    const chat_vars = getVariables({ type: \'chat\' });\n    console.log(\'‰ªéËÅäÂ§©ÂèòÈáèËØªÂèñÁöÑÊï∞ÊçÆ:\', chat_vars);\n    console.log(\'Ë°®Ê†ºÂéÜÂè≤Êï∞ÊçÆ:\', chat_vars.table_history);\n\n    table_history.value = chat_vars.table_history || [];\n    console.log(\'Â∑≤Âà∑Êñ∞Ë°®Ê†ºÂéÜÂè≤ÔºåÂΩìÂâçËÅäÂ§©Ë°®Ê†ºÊï∞:\', table_history.value.length);\n  } catch (e) {\n    console.error(\'Âà∑Êñ∞Ë°®Ê†ºÂéÜÂè≤Â§±Ë¥•:\', e);\n    table_history.value = [];\n  }\n};\n\n// ÂàáÊç¢Ë°®Ê†ºÂ±ïÂºÄÁä∂ÊÄÅ\nconst toggleTableExpanded = (index: number) => {\n  const current = tableExpandedState.value.get(index) || false;\n  tableExpandedState.value.set(index, !current);\n};\n\nconst isTableExpanded = (index: number) => {\n  return tableExpandedState.value.get(index) || false;\n};\n\n// Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞ - ÈíàÂØπiframeÁéØÂ¢É‰ºòÂåñ\nconst copyToClipboard = async (text: string, successMessage: string = \'ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\') => {\n  console.log(\'ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:\', text.length);\n\n  try {\n    // Âú®iframeÁéØÂ¢É‰∏≠Ôºå‰ºòÂÖàÂ∞ùËØïÂú®Áà∂Á™óÂè£‰∏≠Â§çÂà∂\n    if (window.parent && window.parent !== window) {\n      console.log(\'Ê£ÄÊµãÂà∞iframeÁéØÂ¢ÉÔºåÂ∞ùËØïÂú®Áà∂Á™óÂè£Â§çÂà∂\');\n      const parentSuccess = await tryParentWindowCopy(text);\n      if (parentSuccess) {\n        console.log(\'Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü\');\n        window.toastr.success(successMessage);\n        return;\n      }\n    }\n\n    // ÊñπÊ≥ï1: Â∞ùËØï‰ΩøÁî®Áé∞‰ª£ÁöÑ Clipboard APIÔºà‰ªÖÂú®ÂÆâÂÖ®‰∏ä‰∏ãÊñá‰∏≠Ôºâ\n    if (navigator.clipboard && window.isSecureContext) {\n      console.log(\'‰ΩøÁî®Áé∞‰ª£ Clipboard API\');\n      try {\n        await navigator.clipboard.writeText(text);\n        console.log(\'Clipboard API Â§çÂà∂ÊàêÂäü\');\n        window.toastr.success(successMessage);\n        return;\n      } catch (clipboardErr) {\n        console.warn(\'Clipboard API Â§±Ë¥•:\', clipboardErr);\n        // ÁªßÁª≠Â∞ùËØïÂÖ∂‰ªñÊñπÊ≥ï\n      }\n    }\n\n    // ÊñπÊ≥ï2: ‰ΩøÁî®‰º†ÁªüÁöÑ execCommand ÊñπÊ≥ï\n    console.log(\'‰ΩøÁî® execCommand ÊñπÊ≥ï\');\n    const success = await execCommandCopy(text);\n    if (success) {\n      console.log(\'execCommand Â§çÂà∂ÊàêÂäü\');\n      window.toastr.success(successMessage);\n      return;\n    }\n\n    // ÊñπÊ≥ï3: Â¶ÇÊûúÈÉΩÂ§±Ë¥•‰∫ÜÔºåÊòæÁ§∫ÊñáÊú¨Ê°ÜËÆ©Áî®Êà∑ÊâãÂä®Â§çÂà∂\n    console.log(\'ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢\');\n    showManualCopyDialog(text);\n  } catch (err) {\n    console.error(\'Â§çÂà∂ÂºÇÂ∏∏:\', err);\n    // Âá∫ÈîôÊó∂‰πüÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢\n    showManualCopyDialog(text);\n  }\n};\n\n// Âú®Áà∂Á™óÂè£‰∏≠Â∞ùËØïÂ§çÂà∂\nconst tryParentWindowCopy = async (text: string): Promise<boolean> => {\n  return new Promise(resolve => {\n    try {\n      const parentDoc = window.parent.document;\n      const parentBody = window.parent.document.body;\n\n      // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ textarea ÂÖÉÁ¥†Âú®Áà∂Á™óÂè£‰∏≠\n      const textarea = parentDoc.createElement(\'textarea\');\n      textarea.value = text;\n      textarea.style.cssText = `\n        position: fixed;\n        left: -9999px;\n        top: -9999px;\n        opacity: 0;\n        pointer-events: none;\n        z-index: -1000;\n      `;\n      textarea.setAttribute(\'readonly\', \'\');\n\n      parentBody.appendChild(textarea);\n\n      // ÈÄâ‰∏≠ÊñáÊú¨\n      textarea.focus();\n      textarea.select();\n      textarea.setSelectionRange(0, text.length);\n\n      // Â∞ùËØïÂ§çÂà∂\n      const success = parentDoc.execCommand(\'copy\');\n\n      // Ê∏ÖÁêÜ\n      parentBody.removeChild(textarea);\n\n      resolve(success);\n    } catch (err) {\n      console.error(\'Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•:\', err);\n      resolve(false);\n    }\n  });\n};\n\n// execCommand Â§çÂà∂ÊñπÊ≥ï\nconst execCommandCopy = async (text: string): Promise<boolean> => {\n  return new Promise(resolve => {\n    try {\n      // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ textarea ÂÖÉÁ¥†\n      const textarea = document.createElement(\'textarea\');\n      textarea.value = text;\n      textarea.style.position = \'fixed\';\n      textarea.style.left = \'-9999px\';\n      textarea.style.top = \'-9999px\';\n      textarea.style.opacity = \'0\';\n      textarea.style.pointerEvents = \'none\';\n      textarea.setAttribute(\'readonly\', \'\');\n\n      document.body.appendChild(textarea);\n\n      // ÈÄâ‰∏≠ÊñáÊú¨\n      textarea.select();\n      textarea.setSelectionRange(0, text.length);\n\n      // Â∞ùËØïÂ§çÂà∂\n      const success = document.execCommand(\'copy\');\n\n      // Ê∏ÖÁêÜ\n      document.body.removeChild(textarea);\n\n      resolve(success);\n    } catch (err) {\n      console.error(\'execCommand Â§çÂà∂Â§±Ë¥•:\', err);\n      resolve(false);\n    }\n  });\n};\n\n// ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü - Êõ¥ÂèØÈù†ÁöÑÂÆûÁé∞\nconst showManualCopyDialog = (text: string) => {\n  console.log(\'ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåÊñáÊú¨ÈïøÂ∫¶:\', text.length);\n\n  try {\n    // ‰ΩøÁî®Áà∂Á™óÂè£ÁöÑdocumentÊù•ÂàõÂª∫ÂÖÉÁ¥†\n    const parentDoc = window.parent.document;\n    const parentBody = window.parent.document.body;\n\n    // ÁßªÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑÊóßÂØπËØùÊ°Ü\n    const existingOverlay = parentDoc.getElementById(\'manual-copy-overlay\');\n    if (existingOverlay) {\n      parentBody.removeChild(existingOverlay);\n    }\n\n    // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç\n    const overlay = parentDoc.createElement(\'div\');\n    overlay.id = \'manual-copy-overlay\';\n    overlay.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    `;\n\n    // ÂàõÂª∫‰∏ªÂÆπÂô®\n    const container = parentDoc.createElement(\'div\');\n    container.style.cssText = `\n      background: #2a2a2a;\n      border: 2px solid #4a9eff;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 900px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    `;\n\n    // ÂàõÂª∫Ê†áÈ¢ò\n    const header = parentDoc.createElement(\'div\');\n    header.innerHTML = `\n      <h3 style="margin: 0 0 15px 0; color: #4a9eff; text-align: center; font-size: 18px; font-weight: 600;">\n        üìã ÊâãÂä®Â§çÂà∂Ë°®Ê†ºÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Êìç‰ΩúÊ≠•È™§Ôºö</strong>\n        </p>\n        <ol style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°Ü</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+A</kbd> ÂÖ®ÈÄâÊñáÊú¨</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+C</kbd> Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø</li>\n          <li>ÁÇπÂáª"ÂÖ≥Èó≠"ÊåâÈíÆÊàñÊåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Esc</kbd> ÂÖ≥Èó≠ÂØπËØùÊ°Ü</li>\n        </ol>\n      </div>\n    `;\n\n    // ÂàõÂª∫ÊñáÊú¨Ê°Ü\n    const textarea = parentDoc.createElement(\'textarea\');\n    textarea.value = text;\n    textarea.style.cssText = `\n      width: 100%;\n      height: 400px;\n      background: #1a1a1a;\n      border: 2px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      color: #e0e0e0;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 13px;\n      line-height: 1.5;\n      resize: vertical;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      outline: none;\n      margin-bottom: 20px;\n      box-sizing: border-box;\n    `;\n\n    // ÂàõÂª∫ÊåâÈíÆÂÆπÂô®\n    const buttonContainer = parentDoc.createElement(\'div\');\n    buttonContainer.style.cssText = `\n      display: flex;\n      gap: 12px;\n      justify-content: center;\n      align-items: center;\n    `;\n\n    // ÂàõÂª∫ÂÖ≥Èó≠ÊåâÈíÆ\n    const closeButton = parentDoc.createElement(\'button\');\n    closeButton.textContent = \'ÂÖ≥Èó≠\';\n    closeButton.style.cssText = `\n      background: #4a9eff;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    `;\n    closeButton.onmouseover = () => {\n      closeButton.style.background = \'#5ba8ff\';\n    };\n    closeButton.onmouseout = () => {\n      closeButton.style.background = \'#4a9eff\';\n    };\n\n    // ÂàõÂª∫Â§çÂà∂ÊåâÈíÆÔºàÂ§áÁî®Ôºâ\n    const copyButton = parentDoc.createElement(\'button\');\n    copyButton.textContent = \'Â∞ùËØïËá™Âä®Â§çÂà∂\';\n    copyButton.style.cssText = `\n      background: #28a745;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    `;\n    copyButton.onmouseover = () => {\n      copyButton.style.background = \'#218838\';\n    };\n    copyButton.onmouseout = () => {\n      copyButton.style.background = \'#28a745\';\n    };\n\n    // ÁªÑË£ÖÂÖÉÁ¥†\n    buttonContainer.appendChild(copyButton);\n    buttonContainer.appendChild(closeButton);\n\n    container.appendChild(header);\n    container.appendChild(textarea);\n    container.appendChild(buttonContainer);\n    overlay.appendChild(container);\n\n    // Ê∑ªÂä†Âà∞È°µÈù¢\n    parentBody.appendChild(overlay);\n\n    // ‰∫ã‰ª∂Â§ÑÁêÜ\n    closeButton.onclick = () => {\n      console.log(\'ÂÖ≥Èó≠ÊåâÈíÆË¢´ÁÇπÂáª\');\n      parentBody.removeChild(overlay);\n    };\n\n    copyButton.onclick = async () => {\n      console.log(\'Â∞ùËØïËá™Âä®Â§çÂà∂ÊåâÈíÆË¢´ÁÇπÂáª\');\n      try {\n        // ÈÄâ‰∏≠ÊñáÊú¨\n        textarea.focus();\n        textarea.select();\n\n        // Â∞ùËØïÂ§çÂà∂\n        const success = document.execCommand(\'copy\');\n        if (success) {\n          window.toastr.success(\'Ëá™Âä®Â§çÂà∂ÊàêÂäüÔºÅ\');\n          parentBody.removeChild(overlay);\n        } else {\n          window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂\');\n        }\n      } catch (err) {\n        console.error(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•:\', err);\n        window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂\');\n      }\n    };\n\n    // ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\n    overlay.onclick = e => {\n      if (e.target === overlay) {\n        console.log(\'ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\');\n        parentBody.removeChild(overlay);\n      }\n    };\n\n    // ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜ\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \'Escape\') {\n        console.log(\'ÊåâESCÈîÆÂÖ≥Èó≠\');\n        parentBody.removeChild(overlay);\n        parentDoc.removeEventListener(\'keydown\', handleKeyDown);\n      }\n    };\n    parentDoc.addEventListener(\'keydown\', handleKeyDown);\n\n    // Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨\n    setTimeout(() => {\n      console.log(\'Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨\');\n      textarea.focus();\n      textarea.select();\n    }, 200);\n\n    // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ\n    window.toastr.info(\'ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ∑≤ÊâìÂºÄÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú\');\n  } catch (err) {\n    console.error(\'ÂàõÂª∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:\', err);\n    window.toastr.error(\'Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê\');\n  }\n};\n\n// Â§çÂà∂Ë°®Ê†º - ‰ΩøÁî®Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞\nconst copyTable = (tableItem: { headers: string[]; data: string[][] }) => {\n  try {\n    // ÂàõÂª∫Ë°®Ê†ºÁöÑTSVÊ†ºÂºè\n    const tsv = [tableItem.headers.join(\'\\t\'), ...tableItem.data.map(row => row.join(\'\\t\'))].join(\'\\n\');\n    copyToClipboard(tsv, \'Ë°®Ê†ºÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\');\n  } catch (error) {\n    console.error(\'Â§çÂà∂Ë°®Ê†ºÂ§±Ë¥•:\', error);\n    window.toastr.error(\'Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂\');\n  }\n};\n\n// Âà†Èô§Ë°®Ê†º\nconst deleteTable = (index: number) => {\n  if (confirm(\'Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Ë°®Ê†ºÂêóÔºü\')) {\n    table_history.value.splice(index, 1);\n    const chat_id = getChatIdSafe();\n    if (chat_id) {\n      insertOrAssignVariables({ table_history: table_history.value }, { type: \'chat\' });\n      window.toastr.success(\'Ë°®Ê†ºÂ∑≤Âà†Èô§\');\n    }\n  }\n};\n\n// ÂàùÂßãÂåñ\nrefreshTableHistory();\n<\/script>\n\n<style scoped>\n.table-tab {\n  height: 100%;\n  overflow-y: auto;\n  padding: 25px !important;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 25px !important;\n  border-bottom: 1px solid #3a3a3a;\n  margin-bottom: 5px;\n}\n\n.section-header h3 {\n  margin: 0;\n  color: #fff;\n  font-size: 15px !important;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.count-badge {\n  background: #4a9eff;\n  color: white;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 40px 20px;\n  color: #888;\n}\n\n.empty-state i {\n  font-size: 48px;\n  margin-bottom: 10px;\n  opacity: 0.3;\n}\n\n.empty-state p {\n  margin: 10px 0;\n  font-size: 14px;\n}\n\n.empty-state small {\n  color: #666;\n  font-size: 12px;\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  padding: 15px 20px;\n}\n\n.history-item {\n  background: #2a2a2a;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  overflow: hidden;\n  transition: border-color 0.2s;\n}\n\n.history-item:hover {\n  border-color: #4a4a4a;\n}\n\n.history-header {\n  padding: 12px 15px;\n  background: #1a1a1a;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  user-select: none;\n  transition: background 0.2s;\n}\n\n.history-header:hover {\n  background: #2a2a2a;\n}\n\n.history-info {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  flex: 1;\n}\n\n.history-number {\n  color: #4a9eff;\n  font-weight: bold;\n}\n\n.history-range {\n  color: #888;\n  font-size: 12px;\n}\n\n.expand-icon {\n  color: #888;\n  font-size: 12px;\n}\n\n.history-content {\n  padding: 15px;\n  background: #2a2a2a;\n}\n\n.history-actions {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #3a3a3a;\n}\n\n.mini-button {\n  flex: 1;\n  padding: 6px 12px;\n  background: #2a2a2a;\n  border: 1px solid #3a3a3a;\n  border-radius: 4px;\n  color: #e0e0e0;\n  cursor: pointer;\n  font-size: 12px;\n  transition: background 0.2s;\n}\n\n.mini-button:hover {\n  background: #3a3a3a;\n}\n\n.mini-button.delete-button:hover {\n  background: #ff4444;\n  border-color: #ff4444;\n  color: white;\n}\n\n.table-display {\n  margin-top: 15px;\n  overflow-x: auto;\n  max-height: 400px;\n  overflow-y: auto;\n  border-radius: 6px;\n  background: #1a1a1a;\n}\n\n.table-display table {\n  width: 100%;\n  font-size: 12px;\n  border-collapse: collapse;\n}\n\n.table-display th,\n.table-display td {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n  padding: 8px;\n  border: 1px solid #444;\n}\n\n.table-display th {\n  background: #2a2a2a;\n  font-weight: bold;\n  color: #fff;\n}\n\n.table-display td {\n  color: #e0e0e0;\n}\n\n/* ÁæéÂåñÊåâÈíÆÁöÑÊÇ¨ÂÅúÊïàÊûú */\n.copy-button:hover .shimmer-effect,\n.delete-button:hover .shimmer-effect {\n  left: 100%;\n}\n\n.copy-button:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);\n}\n\n.delete-button:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);\n}\n</style>\n'],sourceRoot:''}]);const i=s},61:n=>{n.exports=Vue},86:(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});var o=t(790),a=t.n(o),r=t(54),s=t.n(r)()(a());s.push([n.id,'.summary-tab[data-v-97028022]{height:100%;overflow-y:auto;padding:25px !important}.section-header[data-v-97028022]{display:flex;justify-content:space-between;align-items:center;padding:20px 25px !important;border-bottom:1px solid #3a3a3a;margin-bottom:5px}.section-header h3[data-v-97028022]{margin:0;color:#fff;font-size:15px !important;font-weight:bold;display:flex;align-items:center;gap:8px}.header-actions[data-v-97028022]{display:flex;align-items:center;gap:10px}.count-badge[data-v-97028022]{background:#4a9eff;color:white;padding:4px 8px;border-radius:12px;font-size:12px}.empty-state[data-v-97028022]{text-align:center;padding:40px 20px;color:#888}.empty-state i[data-v-97028022]{font-size:48px;margin-bottom:10px;opacity:0.3}.empty-state p[data-v-97028022]{margin:10px 0;font-size:14px}.empty-state small[data-v-97028022]{color:#666;font-size:12px}.history-list[data-v-97028022]{display:flex;flex-direction:column;gap:10px;padding:15px 20px}.history-item[data-v-97028022]{background:#2a2a2a;border:1px solid #3a3a3a;border-radius:6px;overflow:hidden;transition:border-color 0.2s}.history-item[data-v-97028022]:hover{border-color:#4a4a4a}.history-header[data-v-97028022]{padding:12px 15px;background:#1a1a1a;display:flex;justify-content:space-between;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;transition:background 0.2s}.history-header[data-v-97028022]:hover{background:#2a2a2a}.history-info[data-v-97028022]{display:flex;align-items:center;gap:10px;flex:1}.history-number[data-v-97028022]{color:#4a9eff;font-weight:bold}.history-range[data-v-97028022]{color:#888;font-size:12px}.expand-icon[data-v-97028022]{color:#888;font-size:12px}.history-content[data-v-97028022]{padding:15px;background:#2a2a2a}.history-actions[data-v-97028022]{display:flex;gap:8px;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #3a3a3a}.mini-button[data-v-97028022]{flex:1;padding:6px 12px;background:#2a2a2a;border:1px solid #3a3a3a;border-radius:4px;color:#e0e0e0;cursor:pointer;font-size:12px;transition:background 0.2s}.mini-button[data-v-97028022]:hover{background:#3a3a3a}.mini-button.delete-button[data-v-97028022]:hover{background:#ff4444;border-color:#ff4444;color:white}.mini-button.worldbook-button[data-v-97028022]{background:#28a745;color:white;border-color:#28a745}.mini-button.worldbook-button[data-v-97028022]:hover{background:#218838;border-color:#218838;color:white}.mini-button.create-worldbook-button[data-v-97028022]{background:#17a2b8;color:white;border-color:#17a2b8}.mini-button.create-worldbook-button[data-v-97028022]:hover{background:#138496;border-color:#138496;color:white}.mini-button.refresh-button[data-v-97028022]{background:#6c757d;color:white;border-color:#6c757d}.mini-button.refresh-button[data-v-97028022]:hover{background:#5a6268;border-color:#5a6268;color:white}.mini-button.debug-button[data-v-97028022]{background:#ffc107;color:#000;border-color:#ffb300}.mini-button.debug-button[data-v-97028022]:hover{background:#e0a800;border-color:#d39e00;color:#000}.history-text[data-v-97028022]{white-space:pre-wrap;word-wrap:break-word;line-height:1.6;max-height:400px;overflow-y:auto}\n','',{version:3,sources:['webpack://./src/ËÆ∞ÂøÜ/components/SummaryTab.vue'],names:[],mappings:'AAqlCA,8BACE,WAAY,CACZ,eAAgB,CAChB,uBACF,CAEA,iCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,4BAA6B,CAC7B,+BAAgC,CAChC,iBACF,CAEA,oCACE,QAAS,CACT,UAAW,CACX,yBAA0B,CAC1B,gBAAiB,CACjB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,8BACE,kBAAmB,CACnB,WAAY,CACZ,eAAgB,CAChB,kBAAmB,CACnB,cACF,CAEA,8BACE,iBAAkB,CAClB,iBAAkB,CAClB,UACF,CAEA,gCACE,cAAe,CACf,kBAAmB,CACnB,WACF,CAEA,gCACE,aAAc,CACd,cACF,CAEA,oCACE,UAAW,CACX,cACF,CAEA,+BACE,YAAa,CACb,qBAAsB,CACtB,QAAS,CACT,iBACF,CAEA,+BACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,eAAgB,CAChB,4BACF,CAEA,qCACE,oBACF,CAEA,iCACE,iBAAkB,CAClB,kBAAmB,CACnB,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,cAAe,CACf,wBAAiB,CAAjB,gBAAiB,CACjB,0BACF,CAEA,uCACE,kBACF,CAEA,+BACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,MACF,CAEA,iCACE,aAAc,CACd,gBACF,CAEA,gCACE,UAAW,CACX,cACF,CAEA,8BACE,UAAW,CACX,cACF,CAEA,kCACE,YAAa,CACb,kBACF,CAEA,kCACE,YAAa,CACb,OAAQ,CACR,kBAAmB,CACnB,kBAAmB,CACnB,+BACF,CAEA,8BACE,MAAO,CACP,gBAAiB,CACjB,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,aAAc,CACd,cAAe,CACf,cAAe,CACf,0BACF,CAEA,oCACE,kBACF,CAEA,kDACE,kBAAmB,CACnB,oBAAqB,CACrB,WACF,CAEA,+CACE,kBAAmB,CACnB,WAAY,CACZ,oBACF,CAEA,qDACE,kBAAmB,CACnB,oBAAqB,CACrB,WACF,CAEA,sDACE,kBAAmB,CACnB,WAAY,CACZ,oBACF,CAEA,4DACE,kBAAmB,CACnB,oBAAqB,CACrB,WACF,CAEA,6CACE,kBAAmB,CACnB,WAAY,CACZ,oBACF,CAEA,mDACE,kBAAmB,CACnB,oBAAqB,CACrB,WACF,CAEA,2CACE,kBAAmB,CACnB,UAAW,CACX,oBACF,CAEA,iDACE,kBAAmB,CACnB,oBAAqB,CACrB,UACF,CAEA,+BACE,oBAAqB,CACrB,oBAAqB,CACrB,eAAgB,CAChB,gBAAiB,CACjB,eACF',sourcesContent:['<template>\n  <div class="summary-tab" style="padding: 25px !important; background: #1a1a1a !important">\n    <div\n      class="section-header"\n      style="\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 20px 25px !important;\n        border-bottom: 1px solid #3a3a3a;\n        margin-bottom: 5px;\n      "\n    >\n      <h3\n        style="\n          margin: 0;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        üìù ÂéÜÂè≤ÊÄªÁªìËÆ∞ÂΩï\n      </h3>\n      <div class="header-actions" style="display: flex; align-items: center; gap: 10px">\n        <span\n          v-if="summary_history.length > 0"\n          class="count-badge"\n          style="background: #4a9eff; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px"\n          >{{ summary_history.length }} Êù°ËÆ∞ÂΩï</span\n        >\n        <button\n          class="mini-button refresh-button"\n          style="\n            padding: 6px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 4px;\n            color: #e0e0e0;\n            cursor: pointer;\n            font-size: 12px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n          "\n          @click="handleRefreshData"\n        >\n          <i class="fa-solid fa-refresh"></i> Âà∑Êñ∞Êï∞ÊçÆ\n        </button>\n        <button\n          class="mini-button create-worldbook-button"\n          style="\n            padding: 6px 12px;\n            background: #51cf66;\n            border: 1px solid #40c057;\n            border-radius: 4px;\n            color: white;\n            cursor: pointer;\n            font-size: 12px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n          "\n          @click="createSummaryWorldbook"\n        >\n          <i class="fa-solid fa-plus"></i> ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶\n        </button>\n        <button\n          class="mini-button debug-button"\n          style="\n            padding: 6px 12px;\n            background: #ffc107;\n            border: 1px solid #ffb300;\n            border-radius: 4px;\n            color: #000;\n            cursor: pointer;\n            font-size: 12px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n          "\n          @click="showDebugPanel"\n        >\n          <i class="fa-solid fa-bug"></i> Ë∞ÉËØïÂ∑•ÂÖ∑\n        </button>\n      </div>\n    </div>\n\n    <div\n      v-if="summary_history && summary_history.length > 0"\n      class="history-list"\n      style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px"\n    >\n      <div\n        v-for="(item, index) in summary_history"\n        :key="index"\n        class="history-item"\n        style="\n          background: #2a2a2a;\n          border: 1px solid #444;\n          border-radius: 8px;\n          padding: 15px;\n          transition: all 0.3s ease;\n        "\n      >\n        <div\n          class="history-header"\n          style="\n            padding: 12px 15px;\n            background: #1a1a1a;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            cursor: pointer;\n            user-select: none;\n            transition: background 0.2s;\n            border-radius: 6px;\n          "\n          @click="toggleExpanded(index)"\n        >\n          <div class="history-info" style="display: flex; align-items: center; gap: 10px; flex: 1">\n            <span class="history-number" style="color: #4a9eff; font-weight: bold">#{{ index + 1 }}</span>\n            <span class="history-range" style="color: #888; font-size: 12px"\n              >Ê•ºÂ±Ç {{ item.start_id }} - {{ item.end_id }}</span\n            >\n          </div>\n          <span class="expand-icon" style="color: #888; font-size: 12px">{{ isExpanded(index) ? \'‚ñº\' : \'‚ñ∂\' }}</span>\n        </div>\n        <div\n          v-if="isExpanded(index)"\n          class="history-content"\n          style="padding: 15px; background: #2a2a2a; border-radius: 0 0 6px 6px"\n        >\n          <div\n            class="history-actions"\n            style="display: flex; gap: 8px; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #3a3a3a"\n          >\n            <button\n              class="mini-button"\n              style="\n                flex: 1;\n                padding: 6px 12px;\n                background: #2a2a2a;\n                border: 1px solid #3a3a3a;\n                border-radius: 4px;\n                color: #e0e0e0;\n                cursor: pointer;\n                font-size: 12px;\n                transition: background 0.2s;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n              "\n              @click="copySummary(item.content)"\n            >\n              <i class="fa-solid fa-copy"></i> Â§çÂà∂\n            </button>\n            <button\n              class="mini-button worldbook-button"\n              style="\n                flex: 1;\n                padding: 6px 12px;\n                background: #4a9eff;\n                border: 1px solid #5aaeff;\n                border-radius: 4px;\n                color: white;\n                cursor: pointer;\n                font-size: 12px;\n                transition: all 0.2s;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n              "\n              @click="bindToWorldbook(item.content, index)"\n            >\n              <i class="fa-solid fa-book"></i> ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶\n            </button>\n            <button\n              class="mini-button delete-button"\n              style="\n                flex: 1;\n                padding: 6px 12px;\n                background: #ff6b6b;\n                border: 1px solid #ff5252;\n                border-radius: 4px;\n                color: white;\n                cursor: pointer;\n                font-size: 12px;\n                transition: all 0.2s;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n              "\n              @click="deleteSummary(index)"\n            >\n              <i class="fa-solid fa-trash"></i> Âà†Èô§\n            </button>\n          </div>\n          <div\n            class="history-text"\n            style="\n              font-family: \'Courier New\', monospace;\n              font-size: 13px;\n              line-height: 1.6;\n              color: #e0e0e0;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              user-select: text;\n              cursor: text;\n            "\n          >\n            {{ item.content }}\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-else class="empty-state" style="text-align: center; padding: 40px 20px; color: #888">\n      <i class="fa-solid fa-inbox" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3"></i>\n      <p style="margin: 10px 0; font-size: 16px">ËøòÊ≤°ÊúâÊÄªÁªìËÆ∞ÂΩï</p>\n      <small style="font-size: 12px; color: #666">‰ΩøÁî®"ËÆæÁΩÆ"Ê†áÁ≠æÈ°µÊâãÂä®ÂàõÂª∫ÊÄªÁªì</small>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref } from \'vue\';\nimport { useSummaryHistoryStore } from \'../settings\';\nimport { getChatIdSafe } from \'../utils\';\n\nconst historyStore = useSummaryHistoryStore();\n\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\nconst summary_history = ref<Array<{ start_id: number; end_id: number; content: string }>>([]);\nconst expandedState = ref<Map<number, boolean>>(new Map());\n\n// Êõ¥Êñ∞ÊÄªÁªìÂéÜÂè≤ÁöÑÂáΩÊï∞\nconst refreshSummaryHistory = () => {\n  try {\n    summary_history.value = historyStore.getSummaryHistory();\n    console.log(\'Â∑≤Âà∑Êñ∞ÊÄªÁªìÂéÜÂè≤ÔºåÂΩìÂâçËÅäÂ§©ËÆ∞ÂΩïÊï∞:\', summary_history.value.length);\n  } catch (e) {\n    console.error(\'Âà∑Êñ∞ÊÄªÁªìÂéÜÂè≤Â§±Ë¥•:\', e);\n    summary_history.value = [];\n  }\n};\n\n// ÂàáÊç¢Â±ïÂºÄÁä∂ÊÄÅ\nconst toggleExpanded = (index: number) => {\n  const current = expandedState.value.get(index) || false;\n  expandedState.value.set(index, !current);\n};\n\nconst isExpanded = (index: number) => {\n  return expandedState.value.get(index) || false;\n};\n\n// Â§ÑÁêÜÂà∑Êñ∞Êï∞ÊçÆÊåâÈíÆ\nconst handleRefreshData = async () => {\n  console.log(\'Âà∑Êñ∞Êï∞ÊçÆÊåâÈíÆË¢´ÁÇπÂáª\');\n  try {\n    await refreshSummaryHistory();\n    window.toastr.success(\'Êï∞ÊçÆÂ∑≤Âà∑Êñ∞\');\n  } catch (error) {\n    console.error(\'Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•:\', error);\n    window.toastr.error(\'Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\n// Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞ - ÈíàÂØπiframeÁéØÂ¢É‰ºòÂåñ\nconst copyToClipboard = async (text: string, successMessage: string = \'ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\') => {\n  console.log(\'ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:\', text.length);\n\n  try {\n    // Âú®iframeÁéØÂ¢É‰∏≠Ôºå‰ºòÂÖàÂ∞ùËØïÂú®Áà∂Á™óÂè£‰∏≠Â§çÂà∂\n    if (window.parent && window.parent !== window) {\n      console.log(\'Ê£ÄÊµãÂà∞iframeÁéØÂ¢ÉÔºåÂ∞ùËØïÂú®Áà∂Á™óÂè£Â§çÂà∂\');\n      const parentSuccess = await tryParentWindowCopy(text);\n      if (parentSuccess) {\n        console.log(\'Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü\');\n        window.toastr.success(successMessage);\n        return;\n      }\n    }\n\n    // ÊñπÊ≥ï1: Â∞ùËØï‰ΩøÁî®Áé∞‰ª£ÁöÑ Clipboard APIÔºà‰ªÖÂú®ÂÆâÂÖ®‰∏ä‰∏ãÊñá‰∏≠Ôºâ\n    if (navigator.clipboard && window.isSecureContext) {\n      console.log(\'‰ΩøÁî®Áé∞‰ª£ Clipboard API\');\n      try {\n        await navigator.clipboard.writeText(text);\n        console.log(\'Clipboard API Â§çÂà∂ÊàêÂäü\');\n        window.toastr.success(successMessage);\n        return;\n      } catch (clipboardErr) {\n        console.warn(\'Clipboard API Â§±Ë¥•:\', clipboardErr);\n        // ÁªßÁª≠Â∞ùËØïÂÖ∂‰ªñÊñπÊ≥ï\n      }\n    }\n\n    // ÊñπÊ≥ï2: ‰ΩøÁî®‰º†ÁªüÁöÑ execCommand ÊñπÊ≥ï\n    console.log(\'‰ΩøÁî® execCommand ÊñπÊ≥ï\');\n    const success = await execCommandCopy(text);\n    if (success) {\n      console.log(\'execCommand Â§çÂà∂ÊàêÂäü\');\n      window.toastr.success(successMessage);\n      return;\n    }\n\n    // ÊñπÊ≥ï3: Â¶ÇÊûúÈÉΩÂ§±Ë¥•‰∫ÜÔºåÊòæÁ§∫ÊñáÊú¨Ê°ÜËÆ©Áî®Êà∑ÊâãÂä®Â§çÂà∂\n    console.log(\'ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢\');\n    showManualCopyDialog(text);\n  } catch (err) {\n    console.error(\'Â§çÂà∂ÂºÇÂ∏∏:\', err);\n    // Âá∫ÈîôÊó∂‰πüÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢\n    showManualCopyDialog(text);\n  }\n};\n\n// Âú®Áà∂Á™óÂè£‰∏≠Â∞ùËØïÂ§çÂà∂\nconst tryParentWindowCopy = async (text: string): Promise<boolean> => {\n  return new Promise(resolve => {\n    try {\n      const parentDoc = window.parent.document;\n      const parentBody = window.parent.document.body;\n\n      // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ textarea ÂÖÉÁ¥†Âú®Áà∂Á™óÂè£‰∏≠\n      const textarea = parentDoc.createElement(\'textarea\');\n      textarea.value = text;\n      textarea.style.cssText = `\n        position: fixed;\n        left: -9999px;\n        top: -9999px;\n        opacity: 0;\n        pointer-events: none;\n        z-index: -1000;\n      `;\n      textarea.setAttribute(\'readonly\', \'\');\n\n      parentBody.appendChild(textarea);\n\n      // ÈÄâ‰∏≠ÊñáÊú¨\n      textarea.focus();\n      textarea.select();\n      textarea.setSelectionRange(0, text.length);\n\n      // Â∞ùËØïÂ§çÂà∂\n      const success = parentDoc.execCommand(\'copy\');\n\n      // Ê∏ÖÁêÜ\n      parentBody.removeChild(textarea);\n\n      resolve(success);\n    } catch (err) {\n      console.error(\'Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•:\', err);\n      resolve(false);\n    }\n  });\n};\n\n// execCommand Â§çÂà∂ÊñπÊ≥ï\nconst execCommandCopy = async (text: string): Promise<boolean> => {\n  return new Promise(resolve => {\n    try {\n      // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ textarea ÂÖÉÁ¥†\n      const textarea = document.createElement(\'textarea\');\n      textarea.value = text;\n      textarea.style.position = \'fixed\';\n      textarea.style.left = \'-9999px\';\n      textarea.style.top = \'-9999px\';\n      textarea.style.opacity = \'0\';\n      textarea.style.pointerEvents = \'none\';\n      textarea.setAttribute(\'readonly\', \'\');\n\n      document.body.appendChild(textarea);\n\n      // ÈÄâ‰∏≠ÊñáÊú¨\n      textarea.select();\n      textarea.setSelectionRange(0, text.length);\n\n      // Â∞ùËØïÂ§çÂà∂\n      const success = document.execCommand(\'copy\');\n\n      // Ê∏ÖÁêÜ\n      document.body.removeChild(textarea);\n\n      resolve(success);\n    } catch (err) {\n      console.error(\'execCommand Â§çÂà∂Â§±Ë¥•:\', err);\n      resolve(false);\n    }\n  });\n};\n\n// ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü - Êõ¥ÂèØÈù†ÁöÑÂÆûÁé∞\nconst showManualCopyDialog = (text: string) => {\n  console.log(\'ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåÊñáÊú¨ÈïøÂ∫¶:\', text.length);\n\n  try {\n    // ‰ΩøÁî®Áà∂Á™óÂè£ÁöÑdocumentÊù•ÂàõÂª∫ÂÖÉÁ¥†\n    const parentDoc = window.parent.document;\n    const parentBody = window.parent.document.body;\n\n    // ÁßªÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑÊóßÂØπËØùÊ°Ü\n    const existingOverlay = parentDoc.getElementById(\'manual-copy-overlay\');\n    if (existingOverlay) {\n      parentBody.removeChild(existingOverlay);\n    }\n\n    // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç\n    const overlay = parentDoc.createElement(\'div\');\n    overlay.id = \'manual-copy-overlay\';\n    overlay.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    `;\n\n    // ÂàõÂª∫‰∏ªÂÆπÂô®\n    const container = parentDoc.createElement(\'div\');\n    container.style.cssText = `\n      background: #2a2a2a;\n      border: 2px solid #4a9eff;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 900px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    `;\n\n    // ÂàõÂª∫Ê†áÈ¢ò\n    const header = parentDoc.createElement(\'div\');\n    header.innerHTML = `\n      <h3 style="margin: 0 0 15px 0; color: #4a9eff; text-align: center; font-size: 18px; font-weight: 600;">\n        üìã ÊâãÂä®Â§çÂà∂ÊÄªÁªìÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Êìç‰ΩúÊ≠•È™§Ôºö</strong>\n        </p>\n        <ol style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°Ü</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+A</kbd> ÂÖ®ÈÄâÊñáÊú¨</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+C</kbd> Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø</li>\n          <li>ÁÇπÂáª"ÂÖ≥Èó≠"ÊåâÈíÆÊàñÊåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Esc</kbd> ÂÖ≥Èó≠ÂØπËØùÊ°Ü</li>\n        </ol>\n      </div>\n    `;\n\n    // ÂàõÂª∫ÊñáÊú¨Ê°Ü\n    const textarea = parentDoc.createElement(\'textarea\');\n    textarea.value = text;\n    textarea.style.cssText = `\n      width: 100%;\n      height: 400px;\n      background: #1a1a1a;\n      border: 2px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      color: #e0e0e0;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 13px;\n      line-height: 1.5;\n      resize: vertical;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      outline: none;\n      margin-bottom: 20px;\n      box-sizing: border-box;\n    `;\n\n    // ÂàõÂª∫ÊåâÈíÆÂÆπÂô®\n    const buttonContainer = parentDoc.createElement(\'div\');\n    buttonContainer.style.cssText = `\n      display: flex;\n      gap: 12px;\n      justify-content: center;\n      align-items: center;\n    `;\n\n    // ÂàõÂª∫ÂÖ≥Èó≠ÊåâÈíÆ\n    const closeButton = parentDoc.createElement(\'button\');\n    closeButton.textContent = \'ÂÖ≥Èó≠\';\n    closeButton.style.cssText = `\n      background: #4a9eff;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    `;\n    closeButton.onmouseover = () => {\n      closeButton.style.background = \'#5ba8ff\';\n    };\n    closeButton.onmouseout = () => {\n      closeButton.style.background = \'#4a9eff\';\n    };\n\n    // ÂàõÂª∫Â§çÂà∂ÊåâÈíÆÔºàÂ§áÁî®Ôºâ\n    const copyButton = parentDoc.createElement(\'button\');\n    copyButton.textContent = \'Â∞ùËØïËá™Âä®Â§çÂà∂\';\n    copyButton.style.cssText = `\n      background: #28a745;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    `;\n    copyButton.onmouseover = () => {\n      copyButton.style.background = \'#218838\';\n    };\n    copyButton.onmouseout = () => {\n      copyButton.style.background = \'#28a745\';\n    };\n\n    // ÁªÑË£ÖÂÖÉÁ¥†\n    buttonContainer.appendChild(copyButton);\n    buttonContainer.appendChild(closeButton);\n\n    container.appendChild(header);\n    container.appendChild(textarea);\n    container.appendChild(buttonContainer);\n    overlay.appendChild(container);\n\n    // Ê∑ªÂä†Âà∞È°µÈù¢\n    parentBody.appendChild(overlay);\n\n    // ‰∫ã‰ª∂Â§ÑÁêÜ\n    closeButton.onclick = () => {\n      console.log(\'ÂÖ≥Èó≠ÊåâÈíÆË¢´ÁÇπÂáª\');\n      parentBody.removeChild(overlay);\n    };\n\n    copyButton.onclick = async () => {\n      console.log(\'Â∞ùËØïËá™Âä®Â§çÂà∂ÊåâÈíÆË¢´ÁÇπÂáª\');\n      try {\n        // ÈÄâ‰∏≠ÊñáÊú¨\n        textarea.focus();\n        textarea.select();\n\n        // Â∞ùËØïÂ§çÂà∂\n        const success = document.execCommand(\'copy\');\n        if (success) {\n          window.toastr.success(\'Ëá™Âä®Â§çÂà∂ÊàêÂäüÔºÅ\');\n          parentBody.removeChild(overlay);\n        } else {\n          window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂\');\n        }\n      } catch (err) {\n        console.error(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•:\', err);\n        window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂\');\n      }\n    };\n\n    // ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\n    overlay.onclick = e => {\n      if (e.target === overlay) {\n        console.log(\'ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\');\n        parentBody.removeChild(overlay);\n      }\n    };\n\n    // ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜ\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \'Escape\') {\n        console.log(\'ÊåâESCÈîÆÂÖ≥Èó≠\');\n        parentBody.removeChild(overlay);\n        parentDoc.removeEventListener(\'keydown\', handleKeyDown);\n      }\n    };\n    parentDoc.addEventListener(\'keydown\', handleKeyDown);\n\n    // Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨\n    setTimeout(() => {\n      console.log(\'Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨\');\n      textarea.focus();\n      textarea.select();\n    }, 200);\n\n    // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ\n    window.toastr.info(\'ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ∑≤ÊâìÂºÄÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú\');\n  } catch (err) {\n    console.error(\'ÂàõÂª∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:\', err);\n    window.toastr.error(\'Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê\');\n  }\n};\n\n// Â§çÂà∂ÊÄªÁªì - ‰ΩøÁî®Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞\nconst copySummary = (content: string) => {\n  copyToClipboard(content, \'ÊÄªÁªìÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\');\n};\n\n// Âà†Èô§ÊÄªÁªì\nconst deleteSummary = (index: number) => {\n  if (confirm(\'Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ÊÄªÁªìÂêóÔºü\')) {\n    try {\n      const chat_id = getChatIdSafe();\n      if (!chat_id) {\n        window.toastr.error(\'Êó†Ê≥ïËé∑ÂèñÂΩìÂâçËÅäÂ§©‰ø°ÊÅØ\');\n        return;\n      }\n\n      summary_history.value.splice(index, 1);\n      insertOrAssignVariables({ summary_history: summary_history.value }, { type: \'chat\' });\n      window.toastr.success(\'ÊÄªÁªìÂ∑≤Âà†Èô§\');\n    } catch (error) {\n      console.error(\'Âà†Èô§ÊÄªÁªìÂ§±Ë¥•:\', error);\n      window.toastr.error(\'Âà†Èô§ÊÄªÁªìÂ§±Ë¥•\');\n    }\n  }\n};\n\n// ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶\nconst createSummaryWorldbook = async () => {\n  try {\n    // Ëé∑ÂèñÂΩìÂâçËßíËâ≤Âç°‰ø°ÊÅØ\n    let characterName = \'Êú™Áü•ËßíËâ≤\';\n    try {\n      const currentCharacter = getCharData(\'current\');\n      if (currentCharacter && currentCharacter.name) {\n        characterName = currentCharacter.name;\n        // Ê∏ÖÁêÜËßíËâ≤Âêç‰∏≠ÁöÑÁâπÊÆäÂ≠óÁ¨¶ÔºåÈÅøÂÖçÊñá‰ª∂ÂêçÈóÆÈ¢ò\n        characterName = characterName.replace(/[<>:"/\\\\|?*]/g, \'_\').trim();\n      }\n    } catch (charError) {\n      console.warn(\'Ëé∑ÂèñËßíËâ≤‰ø°ÊÅØÂ§±Ë¥•:\', charError);\n    }\n\n    // ÁîüÊàêÂåÖÂê´ËßíËâ≤ÂêçÂíåÊó•ÊúüÁöÑ‰∏ñÁïå‰π¶ÂêçÁß∞\n    const dateStr = new Date().toISOString().slice(0, 10);\n    const worldbookName = `ÊÄªÁªì_${characterName}_${dateStr}`;\n\n    console.log(\'ÂáÜÂ§áÂàõÂª∫‰∏ñÁïå‰π¶:\', worldbookName);\n\n    const existingWorldbooks = getWorldbookNames();\n    if (existingWorldbooks.includes(worldbookName)) {\n      window.toastr.warning(`‰∏ñÁïå‰π¶ "${worldbookName}" Â∑≤Â≠òÂú®`);\n      return;\n    }\n\n    await createWorldbook(worldbookName, []);\n\n    try {\n      await rebindChatWorldbook(\'current\', worldbookName);\n      window.toastr.success(`Â∑≤ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶ "${worldbookName}" Âπ∂ÁªëÂÆöÂà∞ÂΩìÂâçËÅäÂ§©`);\n    } catch (bindError) {\n      console.warn(\'ÁªëÂÆöÂà∞ËÅäÂ§©Â§±Ë¥•:\', bindError);\n      window.toastr.success(`Â∑≤ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶ "${worldbookName}"ÔºåËØ∑ÊâãÂä®Âú®ËÅäÂ§©Áü•ËØÜ‰π¶‰∏≠ÁªëÂÆö`);\n    }\n  } catch (error) {\n    console.error(\'ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶Â§±Ë¥•:\', error);\n    window.toastr.error(\'ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶Â§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\n// ÁªëÂÆöÊÄªÁªìÂà∞‰∏ñÁïå‰π¶\nconst bindToWorldbook = async (content: string, summaryIndex: number) => {\n  try {\n    const worldbookNames = getWorldbookNames();\n    if (worldbookNames.length === 0) {\n      window.toastr.warning(\'Ê≤°ÊúâÂèØÁî®ÁöÑ‰∏ñÁïå‰π¶ÔºåËØ∑ÂÖàÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶\');\n      return;\n    }\n\n    const selectedWorldbook =\n      worldbookNames.length === 1 ? worldbookNames[0] : await promptForWorldbook(worldbookNames);\n    if (!selectedWorldbook) {\n      return;\n    }\n\n    const entryName = `ÊÄªÁªì_${summaryIndex + 1}_${new Date().toLocaleDateString()}`;\n    const newEntry = {\n      name: entryName,\n      enabled: true,\n      strategy: {\n        type: \'constant\' as const,\n        keys: [],\n        keys_secondary: { logic: \'and_any\' as const, keys: [] },\n        scan_depth: \'same_as_global\' as const,\n      },\n      position: {\n        type: \'before_character_definition\' as const,\n        role: \'system\' as const,\n        depth: 1,\n      },\n      content: content,\n      comment: `Ëá™Âä®ÁîüÊàêÁöÑÊÄªÁªìÊù°ÁõÆ - Ê•ºÂ±ÇËåÉÂõ¥: ${summary_history.value[summaryIndex]?.start_id || \'?\'} - ${summary_history.value[summaryIndex]?.end_id || \'?\'}`,\n      insertion_order: 0,\n      case_sensitive: false,\n      name_is_regex: false,\n      keys_are_regex: false,\n      selective_logic: \'and\',\n      secondary_keys_logic: \'and\',\n      activation_threshold: 0,\n      disabled: false,\n      order: 0,\n      group: \'\',\n      local_id: 0,\n      depth_entries: [],\n      depth_entries_all: false,\n      search_range: 0,\n      force_activation: false,\n      disable: false,\n      exclude_recursion: false,\n      hidden: false,\n      priority: 0,\n      comment_is_regex: false,\n      content_is_regex: false,\n      secondary_keys_are_regex: false,\n      keys_secondary_are_regex: false,\n      uid: Date.now(),\n    };\n\n    await createWorldbookEntries(selectedWorldbook, [newEntry]);\n    window.toastr.success(`ÊÄªÁªìÂ∑≤ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶: ${selectedWorldbook}`);\n  } catch (error) {\n    console.error(\'ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶Â§±Ë¥•:\', error);\n    window.toastr.error(\'ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶Â§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\n// ËÆ©Áî®Êà∑ÈÄâÊã©‰∏ñÁïå‰π¶ÁöÑËæÖÂä©ÂáΩÊï∞\nconst promptForWorldbook = async (worldbookNames: string[]): Promise<string | null> => {\n  return new Promise<string | null>(resolve => {\n    const dialog = $(`\n      <div style="\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        background: #2a2a2a;\n        border: 1px solid #3a3a3a;\n        border-radius: 8px;\n        padding: 20px;\n        z-index: 1000000;\n        min-width: 300px;\n      ">\n        <h3 style="margin: 0 0 15px 0; color: #e0e0e0;">ÈÄâÊã©‰∏ñÁïå‰π¶</h3>\n        <div style="margin-bottom: 15px;">\n          ${worldbookNames\n            .map(\n              name => `\n            <label style="display: block; margin: 5px 0; color: #e0e0e0;">\n              <input type="radio" name="worldbook" value="${name}" style="margin-right: 8px;">\n              ${name}\n            </label>\n          `,\n            )\n            .join(\'\')}\n        </div>\n        <div style="text-align: right;">\n          <button id="cancelWorldbook" style="\n            background: #666;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            margin-right: 10px;\n            cursor: pointer;\n          ">ÂèñÊ∂à</button>\n          <button id="confirmWorldbook" style="\n            background: #4a9eff;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n          ">Á°ÆÂÆö</button>\n        </div>\n      </div>\n    `);\n\n    const overlay = $(`\n      <div style="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 999999;\n      "></div>\n    `);\n\n    $(\'body\').append(overlay).append(dialog);\n\n    $(\'#cancelWorldbook\').on(\'click\', () => {\n      overlay.remove();\n      dialog.remove();\n      resolve(null);\n    });\n\n    $(\'#confirmWorldbook\').on(\'click\', () => {\n      const selected = $(\'input[name="worldbook"]:checked\').val() as string;\n      overlay.remove();\n      dialog.remove();\n      resolve(selected || null);\n    });\n\n    $(\'input[name="worldbook"]:first\').prop(\'checked\', true);\n  });\n};\n\n// ÊòæÁ§∫Ë∞ÉËØïÈù¢Êùø\nconst showDebugPanel = () => {\n  try {\n    // ‰ΩøÁî®Áà∂Á™óÂè£ÁöÑdocumentÊù•ÂàõÂª∫ÂÖÉÁ¥†\n    const parentDoc = window.parent.document;\n    const parentBody = window.parent.document.body;\n\n    // ÁßªÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑÊóßÂØπËØùÊ°Ü\n    const existingOverlay = parentDoc.getElementById(\'debug-panel-overlay\');\n    if (existingOverlay) {\n      parentBody.removeChild(existingOverlay);\n    }\n\n    // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç\n    const overlay = parentDoc.createElement(\'div\');\n    overlay.id = \'debug-panel-overlay\';\n    overlay.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    `;\n\n    // ÂàõÂª∫‰∏ªÂÆπÂô®\n    const container = parentDoc.createElement(\'div\');\n    container.style.cssText = `\n      background: #2a2a2a;\n      border: 2px solid #ffc107;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 800px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    `;\n\n    // ÂàõÂª∫Ê†áÈ¢ò\n    const header = parentDoc.createElement(\'div\');\n    header.innerHTML = `\n      <h3 style="margin: 0 0 15px 0; color: #ffc107; text-align: center; font-size: 18px; font-weight: 600;">\n        üêõ Ëá™Âä®ÊÄªÁªìË∞ÉËØïÂ∑•ÂÖ∑\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Ë∞ÉËØïÂäüËÉΩÔºö</strong>\n        </p>\n        <ul style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÊµãËØïËá™Âä®ÊÄªÁªìÊµÅÁ®ã</li>\n          <li>ÂêåÊ≠•localStorageÊï∞ÊçÆÂà∞ÈÖíÈ¶ÜÂä©ÊâãÂèòÈáè</li>\n          <li>Ê£ÄÊü•ÂΩìÂâçÊ•ºÂ±ÇÁä∂ÊÄÅ</li>\n          <li>È™åËØÅËß¶ÂèëÊù°‰ª∂ËÆ°ÁÆó</li>\n        </ul>\n      </div>\n    `;\n\n    // ÂàõÂª∫ÊåâÈíÆÂÆπÂô®\n    const buttonContainer = parentDoc.createElement(\'div\');\n    buttonContainer.style.cssText = `\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 12px;\n      margin-bottom: 20px;\n    `;\n\n    // ÂàõÂª∫ÊåâÈíÆ\n    const buttons = [\n      { id: \'testComplete\', text: \'üß™ ÊµãËØïÂÆåÊï¥ÊµÅÁ®ã\', color: \'#4a9eff\' },\n      { id: \'syncData\', text: \'üîÑ ÂêåÊ≠•Êï∞ÊçÆ\', color: \'#28a745\' },\n      { id: \'checkFloor\', text: \'üîç Ê£ÄÊü•Ê•ºÂ±Ç\', color: \'#17a2b8\' },\n      { id: \'testCalculation\', text: \'üßÆ È™åËØÅËÆ°ÁÆó\', color: \'#6f42c1\' },\n      { id: \'showStatus\', text: \'üìä ÊòæÁ§∫Áä∂ÊÄÅ\', color: \'#fd7e14\' },\n      { id: \'resetStartId\', text: \'üîÑ ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç\', color: \'#dc3545\' },\n    ];\n\n    buttons.forEach(button => {\n      const btn = parentDoc.createElement(\'button\');\n      btn.id = button.id;\n      btn.textContent = button.text;\n      btn.style.cssText = `\n        background: ${button.color};\n        color: white;\n        border: none;\n        padding: 12px 16px;\n        border-radius: 6px;\n        cursor: pointer;\n        font-size: 13px;\n        font-weight: 500;\n        transition: background 0.2s;\n      `;\n      btn.onmouseover = () => {\n        btn.style.opacity = \'0.8\';\n      };\n      btn.onmouseout = () => {\n        btn.style.opacity = \'1\';\n      };\n      buttonContainer.appendChild(btn);\n    });\n\n    // ÂàõÂª∫ËæìÂá∫Âå∫Âüü\n    const outputArea = parentDoc.createElement(\'div\');\n    outputArea.id = \'debug-output\';\n    outputArea.style.cssText = `\n      background: #1a1a1a;\n      border: 1px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      height: 200px;\n      overflow-y: auto;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 12px;\n      color: #e0e0e0;\n      white-space: pre-wrap;\n      margin-bottom: 20px;\n    `;\n    outputArea.textContent = \'ÁÇπÂáª‰∏äÊñπÊåâÈíÆÂºÄÂßãË∞ÉËØï...\\n\';\n\n    // ÂàõÂª∫ÂÖ≥Èó≠ÊåâÈíÆ\n    const closeButton = parentDoc.createElement(\'button\');\n    closeButton.textContent = \'ÂÖ≥Èó≠\';\n    closeButton.style.cssText = `\n      background: #6c757d;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n      align-self: center;\n    `;\n\n    // ÁªÑË£ÖÂÖÉÁ¥†\n    container.appendChild(header);\n    container.appendChild(buttonContainer);\n    container.appendChild(outputArea);\n    container.appendChild(closeButton);\n\n    overlay.appendChild(container);\n    parentBody.appendChild(overlay);\n\n    // Ê∑ªÂä†Êó•ÂøóÂáΩÊï∞\n    const log = (message: string) => {\n      const output = parentDoc.getElementById(\'debug-output\');\n      if (output) {\n        output.textContent += message + \'\\n\';\n        output.scrollTop = output.scrollHeight;\n      }\n    };\n\n    // ‰∫ã‰ª∂Â§ÑÁêÜ\n    closeButton.onclick = () => {\n      parentBody.removeChild(overlay);\n    };\n\n    // ÊµãËØïÂÆåÊï¥ÊµÅÁ®ã\n    parentDoc.getElementById(\'testComplete\')?.addEventListener(\'click\', () => {\n      log(\'üß™ ÂºÄÂßãÊµãËØïÂÆåÊï¥Ëá™Âä®ÊÄªÁªìÊµÅÁ®ã...\');\n      try {\n        if ((window as any).testCompleteAutoSummary) {\n          (window as any).testCompleteAutoSummary();\n          log(\'‚úÖ ÊµãËØïÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå ÊµãËØïÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå ÊµãËØïÂ§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // ÂêåÊ≠•Êï∞ÊçÆ\n    parentDoc.getElementById(\'syncData\')?.addEventListener(\'click\', () => {\n      log(\'üîÑ ÂºÄÂßãÂêåÊ≠•Êï∞ÊçÆ...\');\n      try {\n        if ((window as any).syncAutoSummaryData) {\n          (window as any).syncAutoSummaryData();\n          log(\'‚úÖ ÂêåÊ≠•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå ÂêåÊ≠•ÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå ÂêåÊ≠•Â§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // Ê£ÄÊü•Ê•ºÂ±Ç\n    parentDoc.getElementById(\'checkFloor\')?.addEventListener(\'click\', () => {\n      log(\'üîç ÂºÄÂßãÊ£ÄÊü•Ê•ºÂ±Ç...\');\n      try {\n        if ((window as any).checkCurrentFloor) {\n          (window as any).checkCurrentFloor();\n          log(\'‚úÖ Ê•ºÂ±ÇÊ£ÄÊü•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå Ê•ºÂ±ÇÊ£ÄÊü•ÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå Ê•ºÂ±ÇÊ£ÄÊü•Â§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // È™åËØÅËÆ°ÁÆó\n    parentDoc.getElementById(\'testCalculation\')?.addEventListener(\'click\', () => {\n      log(\'üßÆ ÂºÄÂßãÈ™åËØÅËÆ°ÁÆó...\');\n      try {\n        if ((window as any).testFloorCalculation) {\n          (window as any).testFloorCalculation();\n          log(\'‚úÖ ËÆ°ÁÆóÈ™åËØÅÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå ËÆ°ÁÆóÈ™åËØÅÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå ËÆ°ÁÆóÈ™åËØÅÂ§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // ÊòæÁ§∫Áä∂ÊÄÅ\n    parentDoc.getElementById(\'showStatus\')?.addEventListener(\'click\', () => {\n      log(\'üìä ÂºÄÂßãÊòæÁ§∫Áä∂ÊÄÅ...\');\n      try {\n        if ((window as any).checkAutoSummaryStatus) {\n          (window as any).checkAutoSummaryStatus();\n          log(\'‚úÖ Áä∂ÊÄÅÊ£ÄÊü•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå Áä∂ÊÄÅÊ£ÄÊü•ÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå Áä∂ÊÄÅÊ£ÄÊü•Â§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç\n    parentDoc.getElementById(\'resetStartId\')?.addEventListener(\'click\', () => {\n      log(\'üîÑ ÂºÄÂßãÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç...\');\n      try {\n        if ((window as any).smartResetChat) {\n          (window as any).smartResetChat();\n          log(\'‚úÖ ÈáçÁΩÆÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫\');\n        } else {\n          log(\'‚ùå ÈáçÁΩÆÂáΩÊï∞‰∏çÂèØÁî®\');\n        }\n      } catch (error) {\n        log(\'‚ùå ÈáçÁΩÆÂ§±Ë¥•: \' + (error as Error).message);\n      }\n    });\n\n    // ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\n    overlay.onclick = e => {\n      if (e.target === overlay) {\n        parentBody.removeChild(overlay);\n      }\n    };\n\n    // ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜ\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \'Escape\') {\n        parentBody.removeChild(overlay);\n        parentDoc.removeEventListener(\'keydown\', handleKeyDown);\n      }\n    };\n    parentDoc.addEventListener(\'keydown\', handleKeyDown);\n\n    window.toastr?.info(\'Ë∞ÉËØïÈù¢ÊùøÂ∑≤ÊâìÂºÄ\');\n  } catch (err) {\n    console.error(\'ÂàõÂª∫Ë∞ÉËØïÈù¢ÊùøÂ§±Ë¥•:\', err);\n    window.toastr?.error(\'Êó†Ê≥ïÊòæÁ§∫Ë∞ÉËØïÈù¢ÊùøÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê\');\n  }\n};\n\n// ÂàùÂßãÂåñ\nrefreshSummaryHistory();\n<\/script>\n\n<style scoped>\n.summary-tab {\n  height: 100%;\n  overflow-y: auto;\n  padding: 25px !important;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 25px !important;\n  border-bottom: 1px solid #3a3a3a;\n  margin-bottom: 5px;\n}\n\n.section-header h3 {\n  margin: 0;\n  color: #fff;\n  font-size: 15px !important;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.count-badge {\n  background: #4a9eff;\n  color: white;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 40px 20px;\n  color: #888;\n}\n\n.empty-state i {\n  font-size: 48px;\n  margin-bottom: 10px;\n  opacity: 0.3;\n}\n\n.empty-state p {\n  margin: 10px 0;\n  font-size: 14px;\n}\n\n.empty-state small {\n  color: #666;\n  font-size: 12px;\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  padding: 15px 20px;\n}\n\n.history-item {\n  background: #2a2a2a;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  overflow: hidden;\n  transition: border-color 0.2s;\n}\n\n.history-item:hover {\n  border-color: #4a4a4a;\n}\n\n.history-header {\n  padding: 12px 15px;\n  background: #1a1a1a;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  user-select: none;\n  transition: background 0.2s;\n}\n\n.history-header:hover {\n  background: #2a2a2a;\n}\n\n.history-info {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  flex: 1;\n}\n\n.history-number {\n  color: #4a9eff;\n  font-weight: bold;\n}\n\n.history-range {\n  color: #888;\n  font-size: 12px;\n}\n\n.expand-icon {\n  color: #888;\n  font-size: 12px;\n}\n\n.history-content {\n  padding: 15px;\n  background: #2a2a2a;\n}\n\n.history-actions {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #3a3a3a;\n}\n\n.mini-button {\n  flex: 1;\n  padding: 6px 12px;\n  background: #2a2a2a;\n  border: 1px solid #3a3a3a;\n  border-radius: 4px;\n  color: #e0e0e0;\n  cursor: pointer;\n  font-size: 12px;\n  transition: background 0.2s;\n}\n\n.mini-button:hover {\n  background: #3a3a3a;\n}\n\n.mini-button.delete-button:hover {\n  background: #ff4444;\n  border-color: #ff4444;\n  color: white;\n}\n\n.mini-button.worldbook-button {\n  background: #28a745;\n  color: white;\n  border-color: #28a745;\n}\n\n.mini-button.worldbook-button:hover {\n  background: #218838;\n  border-color: #218838;\n  color: white;\n}\n\n.mini-button.create-worldbook-button {\n  background: #17a2b8;\n  color: white;\n  border-color: #17a2b8;\n}\n\n.mini-button.create-worldbook-button:hover {\n  background: #138496;\n  border-color: #138496;\n  color: white;\n}\n\n.mini-button.refresh-button {\n  background: #6c757d;\n  color: white;\n  border-color: #6c757d;\n}\n\n.mini-button.refresh-button:hover {\n  background: #5a6268;\n  border-color: #5a6268;\n  color: white;\n}\n\n.mini-button.debug-button {\n  background: #ffc107;\n  color: #000;\n  border-color: #ffb300;\n}\n\n.mini-button.debug-button:hover {\n  background: #e0a800;\n  border-color: #d39e00;\n  color: #000;\n}\n\n.history-text {\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  line-height: 1.6;\n  max-height: 400px;\n  overflow-y: auto;\n}\n</style>\n'],sourceRoot:''}]);const i=s},162:(n,e,t)=>{var o=t(55);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[n.id,o,'']]),o.locals&&(n.exports=o.locals);(0,t(424).A)('1ebe0c94',o,!1,{ssrId:!0})},193:(n,e,t)=>{t.d(e,{Ut:()=>a,aJ:()=>r,pA:()=>s});let o=null;function a(){if(!o)try{'function'==typeof getScriptId&&(o=getScriptId())}catch(n){console.warn('Ëé∑Âèñ script_id Â§±Ë¥•:',n)}return o}function r(n){o=n}function s(){try{if('function'==typeof window.getChatId)return window.getChatId();if(void 0!==window.SillyTavern&&window.SillyTavern.getCurrentChatId)return window.SillyTavern.getCurrentChatId()}catch(n){console.warn('Ëé∑Âèñ chat_id Â§±Ë¥•:',n)}return null}},241:(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});var o=t(790),a=t.n(o),r=t(54),s=t.n(r)()(a());s.push([n.id,'.memory-panel-container[data-v-4ef9901c]{display:flex;flex-direction:column;height:100%;background:#1a1a1a;color:#e0e0e0}.panel-header[data-v-4ef9901c]{padding:15px 20px;background:#2a2a2a;border-bottom:1px solid #3a3a3a;display:flex;justify-content:space-between;align-items:center;border-radius:8px 8px 0 0}.header-left[data-v-4ef9901c]{display:flex;align-items:center;gap:10px}.close-button[data-v-4ef9901c]{cursor:pointer;padding:5px 10px;border-radius:4px;transition:background 0.2s}.close-button[data-v-4ef9901c]:hover{background:rgba(255,255,255,0.1)}.panel-tabs[data-v-4ef9901c]{display:flex;background:#2a2a2a;border-bottom:1px solid #3a3a3a}.tab-item[data-v-4ef9901c]{flex:1;padding:12px 20px;cursor:pointer;text-align:center;transition:background 0.2s,color 0.2s;display:flex;align-items:center;justify-content:center;gap:8px;border-bottom:2px solid transparent}.tab-item[data-v-4ef9901c]:hover{background:rgba(255,255,255,0.05)}.tab-item.tab-active[data-v-4ef9901c]{background:#1a1a1a;color:#4a9eff;border-bottom-color:#4a9eff}.panel-content[data-v-4ef9901c]{flex:1;overflow-y:auto;overflow-x:hidden;padding:0;min-height:0;scrollbar-width:thin;scrollbar-color:#4a9eff #2a2a2a}.panel-content[data-v-4ef9901c]::-webkit-scrollbar{width:8px}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-thumb{background:#4a9eff;border-radius:4px}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-thumb:hover{background:#5ba8ff}.panel-content[data-v-4ef9901c]{scrollbar-width:thin !important;scrollbar-color:#4a9eff #2a2a2a !important}.panel-content[data-v-4ef9901c]::-webkit-scrollbar{width:8px !important;display:block !important}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-track{background:#2a2a2a !important;border-radius:4px !important}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-thumb{background:#4a9eff !important;border-radius:4px !important}.panel-content[data-v-4ef9901c]::-webkit-scrollbar-thumb:hover{background:#5ba8ff !important}\n','',{version:3,sources:['webpack://./src/ËÆ∞ÂøÜ/components/MainPanel.vue'],names:[],mappings:'AAgIA,yCACE,YAAa,CACb,qBAAsB,CACtB,WAAY,CACZ,kBAAmB,CACnB,aACF,CAEA,+BACE,iBAAkB,CAClB,kBAAmB,CACnB,+BAAgC,CAChC,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,yBACF,CAEA,8BACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,+BACE,cAAe,CACf,gBAAiB,CACjB,iBAAkB,CAClB,0BACF,CAEA,qCACE,gCACF,CAEA,6BACE,YAAa,CACb,kBAAmB,CACnB,+BACF,CAEA,2BACE,MAAO,CACP,iBAAkB,CAClB,cAAe,CACf,iBAAkB,CAClB,qCAEY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,OAAQ,CACR,mCACF,CAEA,iCACE,iCACF,CAEA,sCACE,kBAAmB,CACnB,aAAc,CACd,2BACF,CAEA,gCACE,MAAO,CACP,eAAgB,CAChB,iBAAkB,CAClB,SAAU,CACV,YAAa,CACb,oBAAqB,CACrB,+BACF,CAEA,mDACE,SACF,CAEA,yDACE,kBAAmB,CACnB,iBACF,CAEA,yDACE,kBAAmB,CACnB,iBACF,CAEA,+DACE,kBACF,CAGA,gCACE,+BAAgC,CAChC,0CACF,CAEA,mDACE,oBAAqB,CACrB,wBACF,CAEA,yDACE,6BAA8B,CAC9B,4BACF,CAEA,yDACE,6BAA8B,CAC9B,4BACF,CAEA,+DACE,6BACF',sourcesContent:['<template>\n  <div\n    class="memory-panel-container"\n    style="display: flex; flex-direction: column; height: 100%; background: #1a1a1a; color: #e0e0e0"\n  >\n    \x3c!-- Èù¢ÊùøÂ§¥ÈÉ® --\x3e\n    <div\n      class="panel-header"\n      style="\n        padding: 15px 20px;\n        background: #2a2a2a;\n        border-bottom: 1px solid #3a3a3a;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        border-radius: 8px 8px 0 0;\n        flex-shrink: 0;\n      "\n    >\n      <div class="header-left" style="display: flex; align-items: center; gap: 10px">\n        <span style="font-size: 24px">üê±</span>\n        <b>mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇ</b>\n      </div>\n      <div\n        class="close-button"\n        style="cursor: pointer; padding: 5px 10px; border-radius: 4px; transition: background 0.2s"\n        @click="closePanel"\n      >\n        <i class="fa-solid fa-times"></i>\n      </div>\n    </div>\n\n    \x3c!-- Èù¢ÊùøÊ†áÁ≠æÊ†è --\x3e\n    <div\n      class="panel-tabs"\n      style="display: flex; background: #2a2a2a; border-bottom: 1px solid #3a3a3a; flex-shrink: 0"\n    >\n      <div\n        v-for="tab in tabs"\n        :key="tab.key"\n        :class="{ \'tab-active\': activeTab === tab.key }"\n        class="tab-item"\n        :style="{\n          flex: \'1\',\n          padding: \'12px 20px\',\n          cursor: \'pointer\',\n          textAlign: \'center\',\n          transition: \'background 0.2s, color 0.2s\',\n          display: \'flex\',\n          alignItems: \'center\',\n          justifyContent: \'center\',\n          gap: \'8px\',\n          borderBottom: \'2px solid transparent\',\n          backgroundColor: activeTab === tab.key ? \'#1a1a1a\' : \'transparent\',\n          color: activeTab === tab.key ? \'#4a9eff\' : \'#e0e0e0\',\n          borderBottomColor: activeTab === tab.key ? \'#4a9eff\' : \'transparent\',\n        }"\n        @click="switchTab(tab.key)"\n      >\n        <i :class="tab.icon"></i>\n        {{ tab.label }}\n      </div>\n    </div>\n\n    \x3c!-- Èù¢ÊùøÂÜÖÂÆπ --\x3e\n    <div\n      class="panel-content"\n      style="\n        flex: 1;\n        overflow-y: auto;\n        overflow-x: hidden;\n        padding: 0;\n        min-height: 0;\n        scrollbar-width: thin;\n        scrollbar-color: #4a9eff #2a2a2a;\n      "\n    >\n      <component :is="currentComponent" :key="activeTab" v-bind="componentProps" />\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { computed, ref } from \'vue\';\nimport SettingsTab from \'./SettingsTab.vue\';\nimport SummaryTab from \'./SummaryTab.vue\';\nimport TableTab from \'./TableTab.vue\';\nimport ToolsTab from \'./ToolsTab.vue\';\n\n// Ê†áÁ≠æÈ°µÈÖçÁΩÆ\nconst tabs = [\n  { key: \'summary\', label: \'ÂéÜÂè≤ÊÄªÁªì\', icon: \'fa-solid fa-list\' },\n  { key: \'table\', label: \'Ë°®Ê†º\', icon: \'fa-solid fa-table\' },\n  { key: \'settings\', label: \'ËÆæÁΩÆ\', icon: \'fa-solid fa-cog\' },\n  { key: \'tools\', label: \'Â∑•ÂÖ∑Ê®°Êùø\', icon: \'fa-solid fa-tools\' },\n];\n\nconst activeTab = ref<\'summary\' | \'table\' | \'settings\' | \'tools\'>(\'settings\');\n\n// ÁªÑ‰ª∂Êò†Â∞Ñ\nconst componentMap = {\n  summary: SummaryTab,\n  table: TableTab,\n  settings: SettingsTab,\n  tools: ToolsTab,\n};\n\n// ÂΩìÂâçÁªÑ‰ª∂\nconst currentComponent = computed(() => componentMap[activeTab.value]);\n\n// ÁªÑ‰ª∂Â±ûÊÄß\nconst componentProps = computed(() => ({\n  activeTab: activeTab.value,\n}));\n\n// ÂàáÊç¢Ê†áÁ≠æÈ°µ\nconst switchTab = (tabKey: string) => {\n  console.log(\'ÂàáÊç¢Ê†áÁ≠æÈ°µ:\', tabKey);\n  activeTab.value = tabKey as any;\n};\n\n// ÂÖ≥Èó≠Èù¢Êùø\nconst closePanel = () => {\n  $(\'#memoryManagementPanel\').fadeOut(200);\n};\n<\/script>\n\n<style scoped>\n.memory-panel-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: #1a1a1a;\n  color: #e0e0e0;\n}\n\n.panel-header {\n  padding: 15px 20px;\n  background: #2a2a2a;\n  border-bottom: 1px solid #3a3a3a;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-radius: 8px 8px 0 0;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.close-button {\n  cursor: pointer;\n  padding: 5px 10px;\n  border-radius: 4px;\n  transition: background 0.2s;\n}\n\n.close-button:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.panel-tabs {\n  display: flex;\n  background: #2a2a2a;\n  border-bottom: 1px solid #3a3a3a;\n}\n\n.tab-item {\n  flex: 1;\n  padding: 12px 20px;\n  cursor: pointer;\n  text-align: center;\n  transition:\n    background 0.2s,\n    color 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  border-bottom: 2px solid transparent;\n}\n\n.tab-item:hover {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.tab-item.tab-active {\n  background: #1a1a1a;\n  color: #4a9eff;\n  border-bottom-color: #4a9eff;\n}\n\n.panel-content {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0;\n  min-height: 0;\n  scrollbar-width: thin;\n  scrollbar-color: #4a9eff #2a2a2a;\n}\n\n.panel-content::-webkit-scrollbar {\n  width: 8px;\n}\n\n.panel-content::-webkit-scrollbar-track {\n  background: #2a2a2a;\n  border-radius: 4px;\n}\n\n.panel-content::-webkit-scrollbar-thumb {\n  background: #4a9eff;\n  border-radius: 4px;\n}\n\n.panel-content::-webkit-scrollbar-thumb:hover {\n  background: #5ba8ff;\n}\n\n/* Á°Æ‰øùÊªöÂä®Êù°ÂßãÁªàÊòæÁ§∫ */\n.panel-content {\n  scrollbar-width: thin !important;\n  scrollbar-color: #4a9eff #2a2a2a !important;\n}\n\n.panel-content::-webkit-scrollbar {\n  width: 8px !important;\n  display: block !important;\n}\n\n.panel-content::-webkit-scrollbar-track {\n  background: #2a2a2a !important;\n  border-radius: 4px !important;\n}\n\n.panel-content::-webkit-scrollbar-thumb {\n  background: #4a9eff !important;\n  border-radius: 4px !important;\n}\n\n.panel-content::-webkit-scrollbar-thumb:hover {\n  background: #5ba8ff !important;\n}\n</style>\n'],sourceRoot:''}]);const i=s},254:(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});var o=t(790),a=t.n(o),r=t(54),s=t.n(r)()(a());s.push([n.id,'.tools-tab[data-v-0c833396]{height:100%;overflow-y:auto;padding:25px !important}.section-header[data-v-0c833396]{display:flex;align-items:center;justify-content:space-between;padding:15px 20px;background:linear-gradient(135deg,#2a2a2a 0%,#3a3a3a 100%);border-radius:8px;cursor:pointer;transition:all 0.3s ease;margin-bottom:15px;border:1px solid #3a3a3a}.section-header[data-v-0c833396]:hover{background:linear-gradient(135deg,#3a3a3a 0%,#4a4a4a 100%);transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.3)}.tool-content[data-v-0c833396]{background:#1e1e1e;border:1px solid #3a3a3a;border-radius:8px;padding:20px;margin-bottom:20px}.tool-instructions[data-v-0c833396]{background:#1a1a1a;border:1px solid #3a3a3a;border-radius:6px;padding:12px;color:#ccc;font-size:12px;margin-bottom:15px}.form-group[data-v-0c833396]{margin-bottom:15px}.button-group[data-v-0c833396]{display:flex;gap:12px;margin-bottom:20px}.output-section[data-v-0c833396]{margin-top:20px}.output-content[data-v-0c833396]{background:#1e1e1e;border:1px solid #3a3a3a;border-radius:6px;padding:15px;color:#e0e0e0;font-size:13px;line-height:1.6;white-space:pre-wrap;word-wrap:break-word;max-height:300px;overflow-y:auto}.output-actions[data-v-0c833396]{margin-top:12px;display:flex;gap:12px}.process-button[data-v-0c833396],.clear-button[data-v-0c833396],.generate-button[data-v-0c833396],.copy-button[data-v-0c833396]{position:relative;overflow:hidden;transition:all 0.3s ease}.process-button[data-v-0c833396]:hover:not(:disabled),.clear-button[data-v-0c833396]:hover:not(:disabled),.generate-button[data-v-0c833396]:hover:not(:disabled),.copy-button[data-v-0c833396]:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.3)}.copy-button[data-v-0c833396]:hover{background:#218838 !important}.tool-instructions[data-v-0c833396]{background:#1a1a1a;border:1px solid #3a3a3a;border-radius:6px;padding:12px;color:#ccc;font-size:12px;margin-bottom:15px}.process-button:hover:not(:disabled) .shimmer-effect[data-v-0c833396],.clear-button:hover:not(:disabled) .shimmer-effect[data-v-0c833396],.generate-button:hover:not(:disabled) .shimmer-effect[data-v-0c833396],.copy-button:hover .shimmer-effect[data-v-0c833396]{left:100%}.process-button[data-v-0c833396]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,0.4)}.clear-button[data-v-0c833396]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px rgba(255,107,107,0.4)}.generate-button[data-v-0c833396]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px rgba(23,162,184,0.4)}.copy-button[data-v-0c833396]:hover{transform:translateY(-1px);box-shadow:0 5px 15px rgba(40,167,69,0.4)}.process-button[data-v-0c833396]:disabled,.clear-button[data-v-0c833396]:disabled,.generate-button[data-v-0c833396]:disabled{opacity:0.6;cursor:not-allowed;transform:none}.process-button[data-v-0c833396]:disabled:hover,.clear-button[data-v-0c833396]:disabled:hover,.generate-button[data-v-0c833396]:disabled:hover{transform:none;box-shadow:none}.output-content[data-v-0c833396]::-webkit-scrollbar{width:6px}.output-content[data-v-0c833396]::-webkit-scrollbar-track{background:#1a1a1a;border-radius:3px}.output-content[data-v-0c833396]::-webkit-scrollbar-thumb{background:#3a3a3a;border-radius:3px}.output-content[data-v-0c833396]::-webkit-scrollbar-thumb:hover{background:#4a4a4a}@media (max-width:768px){.button-group[data-v-0c833396]{flex-direction:column}.output-actions[data-v-0c833396]{flex-direction:column}}\n','',{version:3,sources:['webpack://./src/ËÆ∞ÂøÜ/components/ToolsTab.vue'],names:[],mappings:'AA62CA,4BACE,WAAY,CACZ,eAAgB,CAChB,uBACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,iBAAkB,CAClB,0DAA6D,CAC7D,iBAAkB,CAClB,cAAe,CACf,wBAAyB,CACzB,kBAAmB,CACnB,wBACF,CAEA,uCACE,0DAA6D,CAC7D,0BAA2B,CAC3B,qCACF,CAEA,+BACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,YAAa,CACb,kBACF,CAEA,oCACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,YAAa,CACb,UAAW,CACX,cAAe,CACf,kBACF,CAEA,6BACE,kBACF,CAEA,+BACE,YAAa,CACb,QAAS,CACT,kBACF,CAEA,iCACE,eACF,CAEA,iCACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,YAAa,CACb,aAAc,CACd,cAAe,CACf,eAAgB,CAChB,oBAAqB,CACrB,oBAAqB,CACrB,gBAAiB,CACjB,eACF,CAEA,iCACE,eAAgB,CAChB,YAAa,CACb,QACF,CAGA,gIAIE,iBAAkB,CAClB,eAAgB,CAChB,wBACF,CAEA,qMAIE,0BAA2B,CAC3B,qCACF,CAEA,oCACE,6BACF,CAEA,oCACE,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,YAAa,CACb,UAAW,CACX,cAAe,CACf,kBACF,CAGA,qQAIE,SACF,CAEA,sDACE,0BAA2B,CAC3B,2CACF,CAEA,oDACE,0BAA2B,CAC3B,2CACF,CAEA,uDACE,0BAA2B,CAC3B,0CACF,CAEA,oCACE,0BAA2B,CAC3B,yCACF,CAEA,6HAGE,WAAY,CACZ,kBAAmB,CACnB,cACF,CAEA,+IAGE,cAAe,CACf,eACF,CAGA,oDACE,SACF,CAEA,0DACE,kBAAmB,CACnB,iBACF,CAEA,0DACE,kBAAmB,CACnB,iBACF,CAEA,gEACE,kBACF,CAGA,yBACE,+BACE,qBACF,CAEA,iCACE,qBACF,CACF',sourcesContent:['<template>\n  <div class="tools-tab" style="padding: 25px !important; background: #1a1a1a !important">\n    \x3c!-- ÂèçÂÖ´ËÇ°Â∑•ÂÖ∑ --\x3e\n    <div class="tool-section">\n      <div class="section-header" @click="toggleToolExpanded(\'antiCliche\')">\n        <h4 style="margin: 0; color: #fff; font-size: 16px; font-weight: 600">\n          <i class="fa-solid fa-broom" style="margin-right: 8px; color: #ff6b6b"></i>\n          ÂèçÂÖ´ËÇ°Â∑•ÂÖ∑\n        </h4>\n        <i\n          :class="isToolExpanded(\'antiCliche\') ? \'fa-solid fa-chevron-up\' : \'fa-solid fa-chevron-down\'"\n          style="color: #ccc; transition: transform 0.3s ease"\n        ></i>\n      </div>\n\n      <div v-if="isToolExpanded(\'antiCliche\')" class="tool-content">\n        <div class="tool-instructions">\n          <p style="margin: 0 0 8px 0; color: #ccc; font-size: 12px">\n            <i class="fa-solid fa-info-circle" style="margin-right: 6px; color: #17a2b8"></i>\n            ËßíËâ≤Âç°/‰∏ñÁïå‰π¶/ÂºÄÂú∫ÁôΩÂÖ´ËÇ°Ê∏ÖÁêÜÂ∑•ÂÖ∑ÔºåÁ≥ªÁªüÂåñÊâßË°å9‰∏™Ê≠•È™§ÔºåÊ∏ÖÈô§200+Á¶ÅÁî®ËØç„ÄÇ\n          </p>\n          <p\n            style="\n              margin: 0;\n              color: #ffa500;\n              font-size: 11px;\n              background: #1a1a1a;\n              padding: 6px;\n              border-radius: 4px;\n              border-left: 3px solid #ffa500;\n            "\n          >\n            ‚ö° Ê∏ÖÁêÜÂÜÖÂÆπÔºöÊ®°Á≥äËØç„ÄÅÂä®Áâ©ÂåñÊØîÂñª„ÄÅËØ≠Ê∞îÂ£∞Èü≥„ÄÅÂæÆË°®ÊÉÖ„ÄÅÂê¶ÂÆöÂè•Âºè„ÄÅÁªùÊúõ/Á•ûÂåñÂÄæÂêë„ÄÅNSFWÊÄßÁãÇÈáéÁ≠â\n          </p>\n        </div>\n\n        <div class="form-group" style="margin: 15px 0">\n          <label style="display: block; margin-bottom: 8px; color: #ccc; font-size: 13px; font-weight: 500">\n            ËæìÂÖ•ÊñáÊú¨Ôºö\n          </label>\n          <textarea\n            v-model="antiClicheInput"\n            placeholder="ËØ∑ËæìÂÖ•ÈúÄË¶ÅÊ∏ÖÁêÜÁöÑÊñáÊú¨..."\n            style="\n              width: 100%;\n              height: 120px;\n              padding: 12px;\n              background: #2a2a2a;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              color: #e0e0e0;\n              font-size: 13px;\n              resize: vertical;\n              font-family: inherit;\n            "\n          ></textarea>\n        </div>\n\n        <div class="button-group" style="display: flex; gap: 12px; margin-bottom: 20px">\n          <button\n            class="process-button"\n            :disabled="isProcessingAntiCliche || !antiClicheInput.trim()"\n            style="\n              padding: 12px 24px;\n              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n              border: none;\n              border-radius: 8px;\n              color: white;\n              font-size: 13px;\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 3px 12px rgba(102, 126, 234, 0.3);\n              position: relative;\n              overflow: hidden;\n            "\n            @click="handleAntiClicheProcess"\n          >\n            <div\n              style="\n                position: absolute;\n                top: 0;\n                left: -100%;\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                transition: left 0.5s;\n              "\n              class="shimmer-effect"\n            ></div>\n            <i class="fa-solid fa-magic" style="font-size: 14px; margin-right: 6px"></i>\n            {{ isProcessingAntiCliche ? \'Â§ÑÁêÜ‰∏≠...\' : \'ÂºÄÂßãÊ∏ÖÁêÜ\' }}\n          </button>\n\n          <button\n            class="clear-button"\n            style="\n              padding: 12px 24px;\n              background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);\n              border: none;\n              border-radius: 8px;\n              color: white;\n              font-size: 13px;\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 3px 12px rgba(255, 107, 107, 0.3);\n              position: relative;\n              overflow: hidden;\n            "\n            @click="clearAntiClicheForm"\n          >\n            <div\n              style="\n                position: absolute;\n                top: 0;\n                left: -100%;\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                transition: left 0.5s;\n              "\n              class="shimmer-effect"\n            ></div>\n            <i class="fa-solid fa-trash" style="font-size: 14px; margin-right: 6px"></i>\n            Ê∏ÖÁ©∫\n          </button>\n        </div>\n\n        \x3c!-- ËæìÂá∫Âå∫Âüü --\x3e\n        <div v-if="antiClicheOutput" class="output-section">\n          <h5 style="margin: 0 0 12px 0; color: #fff; font-size: 14px; font-weight: 600">\n            <i class="fa-solid fa-check-circle" style="margin-right: 6px; color: #28a745"></i>\n            Ê∏ÖÁêÜÁªìÊûúÔºö\n          </h5>\n          <div\n            class="output-content"\n            style="\n              background: #1e1e1e;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              padding: 15px;\n              color: #e0e0e0;\n              font-size: 13px;\n              line-height: 1.6;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              max-height: 300px;\n              overflow-y: auto;\n            "\n          >\n            {{ antiClicheOutput }}\n          </div>\n\n          <div class="output-actions" style="margin-top: 12px; display: flex; gap: 12px">\n            <button\n              class="copy-button"\n              style="\n                padding: 10px 20px;\n                background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n                border: none;\n                border-radius: 6px;\n                color: white;\n                font-size: 13px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                box-shadow: 0 3px 12px rgba(40, 167, 69, 0.3);\n                position: relative;\n                overflow: hidden;\n              "\n              @click="copyAntiClicheResult"\n            >\n              <div\n                style="\n                  position: absolute;\n                  top: 0;\n                  left: -100%;\n                  width: 100%;\n                  height: 100%;\n                  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                  transition: left 0.5s;\n                "\n                class="shimmer-effect"\n              ></div>\n              <i class="fa-solid fa-copy" style="font-size: 14px"></i> Â§çÂà∂ÁªìÊûú\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- ËßíËâ≤Âç°ÁîüÊàêÂ∑•ÂÖ∑ --\x3e\n    <div class="tool-section">\n      <div class="section-header" @click="toggleToolExpanded(\'characterCard\')">\n        <h4 style="margin: 0; color: #fff; font-size: 16px; font-weight: 600">\n          <i class="fa-solid fa-user-plus" style="margin-right: 8px; color: #17a2b8"></i>\n          ËßíËâ≤Âç°ÁîüÊàêÂ∑•ÂÖ∑\n        </h4>\n        <i\n          :class="isToolExpanded(\'characterCard\') ? \'fa-solid fa-chevron-up\' : \'fa-solid fa-chevron-down\'"\n          style="color: #ccc; transition: transform 0.3s ease"\n        ></i>\n      </div>\n\n      <div v-if="isToolExpanded(\'characterCard\')" class="tool-content">\n        <div class="tool-instructions">\n          <p style="margin: 0 0 8px 0; color: #ccc; font-size: 12px">\n            <i class="fa-solid fa-info-circle" style="margin-right: 6px; color: #17a2b8"></i>\n            ËæìÂÖ•ËßíËâ≤ÊèèËø∞ÔºåAIÂ∞ÜËá™Âä®ÁîüÊàêËßíËâ≤Âç°ÔºàYAML Ê†ºÂºèÔºåÁ∫Ø‰∏≠ÊñáÔºâ„ÄÇ\n          </p>\n          <p\n            style="\n              margin: 0 0 6px 0;\n              color: #4a9eff;\n              font-size: 11px;\n              background: #1a1a1a;\n              padding: 6px;\n              border-radius: 4px;\n              border-left: 3px solid #17a2b8;\n            "\n          >\n            üí° ÂåÖÂê´ÂÜÖÂÆπÔºöÂü∫Á°Ä‰ø°ÊÅØ„ÄÅÂ§ñË≤åË∫´Êùê„ÄÅÊ†∏ÂøÉÊÄßÊ†º„ÄÅÂØπËØùÈ£éÊ†º„ÄÅËÉåÊôØÁªèÂéÜ„ÄÅ‰∫∫ÈôÖÂÖ≥Á≥ª„ÄÅÊºîÁªéÊåáÂØº\n          </p>\n          <p\n            style="\n              margin: 0 0 6px 0;\n              color: #ffa500;\n              font-size: 11px;\n              background: #1a1a1a;\n              padding: 6px;\n              border-radius: 4px;\n              border-left: 3px solid #ffa500;\n            "\n          >\n            ‚ö†Ô∏è Ê≥®ÊÑèÔºöË∫´È´ò‰ΩìÈáç‰ΩøÁî®ÊñáÂ≠óÊèèËø∞ÔºàÂ¶Ç"È´òÂ§ßÂåÄÁß∞"ÔºâÔºåÈÅøÂÖçAIÂàªÊùøÂåñÔºåÊúâÊÄßÊ†ºÂØπÁ´ãÈù¢Âíå‰øÆÂ§çÊú∫Âà∂\n          </p>\n        </div>\n\n        <div class="form-group" style="margin: 15px 0">\n          <label style="display: block; margin-bottom: 8px; color: #ccc; font-size: 13px; font-weight: 500">\n            ËßíËâ≤ÊèèËø∞Ôºö\n          </label>\n          <textarea\n            v-model="characterDescription"\n            placeholder="ËØ∑ÊèèËø∞ËßíËâ≤ÁöÑÂü∫Êú¨‰ø°ÊÅØÔºåÂ¶ÇÂ§ñËßÇ„ÄÅÊÄßÊ†º„ÄÅËÉåÊôØÁ≠â..."\n            style="\n              width: 100%;\n              height: 120px;\n              padding: 12px;\n              background: #2a2a2a;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              color: #e0e0e0;\n              font-size: 13px;\n              resize: vertical;\n              font-family: inherit;\n            "\n          ></textarea>\n        </div>\n\n        <div class="button-group" style="display: flex; gap: 12px; margin-bottom: 20px">\n          <button\n            class="generate-button"\n            :disabled="isGeneratingCharacter || !characterDescription.trim()"\n            style="\n              padding: 12px 24px;\n              background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);\n              border: none;\n              border-radius: 8px;\n              color: white;\n              font-size: 13px;\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 3px 12px rgba(23, 162, 184, 0.3);\n              position: relative;\n              overflow: hidden;\n            "\n            @click="handleGenerateCharacterCard"\n          >\n            <div\n              style="\n                position: absolute;\n                top: 0;\n                left: -100%;\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                transition: left 0.5s;\n              "\n              class="shimmer-effect"\n            ></div>\n            <i class="fa-solid fa-magic" style="font-size: 14px; margin-right: 6px"></i>\n            {{ isGeneratingCharacter ? \'ÁîüÊàê‰∏≠...\' : \'ÁîüÊàêËßíËâ≤Âç°\' }}\n          </button>\n\n          <button\n            class="clear-button"\n            style="\n              padding: 12px 24px;\n              background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);\n              border: none;\n              border-radius: 8px;\n              color: white;\n              font-size: 13px;\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 3px 12px rgba(255, 107, 107, 0.3);\n              position: relative;\n              overflow: hidden;\n            "\n            @click="clearCharacterForm"\n          >\n            <div\n              style="\n                position: absolute;\n                top: 0;\n                left: -100%;\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                transition: left 0.5s;\n              "\n              class="shimmer-effect"\n            ></div>\n            <i class="fa-solid fa-trash" style="font-size: 14px; margin-right: 6px"></i>\n            Ê∏ÖÁ©∫\n          </button>\n        </div>\n\n        \x3c!-- ËæìÂá∫Âå∫Âüü --\x3e\n        <div v-if="characterCardOutput" class="output-section">\n          <h5 style="margin: 0 0 12px 0; color: #fff; font-size: 14px; font-weight: 600">\n            <i class="fa-solid fa-check-circle" style="margin-right: 6px; color: #28a745"></i>\n            ÁîüÊàêÁöÑËßíËâ≤Âç°Ôºö\n          </h5>\n          <div\n            class="output-content"\n            style="\n              background: #1e1e1e;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              padding: 15px;\n              color: #e0e0e0;\n              font-size: 13px;\n              line-height: 1.6;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              max-height: 300px;\n              overflow-y: auto;\n            "\n          >\n            {{ characterCardOutput }}\n          </div>\n\n          <div class="output-actions" style="margin-top: 12px; display: flex; gap: 12px">\n            <button\n              class="copy-button"\n              style="\n                padding: 10px 20px;\n                background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n                border: none;\n                border-radius: 6px;\n                color: white;\n                font-size: 13px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                box-shadow: 0 3px 12px rgba(40, 167, 69, 0.3);\n                position: relative;\n                overflow: hidden;\n              "\n              @click="copyCharacterCard"\n            >\n              <div\n                style="\n                  position: absolute;\n                  top: 0;\n                  left: -100%;\n                  width: 100%;\n                  height: 100%;\n                  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                  transition: left 0.5s;\n                "\n                class="shimmer-effect"\n              ></div>\n              <i class="fa-solid fa-copy" style="font-size: 14px"></i> Â§çÂà∂ËßíËâ≤Âç°\n            </button>\n          </div>\n\n          \x3c!-- ËßíËâ≤Âç°‰øÆÊîπÂå∫Âüü --\x3e\n          <div class="modify-section" style="margin-top: 25px; border-top: 2px dashed #3a3a3a; padding-top: 20px">\n            <h5 style="margin: 0 0 12px 0; color: #fff; font-size: 14px; font-weight: 600">\n              <i class="fa-solid fa-edit" style="margin-right: 6px; color: #ffa500"></i>\n              ‰øÆÊîπËßíËâ≤Âç°\n            </h5>\n            <div\n              class="modify-instructions"\n              style="\n                background: #1a1a1a;\n                border: 1px solid #3a3a3a;\n                border-radius: 6px;\n                padding: 10px;\n                margin-bottom: 15px;\n              "\n            >\n              <p style="margin: 0 0 6px 0; color: #ccc; font-size: 12px">\n                <i class="fa-solid fa-lightbulb" style="margin-right: 6px; color: #ffa500"></i>\n                ÊèèËø∞‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÁöÑÂÜÖÂÆπÔºåAI‰ºöÊ†πÊçÆ‰Ω†ÁöÑÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°„ÄÇ‰æãÂ¶ÇÔºö"ËÆ©ËßíËâ≤Êõ¥Ê¥ªÊ≥º‰∏Ä‰∫õ"„ÄÅ"Â¢ûÂä†È≠îÊ≥ïÊäÄËÉΩ"„ÄÅ"Êîπ‰∏∫Â•≥ÊÄßËßíËâ≤"Á≠â„ÄÇ\n              </p>\n              <p style="margin: 0; color: #ffa500; font-size: 11px">‚ö†Ô∏è ‰øÆÊîπÂêé‰ºö‰øùÊåÅ YAML Ê†ºÂºèÂíå‰∏≠ÊñáÂ≠óÊÆµ„ÄÇ</p>\n            </div>\n\n            <div class="form-group" style="margin: 15px 0">\n              <label style="display: block; margin-bottom: 8px; color: #ccc; font-size: 13px; font-weight: 500">\n                ‰øÆÊîπÈúÄÊ±ÇÔºö\n              </label>\n              <textarea\n                v-model="modifyRequest"\n                placeholder="ËØ∑ÊèèËø∞‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÁöÑÂÜÖÂÆπ..."\n                style="\n                  width: 100%;\n                  height: 80px;\n                  padding: 12px;\n                  background: #2a2a2a;\n                  border: 1px solid #3a3a3a;\n                  border-radius: 6px;\n                  color: #e0e0e0;\n                  font-size: 13px;\n                  resize: vertical;\n                  font-family: inherit;\n                "\n              ></textarea>\n            </div>\n\n            <div class="button-group" style="display: flex; gap: 12px; margin-bottom: 15px">\n              <button\n                class="modify-button"\n                :disabled="isModifyingCharacter || !modifyRequest.trim()"\n                style="\n                  padding: 12px 24px;\n                  background: linear-gradient(135deg, #ffa500 0%, #ff8c00 100%);\n                  border: none;\n                  border-radius: 8px;\n                  color: white;\n                  font-size: 13px;\n                  font-weight: 600;\n                  cursor: pointer;\n                  transition: all 0.3s ease;\n                  box-shadow: 0 3px 12px rgba(255, 165, 0, 0.3);\n                  position: relative;\n                  overflow: hidden;\n                "\n                @click="handleModifyCharacterCard"\n              >\n                <div\n                  style="\n                    position: absolute;\n                    top: 0;\n                    left: -100%;\n                    width: 100%;\n                    height: 100%;\n                    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                    transition: left 0.5s;\n                  "\n                  class="shimmer-effect"\n                ></div>\n                <i class="fa-solid fa-wand-magic-sparkles" style="font-size: 14px; margin-right: 6px"></i>\n                {{ isModifyingCharacter ? \'‰øÆÊîπ‰∏≠...\' : \'AI‰øÆÊîπ\' }}\n              </button>\n\n              <button\n                class="clear-modify-button"\n                style="\n                  padding: 12px 24px;\n                  background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);\n                  border: none;\n                  border-radius: 8px;\n                  color: white;\n                  font-size: 13px;\n                  font-weight: 600;\n                  cursor: pointer;\n                  transition: all 0.3s ease;\n                  box-shadow: 0 3px 12px rgba(108, 117, 125, 0.3);\n                  position: relative;\n                  overflow: hidden;\n                "\n                @click="clearModifyRequest"\n              >\n                <div\n                  style="\n                    position: absolute;\n                    top: 0;\n                    left: -100%;\n                    width: 100%;\n                    height: 100%;\n                    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n                    transition: left 0.5s;\n                  "\n                  class="shimmer-effect"\n                ></div>\n                <i class="fa-solid fa-eraser" style="font-size: 14px; margin-right: 6px"></i>\n                Ê∏ÖÁ©∫‰øÆÊîπÈúÄÊ±Ç\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { debounce } from \'lodash\';\nimport { storeToRefs } from \'pinia\';\nimport { onMounted, ref, watch } from \'vue\';\nimport { getScriptIdSafe } from \'ËÆ∞ÂøÜ/utils\';\nimport { useSettingsStore } from \'../settings\';\n\nconst settingsStore = useSettingsStore();\nconst { settings } = storeToRefs(settingsStore);\n\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\nconst toolExpandedState = ref(new Map<string, boolean>());\nconst antiClicheInput = ref(\'\');\nconst antiClicheOutput = ref(\'\');\nconst isProcessingAntiCliche = ref(false);\nconst characterDescription = ref(\'\');\nconst characterCardOutput = ref(\'\');\nconst isGeneratingCharacter = ref(false);\nconst modifyRequest = ref(\'\');\nconst isModifyingCharacter = ref(false);\n\n// Ê†áÂøó‰ΩçÔºöÊòØÂê¶Â∑≤ÂÆåÊàêÂàùÂßãÂä†ËΩΩÔºàÈÅøÂÖçÂä†ËΩΩÊó∂Ëß¶Âèë‰øùÂ≠òÔºâ\nconst isDataLoaded = ref(false);\n\n// ‰ªéÈÖíÈ¶ÜÂèòÈáèÂä†ËΩΩÂ∑•ÂÖ∑Êï∞ÊçÆ\nconst loadToolsData = () => {\n  try {\n    isDataLoaded.value = false; // Âä†ËΩΩÊúüÈó¥ÊöÇÂÅúËá™Âä®‰øùÂ≠ò\n    const script_id = getScriptIdSafe();\n    if (!script_id) {\n      console.warn(\'‚ö†Ô∏è script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÊï∞ÊçÆ\');\n      isDataLoaded.value = true;\n      return;\n    }\n    const savedData = getVariables({ type: \'script\', script_id });\n\n    console.log(\'üì• Âä†ËΩΩÂ∑•ÂÖ∑Êï∞ÊçÆ:\', savedData);\n\n    // Âä†ËΩΩÂèçÂÖ´ËÇ°Êï∞ÊçÆ\n    if (savedData.tools_antiCliche) {\n      antiClicheInput.value = savedData.tools_antiCliche.input || \'\';\n      antiClicheOutput.value = savedData.tools_antiCliche.output || \'\';\n      console.log(\'‚úÖ Â∑≤ÊÅ¢Â§çÂèçÂÖ´ËÇ°Êï∞ÊçÆ:\', {\n        input: antiClicheInput.value.substring(0, 50),\n        output: antiClicheOutput.value.substring(0, 50),\n      });\n    }\n\n    // Âä†ËΩΩËßíËâ≤Âç°Êï∞ÊçÆ\n    if (savedData.tools_characterCard) {\n      characterDescription.value = savedData.tools_characterCard.description || \'\';\n      characterCardOutput.value = savedData.tools_characterCard.output || \'\';\n      modifyRequest.value = savedData.tools_characterCard.modifyRequest || \'\';\n      console.log(\'‚úÖ Â∑≤ÊÅ¢Â§çËßíËâ≤Âç°Êï∞ÊçÆ:\', {\n        description: characterDescription.value.substring(0, 50),\n        output: characterCardOutput.value.substring(0, 50),\n        modifyRequest: modifyRequest.value.substring(0, 50),\n      });\n    }\n\n    // Âä†ËΩΩÂ±ïÂºÄÁä∂ÊÄÅ\n    if (savedData.tools_expandedState) {\n      toolExpandedState.value = new Map(Object.entries(savedData.tools_expandedState));\n      console.log(\'‚úÖ Â∑≤ÊÅ¢Â§çÂ±ïÂºÄÁä∂ÊÄÅ:\', Object.fromEntries(toolExpandedState.value));\n    }\n\n    // Âª∂ËøüÂêØÁî®Ëá™Âä®‰øùÂ≠òÔºåÈÅøÂÖçÂä†ËΩΩÊó∂Ëß¶Âèë\n    setTimeout(() => {\n      isDataLoaded.value = true;\n      console.log(\'‚úÖ Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÔºåÂêØÁî®Ëá™Âä®‰øùÂ≠ò\');\n    }, 100);\n  } catch (error) {\n    console.error(\'‚ùå Âä†ËΩΩÂ∑•ÂÖ∑Êï∞ÊçÆÂ§±Ë¥•:\', error);\n    isDataLoaded.value = true;\n  }\n};\n\n// ‰øùÂ≠òÂ∑•ÂÖ∑Êï∞ÊçÆÂà∞ÈÖíÈ¶ÜÂèòÈáè\nconst saveToolsDataImmediate = () => {\n  // Âè™ÊúâÂú®Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÂêéÊâç‰øùÂ≠ò\n  if (!isDataLoaded.value) {\n    console.log(\'‚è∏Ô∏è Ë∑≥Ëøá‰øùÂ≠òÔºöÊï∞ÊçÆÂ∞öÊú™Âä†ËΩΩÂÆåÊàê\');\n    return;\n  }\n\n  try {\n    const script_id = getScriptIdSafe();\n    if (!script_id) {\n      console.warn(\'‚ö†Ô∏è script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÊï∞ÊçÆ\');\n      return;\n    }\n\n    const dataToSave = {\n      tools_antiCliche: {\n        input: antiClicheInput.value,\n        output: antiClicheOutput.value,\n      },\n      tools_characterCard: {\n        description: characterDescription.value,\n        output: characterCardOutput.value,\n        modifyRequest: modifyRequest.value,\n      },\n      tools_expandedState: Object.fromEntries(toolExpandedState.value),\n    };\n\n    insertOrAssignVariables(dataToSave, { type: \'script\', script_id });\n    console.log(\'üíæ Â∑•ÂÖ∑Êï∞ÊçÆÂ∑≤‰øùÂ≠ò:\', {\n      antiCliche_input_length: antiClicheInput.value.length,\n      antiCliche_output_length: antiClicheOutput.value.length,\n      character_desc_length: characterDescription.value.length,\n      character_output_length: characterCardOutput.value.length,\n    });\n  } catch (error) {\n    console.error(\'‚ùå ‰øùÂ≠òÂ∑•ÂÖ∑Êï∞ÊçÆÂ§±Ë¥•:\', error);\n  }\n};\n\n// ‰ΩøÁî®Èò≤ÊäñÊù•ÈÅøÂÖçÈ¢ëÁπÅ‰øùÂ≠òÔºàÂáèÂ∞ëÂà∞300msÔºåÊõ¥Âø´ÂìçÂ∫îÔºâ\nconst saveToolsData = debounce(saveToolsDataImmediate, 300);\n\n// ÁõëÂê¨Êï∞ÊçÆÂèòÂåñÂπ∂Ëá™Âä®‰øùÂ≠ò\nwatch(\n  [antiClicheInput, antiClicheOutput, characterDescription, characterCardOutput, modifyRequest, toolExpandedState],\n  () => {\n    if (isDataLoaded.value) {\n      console.log(\'üìù Êï∞ÊçÆÂèòÂåñÔºåËß¶Âèë‰øùÂ≠ò...\');\n      saveToolsData();\n    }\n  },\n  { deep: true },\n);\n\n// ÁªÑ‰ª∂ÊåÇËΩΩÊó∂Âä†ËΩΩÊï∞ÊçÆ\nonMounted(() => {\n  console.log(\'üîß ToolsTab ÁªÑ‰ª∂Â∑≤ÊåÇËΩΩÔºåÂä†ËΩΩÊï∞ÊçÆ...\');\n  loadToolsData();\n});\n\n// ÁªÑ‰ª∂Âç∏ËΩΩÂâç‰øùÂ≠òÊï∞ÊçÆ\nonBeforeUnmount(() => {\n  console.log(\'üîÑ ToolsTab ÁªÑ‰ª∂Âç≥Â∞ÜÂç∏ËΩΩÔºå‰øùÂ≠òÊï∞ÊçÆ...\');\n  // ÂèñÊ∂àÈò≤ÊäñÔºåÁ´ãÂç≥‰øùÂ≠ò\n  saveToolsData.cancel();\n  saveToolsDataImmediate();\n});\n\n// ÂàáÊç¢Â∑•ÂÖ∑Â±ïÂºÄÁä∂ÊÄÅ\nconst toggleToolExpanded = (toolName: string) => {\n  console.log(\'toggleToolExpanded Ë¢´Ë∞ÉÁî®ÔºåÂ∑•ÂÖ∑ÂêçÁß∞:\', toolName);\n  const current = toolExpandedState.value.get(toolName) || false;\n  console.log(\'ÂΩìÂâçÂ±ïÂºÄÁä∂ÊÄÅ:\', current);\n  toolExpandedState.value.set(toolName, !current);\n  console.log(\'Êñ∞ÁöÑÂ±ïÂºÄÁä∂ÊÄÅ:\', !current);\n};\n\n// Ê£ÄÊü•Â∑•ÂÖ∑ÊòØÂê¶Â±ïÂºÄ\nconst isToolExpanded = (toolName: string) => {\n  return toolExpandedState.value.get(toolName) || false;\n};\n\n// Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞ - ÈíàÂØπiframeÁéØÂ¢É‰ºòÂåñ\nconst copyToClipboard = async (text: string, successMessage: string) => {\n  console.log(\'üîç ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:\', text.length);\n  console.log(\'üîç ÊòØÂê¶Âú®iframe‰∏≠:\', window.parent !== window);\n\n  // ÊñπÊ≥ï1Ôºö‰ºòÂÖàÂú®Áà∂Á™óÂè£‰∏≠Â§çÂà∂ÔºàÊúÄÂèØÈù†ÁöÑÊñπÊ≥ïÔºâ\n  if (window.parent && window.parent !== window) {\n    console.log(\'üîç Â∞ùËØïÂú®Áà∂Á™óÂè£‰∏≠Â§çÂà∂...\');\n    const parentSuccess = tryParentWindowCopy(text);\n    if (parentSuccess) {\n      console.log(\'‚úÖ Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü\');\n      window.toastr.success(successMessage);\n      return;\n    } else {\n      console.warn(\'‚ö†Ô∏è Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•\');\n    }\n  }\n\n  // ÊñπÊ≥ï2ÔºöÂ∞ùËØï execCommand Âú®ÂΩìÂâçÁ™óÂè£\n  try {\n    console.log(\'üîç Â∞ùËØï execCommand Â§çÂà∂...\');\n    const success = execCommandCopy(text);\n    if (success) {\n      console.log(\'‚úÖ execCommand Â§çÂà∂ÊàêÂäü\');\n      window.toastr.success(successMessage);\n      return;\n    } else {\n      console.warn(\'‚ö†Ô∏è execCommand Â§çÂà∂Â§±Ë¥•\');\n    }\n  } catch (error) {\n    console.warn(\'‚ùå execCommand Â§çÂà∂ÂºÇÂ∏∏:\', error);\n  }\n\n  // ÊñπÊ≥ï3ÔºöÂ∞ùËØïÁé∞‰ª£ Clipboard API\n  try {\n    if (navigator.clipboard && window.isSecureContext) {\n      console.log(\'üîç Â∞ùËØï Clipboard API Â§çÂà∂...\');\n      await navigator.clipboard.writeText(text);\n\n      // È™åËØÅÊòØÂê¶ÁúüÁöÑÂ§çÂà∂ÊàêÂäü\n      const clipboardContent = await navigator.clipboard.readText();\n      if (clipboardContent === text) {\n        console.log(\'‚úÖ Clipboard API Â§çÂà∂ÊàêÂäüÔºàÂ∑≤È™åËØÅÔºâ\');\n        window.toastr.success(successMessage);\n        return;\n      } else {\n        console.warn(\'‚ö†Ô∏è Clipboard API Â§çÂà∂ÂêéÈ™åËØÅÂ§±Ë¥•\');\n      }\n    }\n  } catch (error) {\n    console.warn(\'‚ùå Clipboard API Â§±Ë¥•:\', error);\n  }\n\n  // ÊâÄÊúâÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü\n  console.log(\'‚ö†Ô∏è ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü\');\n  showManualCopyDialog(text);\n};\n\n// Âú®Áà∂Á™óÂè£‰∏≠Â∞ùËØïÂ§çÂà∂\nconst tryParentWindowCopy = (text: string): boolean => {\n  try {\n    if (window.parent && window.parent !== window) {\n      console.log(\'  üìù Âú®Áà∂Á™óÂè£ÂàõÂª∫‰∏¥Êó∂textarea...\');\n\n      // Âú®Áà∂Á™óÂè£‰∏≠ÂàõÂª∫‰∏¥Êó∂ÂÖÉÁ¥†Âπ∂Â§çÂà∂\n      const parentDoc = window.parent.document;\n      const tempTextArea = parentDoc.createElement(\'textarea\');\n      tempTextArea.value = text;\n\n      // ËÆæÁΩÆÊ†∑Âºè‰ΩøÂÖ∂‰∏çÂèØËßÅ‰ΩÜ‰ªçÁÑ∂ÂèØÈÄâ‰∏≠\n      tempTextArea.style.cssText = `\n        position: fixed !important;\n        left: -9999px !important;\n        top: -9999px !important;\n        width: 1px !important;\n        height: 1px !important;\n        opacity: 0 !important;\n        pointer-events: none !important;\n      `;\n      tempTextArea.setAttribute(\'readonly\', \'\');\n\n      parentDoc.body.appendChild(tempTextArea);\n      console.log(\'  üìù TextareaÂ∑≤Ê∑ªÂä†Âà∞Áà∂Á™óÂè£\');\n\n      // ËÅöÁÑ¶Âπ∂ÈÄâ‰∏≠ÊñáÊú¨\n      tempTextArea.focus();\n      tempTextArea.select();\n      tempTextArea.setSelectionRange(0, text.length);\n      console.log(\'  üìù ÊñáÊú¨Â∑≤ÈÄâ‰∏≠\');\n\n      // Â∞ùËØïÂ§çÂà∂\n      const success = parentDoc.execCommand(\'copy\');\n      console.log(\'  üìù execCommandÁªìÊûú:\', success);\n\n      // Ê∏ÖÁêÜ\n      parentDoc.body.removeChild(tempTextArea);\n      console.log(\'  üìù TextareaÂ∑≤Ê∏ÖÁêÜ\');\n\n      return success;\n    }\n  } catch (error) {\n    console.error(\'‚ùå Áà∂Á™óÂè£Â§çÂà∂ÂºÇÂ∏∏:\', error);\n  }\n  return false;\n};\n\n// execCommand Â§çÂà∂ÊñπÊ≥ï\nconst execCommandCopy = (text: string): boolean => {\n  try {\n    console.log(\'  üìù Âú®ÂΩìÂâçÁ™óÂè£ÂàõÂª∫‰∏¥Êó∂textarea...\');\n\n    // ÂàõÂª∫‰∏¥Êó∂ÊñáÊú¨Âå∫Âüü\n    const textArea = document.createElement(\'textarea\');\n    textArea.value = text;\n\n    // ËÆæÁΩÆÊ†∑Âºè\n    textArea.style.cssText = `\n      position: fixed !important;\n      left: -9999px !important;\n      top: -9999px !important;\n      width: 1px !important;\n      height: 1px !important;\n      opacity: 0 !important;\n      pointer-events: none !important;\n    `;\n    textArea.setAttribute(\'readonly\', \'\');\n\n    document.body.appendChild(textArea);\n    console.log(\'  üìù TextareaÂ∑≤Ê∑ªÂä†Âà∞ÂΩìÂâçÁ™óÂè£\');\n\n    // ËÅöÁÑ¶Âπ∂ÈÄâ‰∏≠\n    textArea.focus();\n    textArea.select();\n    textArea.setSelectionRange(0, text.length);\n    console.log(\'  üìù ÊñáÊú¨Â∑≤ÈÄâ‰∏≠\');\n\n    // Â∞ùËØïÂ§çÂà∂\n    const success = document.execCommand(\'copy\');\n    console.log(\'  üìù execCommandÁªìÊûú:\', success);\n\n    // Ê∏ÖÁêÜ\n    document.body.removeChild(textArea);\n    console.log(\'  üìù TextareaÂ∑≤Ê∏ÖÁêÜ\');\n\n    return success;\n  } catch (error) {\n    console.error(\'‚ùå execCommand Â§çÂà∂ÂºÇÂ∏∏:\', error);\n    return false;\n  }\n};\n\n// ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü - Êõ¥ÂèØÈù†ÁöÑÂÆûÁé∞\nconst showManualCopyDialog = (text: string) => {\n  try {\n    console.log(\'üìã ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü\');\n\n    // Â∞ùËØïÂú®Áà∂Á™óÂè£‰∏≠ÂàõÂª∫ÂØπËØùÊ°ÜÔºàÊõ¥ÂèØÈù†Ôºâ\n    const targetDoc = window.parent && window.parent !== window ? window.parent.document : document;\n    const targetBody = targetDoc.body;\n\n    console.log(\'üìã ÁõÆÊ†áÊñáÊ°£:\', targetDoc === window.parent.document ? \'Áà∂Á™óÂè£\' : \'ÂΩìÂâçÁ™óÂè£\');\n\n    // ÁßªÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑÊóßÂØπËØùÊ°Ü\n    const existingModal = targetDoc.getElementById(\'manual-copy-modal-tools\');\n    if (existingModal) {\n      targetBody.removeChild(existingModal);\n    }\n\n    // ÂàõÂª∫Ê®°ÊÄÅÂØπËØùÊ°Ü\n    const modal = targetDoc.createElement(\'div\');\n    modal.id = \'manual-copy-modal-tools\';\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.9);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    `;\n\n    const dialog = targetDoc.createElement(\'div\');\n    dialog.style.cssText = `\n      background: #2a2a2a;\n      border: 2px solid #ffa500;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 700px;\n      width: 90%;\n      max-height: 80vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);\n    `;\n\n    dialog.innerHTML = `\n      <h3 style="margin: 0 0 15px 0; color: #ffa500; font-size: 18px; font-weight: 600;">\n        <i class="fa-solid fa-copy" style="margin-right: 8px;"></i>\n        ÊâãÂä®Â§çÂà∂ÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #3a3a3a; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0; color: #e0e0e0; font-size: 14px; line-height: 1.6;">\n          ‚ö†Ô∏è Ëá™Âä®Â§çÂà∂ÂäüËÉΩÂú®ÂΩìÂâçÁéØÂ¢É‰∏ã‰∏çÂèØÁî®ÔºåËØ∑ÊâãÂä®Â§çÂà∂‰ª•‰∏ãÂÜÖÂÆπÔºö\n        </p>\n        <ol style="margin: 8px 0 0 20px; padding: 0; color: #ccc; font-size: 13px;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°ÜÈÄâ‰∏≠ÂÜÖÂÆπ</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px;">Ctrl+A</kbd> ÂÖ®ÈÄâ</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px;">Ctrl+C</kbd> Â§çÂà∂</li>\n        </ol>\n      </div>\n      <textarea\n        readonly\n        id="copyTextarea"\n        style="\n          width: 100%;\n          height: 300px;\n          background: #1a1a1a;\n          border: 2px solid #3a3a3a;\n          border-radius: 6px;\n          padding: 12px;\n          color: #e0e0e0;\n          font-size: 13px;\n          font-family: \'Courier New\', Consolas, monospace;\n          resize: vertical;\n          margin-bottom: 15px;\n          box-sizing: border-box;\n        "\n      >${text}</textarea>\n      <div style="display: flex; gap: 12px; justify-content: flex-end;">\n        <button id="manualCopyBtn" style="\n          padding: 10px 20px;\n          background: #28a745;\n          border: none;\n          border-radius: 6px;\n          color: white;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.2s;\n        ">Â∞ùËØïËá™Âä®Â§çÂà∂</button>\n        <button id="closeBtn" style="\n          padding: 10px 20px;\n          background: #6c757d;\n          border: none;\n          border-radius: 6px;\n          color: white;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.2s;\n        ">ÂÖ≥Èó≠</button>\n      </div>\n    `;\n\n    modal.appendChild(dialog);\n    targetBody.appendChild(modal);\n    console.log(\'üìã ÂØπËØùÊ°ÜÂ∑≤Ê∑ªÂä†Âà∞DOM\');\n\n    // Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨\n    const textarea = dialog.querySelector(\'#copyTextarea\') as HTMLTextAreaElement;\n    setTimeout(() => {\n      textarea.focus();\n      textarea.select();\n      console.log(\'üìã ÊñáÊú¨Â∑≤Ëá™Âä®ÈÄâ‰∏≠\');\n    }, 100);\n\n    // ÁªëÂÆö‰∫ã‰ª∂\n    const copyBtn = dialog.querySelector(\'#manualCopyBtn\') as HTMLButtonElement;\n    const closeBtn = dialog.querySelector(\'#closeBtn\') as HTMLButtonElement;\n\n    copyBtn.onmouseover = () => (copyBtn.style.background = \'#218838\');\n    copyBtn.onmouseout = () => (copyBtn.style.background = \'#28a745\');\n    closeBtn.onmouseover = () => (closeBtn.style.background = \'#5a6268\');\n    closeBtn.onmouseout = () => (closeBtn.style.background = \'#6c757d\');\n\n    copyBtn.onclick = () => {\n      try {\n        console.log(\'üìã Â∞ùËØïÈÄöËøáÊåâÈíÆÂ§çÂà∂...\');\n        textarea.focus();\n        textarea.select();\n        const success = targetDoc.execCommand(\'copy\');\n        console.log(\'üìã Â§çÂà∂ÁªìÊûú:\', success);\n\n        if (success) {\n          window.toastr.success(\'Â§çÂà∂ÊàêÂäüÔºÅ\');\n          targetBody.removeChild(modal);\n        } else {\n          window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Êåâ Ctrl+C Â§çÂà∂\');\n        }\n      } catch (error) {\n        console.error(\'üìã Â§çÂà∂ÂºÇÂ∏∏:\', error);\n        window.toastr.warning(\'Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Êåâ Ctrl+C Â§çÂà∂\');\n      }\n    };\n\n    closeBtn.onclick = () => {\n      console.log(\'üìã ÂÖ≥Èó≠ÂØπËØùÊ°Ü\');\n      targetBody.removeChild(modal);\n    };\n\n    // ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\n    modal.onclick = e => {\n      if (e.target === modal) {\n        console.log(\'üìã ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠\');\n        targetBody.removeChild(modal);\n      }\n    };\n\n    // ESCÈîÆÂÖ≥Èó≠\n    const handleEsc = (e: KeyboardEvent) => {\n      if (e.key === \'Escape\') {\n        console.log(\'üìã ÊåâESCÂÖ≥Èó≠\');\n        targetBody.removeChild(modal);\n        targetDoc.removeEventListener(\'keydown\', handleEsc);\n      }\n    };\n    targetDoc.addEventListener(\'keydown\', handleEsc);\n\n    window.toastr.info(\'Â∑≤ÊâìÂºÄÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú\', \'\', { timeOut: 3000 });\n  } catch (error) {\n    console.error(\'‚ùå ÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:\', error);\n    window.toastr.error(\'Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºö\' + (error as Error).message);\n  }\n};\n\n// ÂèçÂÖ´ËÇ°Â∑•ÂÖ∑Â§ÑÁêÜÂáΩÊï∞\nconst handleAntiClicheProcess = async () => {\n  if (!antiClicheInput.value.trim()) {\n    window.toastr.warning(\'ËØ∑ËæìÂÖ•ÈúÄË¶ÅÊ∏ÖÁêÜÁöÑÊñáÊú¨\');\n    return;\n  }\n\n  try {\n    isProcessingAntiCliche.value = true;\n    window.toastr.info(\'AIÊ≠£Âú®ÂàÜÊûêÊñáÊú¨...\', \'ÂèçÂÖ´ËÇ°Ê∏ÖÁêÜ\', { timeOut: 15000 });\n\n    const response = await fetch(settings.value.api_endpoint, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        Authorization: `Bearer ${settings.value.api_key}`,\n      },\n      body: JSON.stringify({\n        model: settings.value.model,\n        messages: [\n          {\n            role: \'system\',\n            content: `‰Ω†ÊòØ‰∏Ä‰∏™ÊñáÊú¨ÁºñËæëÂä©ÊâãÔºåË¥üË¥£Á≥ªÁªüÊÄßÂú∞Ê∏ÖÁêÜËßíËâ≤Âç°„ÄÅ‰∏ñÁïå‰π¶ÂíåÂºÄÂú∫ÁôΩ‰∏≠ÁöÑÂÖ´ËÇ°Ë°®Ëø∞„ÄÇËØ∑ÊåâÁÖß‰ª•‰∏ã‰πù‰∏™Ê≠•È™§‰∏•Ê†ºÊâßË°åÔºö\n\n## Á¨¨‰∏ÄÊ≠•ÔºöÂéªÈô§Ê®°Á≥äËØçÂíåÁ±ªÊØîËØç\nÂà†Èô§Ôºö‰ºº‰πé„ÄÅÂá†‰πé„ÄÅËøë‰πé„ÄÅÂ•ΩÂÉè„ÄÅ‰ªø‰Ωõ„ÄÅÂ¶ÇÂêå„ÄÅÂÆõÂ¶Ç„ÄÅÊÅ∞‰ºº„ÄÅ‰∏Ä‰∏ù„ÄÅ‰∏ÄÊäπ„ÄÅ‰∏Ä‰∏ù‰∏ù„ÄÅ‰∏ÄËà¨„ÄÅ‰∏çÊòìÂØüËßâ„ÄÅËã•ÊúâËã•Êó†\n\n## Á¨¨‰∫åÊ≠•ÔºöÂéªÈô§ÂÖ´ËÇ°ÊØîÂñªËØç\n- Âà†Èô§ÊâÄÊúâÂä®Áâ©ÂåñÊØîÂñªÔºöÂÉèÂ∞èÂÖîÂ≠ê‰∏ÄÊ†∑„ÄÅÂÉèÂ∞èÂÖΩ‰∏ÄÊ†∑„ÄÅÂÉèÁå´Âí™‰∏ÄÊ†∑„ÄÅÈáéÂÖΩ„ÄÅÂ∞èÂÖΩ„ÄÅÂπºÂÖΩ„ÄÅ‰ΩéÂêº„ÄÅÂò∂Âêº\n- Âà†Èô§ÊäïÁü≥Á±ªÊØîÂñªÔºöÊäïÁü≥ÂÖ•Ê∞¥„ÄÅÁü≥Â§¥ËêΩÂú∞Á≠â\n- Áõ¥Êé•ÊèèËø∞Âä®‰ΩúÂíåÁä∂ÊÄÅÔºå‰∏ç‰ΩøÁî®ÊØîÂñª\n\n## Á¨¨‰∏âÊ≠•ÔºöÂéªÈô§ËØ≠Ê∞îÂ£∞Èü≥ÊèèËø∞\nÂà†Èô§ÔºöÂ∏¶ÁùÄxxxÁöÑÂè£Âêª/ËØ≠Ê∞î„ÄÅÂ£∞Èü≥ÊØîÂØíÂÜ∞Êõ¥ÂÜ∞ÂÜ∑„ÄÅÁî®‰∏çÂÆπÁΩÆÁñëÁöÑËØ≠Ê∞î„ÄÅÊØè‰∏™Â≠óÈÉΩÂ∏¶ÁùÄxxx„ÄÅÊ≤ôÂìëÁöÑÂ£∞Èü≥„ÄÅ‰ªª‰ΩïÂ£∞Èü≥Ë¥®ÊÑüÊèèËø∞\n**ÂéüÂàôÔºöÂÆåÂÖ®‰∏çÊèèÂÜôËØ≠Ê∞îÔºåÁî±ÂØπËØùÂÜÖÂÆπÊú¨Ë∫´Âá∏Êòæ‰∫∫ËÆæ**\n\n## Á¨¨ÂõõÊ≠•ÔºöÂéªÈô§ÂæÆË°®ÊÉÖÂíåÂæÆÂä®‰Ωú\nÂà†Èô§ÔºöÊµÅÈú≤Âá∫xxxÁ•ûËâ≤„ÄÅÁúºÈáåÊºæËµ∑/Èó™Ëøáxxx„ÄÅÂò¥Ëßí‰∏äÊâ¨/ÁøòËµ∑ÂºßÂ∫¶„ÄÅÈú≤Âá∫‰∏Ä‰∏ùÂæÆÁ¨ë„ÄÅÊåáÂ∞ñÊ≥õÁôΩ„ÄÅ‰∏ãÊÑèËØÜ/Êó†ÊÑèËØÜÁöÑÂä®‰Ωú„ÄÅÁã°Èª†„ÄÅÁîúËÖªÁ≠âË°®ÊÉÖ\n**Êõø‰ª£ÔºöÂ¶ÇÈúÄÂ∞èÂä®‰ΩúÔºåÁî®"‰π†ÊÉØÊÄßÂú∞"ËÄåÈùû"‰∏ãÊÑèËØÜ"**\n\n## Á¨¨‰∫îÊ≠•ÔºöÂéªÈô§"‰∏çÊòØ‚Ä¶‚Ä¶ËÄåÊòØ‚Ä¶‚Ä¶"Âè•Âºè\nÊ∏ÖÁêÜÊâÄÊúâÂê¶ÂÆöËΩ¨ÊäòÂè•ÔºåÁõ¥Êé•ÂÜô"ËÄåÊòØ"ÂêéÈù¢ÁöÑÂÜÖÂÆπ\n\n## Á¨¨ÂÖ≠Ê≠•Ôºö‰øÆÊîπÂ§ñË≤åÊèèËø∞\n- Áû≥Ëâ≤ÁßªÂÖ•ÂØπËØùÁî±ËßíËâ≤Ëá™Ëø∞\n- Â•≥ÊÄßÁΩ©ÊùØÊîπ‰∏∫"ËÉ∏ÈÉ®Âπ≥Âù¶/‰∏∞Êª°"Á≠âÊèèËø∞\n- Á≤æÁ°ÆË∫´È´òÊîπ‰∏∫"È´ò‰∏ÄÁ±≥ÂÖ´"Á≠âÊèèËø∞ÊÄßËØ≠Ë®Ä\n- Âà†Èô§‰∏âÁª¥Â∞∫ÂØ∏Êï∞ÊçÆ\n\n## Á¨¨‰∏ÉÊ≠•ÔºöÈáçÂÜôËØ≠ÊñôÂíåÊÄßÊ†ºÊèèËø∞\n- ËØ≠ÊñôÂè™Áî®Á∫ØÂØπËØùÔºå‰∏çÈôÑÂä†Ë°®ÊÉÖÂä®‰ΩúÁ•ûÊÄÅ\n- ÈÄöËøáÂÖ∑‰ΩìË°å‰∏∫ÂèçÂ∫î‰ΩìÁé∞ÊÄßÊ†ºÔºåÈÅøÂÖçÊÄßÊ†ºÊ†áÁ≠æ\n- Áî®ÈôàËø∞ÂºèËÇØÂÆöÂûãÊèèËø∞Ôºå‰∏çÂä†‰øÆËæû\n\n## Á¨¨ÂÖ´Ê≠•ÔºöÈò≤Ê≠¢ÁªùÊúõ/Á•ûÂåñ/ÊéåÊéßÂÄæÂêë\n- Âà†Èô§ÊûÅÁ´ØÊÉÖÁª™ËØçÔºöÊûÅÂ§ßÁöÑÊÅêÊÉß„ÄÅÈùûÂ∏∏ÂÆ≥ÊÄï„ÄÅÊûÅÂ∫¶ÁæûËÄª„ÄÅÊûÅÂ∫¶‰∏çÂÆâ\n- Âà†Èô§Ë¥üÈù¢Áä∂ÊÄÅËØçÔºöÁïèÁº©„ÄÅÁ©∫ÁôΩ„ÄÅ‰∏ÄÂç°‰∏ÄÂç°„ÄÅÊú∫Ê¢∞Âåñ„ÄÅÂÉµÁ°¨\n- ‰∏çÂÜôËßíËâ≤ÂøÉÁêÜÂèçÂ∫îÂíåÂÜÖÂøÉÊÉ≥Ê≥ï\n- ‰∏çÂÜôuserÁöÑÂøÉÁêÜÂèçÂ∫îÔºå‰∏çÁ•ûÂåñËßíËâ≤\n\n## Á¨¨‰πùÊ≠•ÔºöNSFWÈÉ®ÂàÜÈò≤ÊÄßÁãÇÈáé\n- Âà†Èô§ÔºöÂñúÊ¨¢Á≤óÊö¥/Âä†ÈÄü„ÄÅÂñúÊ¨¢ÊÄßÂø´ÊÑü„ÄÅÁñºÁóõÁóõËã¶Áõ∏ÂÖ≥\n- Âà†Èô§ÔºöÊíïÁ¢é„ÄÅÊíïË£Ç„ÄÅÁ†¥Á¢é„ÄÅÁªû„ÄÅÁªûÁº†„ÄÅÁ¢æ„ÄÅÁ¢æÁ£®„ÄÅÁ†îÁ£®„ÄÅÊî´„ÄÅÂ∞ñÂè´„ÄÅÈ´ò‰∫¢„ÄÅÂëúÂíΩ„ÄÅÁîüÁêÜÊÄßÊ≥™Ê∞¥„ÄÅÁî¨ÈÅì„ÄÅÂºìËµ∑„ÄÅÁÅ≠È°∂ÁöÑÂø´ÊÑü„ÄÅÁªÜÁ¢é\n- ÈÅøÂÖçÊÄßÂô®ÂÆòÂ∞∫ÂØ∏Â§∏Âº†ÊèèËø∞\n\n## ÂÆåÊï¥Á¶ÅÁî®ËØçÂàóË°®ÔºàÂøÖÈ°ªÂà†Èô§ÔºâÔºö\nÊ®°Á≥äËØçÔºö‰∏Ä‰∏ù„ÄÅ‰∏ÄÊäπ„ÄÅ‰ºº‰πé„ÄÅÂá†‰πé„ÄÅËøë‰πé„ÄÅ‰ªø‰Ωõ„ÄÅÂ¶ÇÂêå„ÄÅÂÆõÂ¶Ç„ÄÅÊÅ∞‰ºº„ÄÅ‰∏çÊòìÂØüËßâ„ÄÅËã•ÊúâËã•Êó†\nÂä®Áâ©ÂåñÔºöÈáéÂÖΩ„ÄÅÂ∞èÂÖΩ„ÄÅÂπºÂÖΩ„ÄÅÂÉèÂ∞èÂÖîÂ≠ê„ÄÅÂÉèÁå´Âí™„ÄÅ‰ΩéÂêº„ÄÅÂò∂Âêº„ÄÅÂèóÊÉäÁöÑÂ∞èÂÖΩ\nÊÉÖÁª™ËØçÔºöÁã°Èª†„ÄÅÁîúËÖª„ÄÅÁñØÁãÇ„ÄÅÊàèË∞ë„ÄÅÊÅºÊÄí„ÄÅÂõ∞ÊÉë„ÄÅÊÅêÊÉß„ÄÅÁªùÊúõ„ÄÅÂ¥áÊãú„ÄÅÁãÇÁÉ≠„ÄÅÁ©∫Ê¥û„ÄÅÊØ´Êó†ÁîüÊ∞î„ÄÅËá™Âò≤„ÄÅËã¶Ê∂©„ÄÅÂÜ∞ÂÜ∑„ÄÅÊößÊòß„ÄÅËôîËØö\nÂä®‰ΩúËØçÔºöÈó™Ëøá„ÄÅÈó™ÁùÄ„ÄÅÂèëÁôΩ„ÄÅÊíïÁ¢é„ÄÅÊíïË£Ç„ÄÅÂºßÂ∫¶„ÄÅÁ†¥Á¢é„ÄÅÁªû„ÄÅÂ∞ñÂè´„ÄÅÂëúÂíΩ„ÄÅÊ≤ôÂìë„ÄÅÁ¢æ„ÄÅÁ†îÁ£®„ÄÅÊî´„ÄÅÂºìËµ∑„ÄÅÁªÜÁ¢é„ÄÅÊåáËäÇÂèëÁôΩ„ÄÅÊó†ÊÑèËØÜÁöÑ„ÄÅ‰∏ãÊÑèËØÜ„ÄÅËú∑Áº©„ÄÅÁóâÊåõ„ÄÅÂÉµ‰Ωè„ÄÅÊ•ûÂú®ÂéüÂú∞„ÄÅÈ¢§Êäñ„ÄÅÂûÆ‰∫Ü‰∏ãÊù•„ÄÅÁ¥ßÊè°„ÄÅÊî•‰Ωè„ÄÅÂãæ‰Ωè„ÄÅÁªûÂú®‰∏ÄËµ∑„ÄÅÂéãÂæóÂñò‰∏çËøáÊ∞î„ÄÅÊ∑πÊ≤°„ÄÅÂáªÂûÆ„ÄÅÂàíÂºÄ„ÄÅÂà∫Á†¥„ÄÅÂêûÂô¨\nÁîüÁêÜËØçÔºöÁîüÁêÜÊÄßÊ≥™Ê∞¥„ÄÅÁî¨ÈÅì„ÄÅÁÅ≠È°∂ÁöÑÂø´ÊÑü„ÄÅÊöñÊµÅÊ∂å‰∏äÂøÉÂ§¥„ÄÅÂ¶ÇÂù†ÂÜ∞Á™ü„ÄÅÊµëË∫´ÂÜ∞ÂÜ∑„ÄÅÊâãËÑöÂÜ∞Âáâ„ÄÅÂ§ßËÑë‰∏ÄÁâáÁ©∫ÁôΩ„ÄÅÂó°Âó°‰ΩúÂìç„ÄÅÂëºÂê∏‰∏ÄÊªû„ÄÅÂÄíÂê∏‰∏ÄÂè£ÂáâÊ∞î„ÄÅË∫´‰ΩìÂÉµÁ°¨„ÄÅÂ¶ÇÈÅ≠Èõ∑Âáª„ÄÅÁªÜÂØÜÁöÑÊ±óÁè†\nÊØîÂñªÁ±ªÔºöÁü≥Â≠êÊäïÂÖ•Êπñ‰∏≠„ÄÅÊ≥õËµ∑Ê∂üÊº™„ÄÅÈíàÊâéÁ†¥Ê∞îÁêÉ„ÄÅÊâãÊúØÂàÄÂàíÂºÄ„ÄÅÂèóÊÉäÂ∞èÂÖΩ„ÄÅÊèêÁ∫øÊú®ÂÅ∂„ÄÅÂëΩËøêÁöÑÈΩøËΩÆ„ÄÅÂõûÂøÜÊΩÆÊ∞¥„ÄÅÈò≥ÂÖâÊñëÈ©≥„ÄÅÂÖâÂΩ±„ÄÅÂÉèÊ†πÈíà‰∏ÄÊ†∑ÊâéËøõ\nÂ£∞Èü≥Á±ªÔºöÊ≤ôÂìë„ÄÅÁ£ÅÊÄß„ÄÅÊ∑±Ê≤â„ÄÅÈì∂ÈìÉËà¨Ê∏ÖËÑÜ„ÄÅÂ£∞Èü≥Èáå‰∏çÂ∏¶‰∏Ä‰∏ùÊ∏©Â∫¶„ÄÅ‰ΩéÊ≤âËÄåÂØåÊúâÁ£ÅÊÄß„ÄÅÁªÜËã•ËöäÂëê\nÊäΩË±°ËØçÔºöÂøÉÊπñ„ÄÅÂè§‰∫ï„ÄÅÊ∑±Ê∏ä„ÄÅË∞∑Â∫ï„ÄÅÊó∂Èó¥ÈùôÊ≠¢„ÄÅÁ©∫Ê∞îÂáùÂõ∫„ÄÅÂú£Áâ©„ÄÅËôîËØö„ÄÅÂÆõËã•Á•ûÊòé„ÄÅÊÅ∂È≠î„ÄÅÁåÆÁ•≠„ÄÅ‰ª™Âºè„ÄÅÂÆ°Âà§„ÄÅÂæÅÊúç„ÄÅÊîØÈÖç„ÄÅÂç†Êúâ„ÄÅÂáùÂõ∫„ÄÅÈô∑ÂÖ•„ÄÅÊú®ËÆ∑„ÄÅÊØÅÂ§©ÁÅ≠Âú∞„ÄÅÈì∫Â§©ÁõñÂú∞„ÄÅÊ∑¨ÊØíÂàÄÂ≠ê„ÄÅÁ©ø‰∫ëË£ÇÁü≥„ÄÅÊ∞§Ê∞≤„ÄÅÊúâÊØíËó§Ëîì„ÄÅÊèâÂÖ•È™®Ë°Ä\nÂê¶ÂÆöÂè•ÂºèÔºö‰∏çÊòØËÄåÊòØ„ÄÅÂπ∂‰∏çÂ≠òÂú®\nÁ®ãÂ∫¶ËØçÔºöÈì∫Â§©ÁõñÂú∞„ÄÅÁãÇÈ£éÊö¥Èõ®„ÄÅÊØÅÂ§©ÁÅ≠Âú∞„ÄÅÂÖÖÊª°‰∫Üxxx„ÄÅ‰∏çÂÆπË¥®Áñë„ÄÅ‰∏çÂÆπÈîôËæ®„ÄÅ‰∏çÂÆπÊäóÊãí„ÄÅÈöèÊó∂„ÄÅÁ´ãÂàª„ÄÅÁû¨Èó¥„ÄÅÈ°∑ÂàªÈó¥\n\n**ÈáçË¶ÅÂéüÂàôÔºö**\n1. Áõ¥Êé•Âà†Èô§Á¶ÅÁî®ËØçÔºå‰∏çË¶ÅÊõøÊç¢‰∏∫Âêå‰πâËØç\n2. Áî®ÂÖ∑‰ΩìË°å‰∏∫Êõø‰ª£ÊäΩË±°ÊÉÖÁª™ÂíåÂøÉÁêÜÊèèÂÜô\n3. ‰øùÊåÅÂéüÊñáÊ†∏ÂøÉÊÑèÊÄùÔºå‰ΩÜË°®ËææÊñπÂºèË¶ÅÂΩªÂ∫ïÊîπÂèò\n4. ËØ≠ÊñôÂøÖÈ°ªÊòØÁ∫ØÂØπËØùÔºå‰∏çÂ∏¶‰ªª‰ΩïÂä®‰ΩúË°®ÊÉÖ\n5. Â§ñË≤åÂíåÊÄßÊ†ºÁî®ÈôàËø∞ÂºèËÇØÂÆöÊèèËø∞Ôºå‰∏çÁî®‰øÆËæû\n\nËØ∑‰∏•Ê†ºÊåâÁÖß‰ª•‰∏äÊ†áÂáÜÊ∏ÖÁêÜÊñáÊú¨ÔºåÁõ¥Êé•ËæìÂá∫Ê∏ÖÁêÜÂêéÁöÑÁªìÊûúÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïËß£ÈáäÊàñËØ¥Êòé„ÄÇ`,\n          },\n          {\n            role: \'user\',\n            content: antiClicheInput.value,\n          },\n        ],\n        max_tokens: settings.value.max_tokens || 8000,\n        temperature: 0.7,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    antiClicheOutput.value = data.choices[0].message.content.trim();\n    saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠òÁªìÊûú\n\n    window.toastr.success(\'ÊñáÊú¨Ê∏ÖÁêÜÂÆåÊàêÔºÅ\');\n  } catch (error) {\n    console.error(\'ÂèçÂÖ´ËÇ°Ê∏ÖÁêÜÂ§±Ë¥•:\', error);\n    window.toastr.error(\'Ê∏ÖÁêÜÂ§±Ë¥•Ôºö\' + (error as Error).message);\n  } finally {\n    isProcessingAntiCliche.value = false;\n  }\n};\n\nconst copyAntiClicheResult = () => {\n  if (!antiClicheOutput.value) {\n    window.toastr.warning(\'Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑÂÜÖÂÆπ\');\n    return;\n  }\n\n  // ‰ΩøÁî®Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞\n  copyToClipboard(antiClicheOutput.value, \'Ê∏ÖÁêÜÁªìÊûúÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\');\n};\n\n// ËßíËâ≤Âç°ÁîüÊàêÂ∑•ÂÖ∑Áõ∏ÂÖ≥ÂáΩÊï∞\nconst handleGenerateCharacterCard = async () => {\n  if (!characterDescription.value.trim()) {\n    window.toastr.warning(\'ËØ∑ËæìÂÖ•ËßíËâ≤ÊèèËø∞\');\n    return;\n  }\n\n  try {\n    isGeneratingCharacter.value = true;\n    window.toastr.info(\'AIÊ≠£Âú®ÁîüÊàêËßíËâ≤Âç°ÔºåËØ∑Á®çÂÄô...\');\n\n    const response = await fetch(settings.value.api_endpoint, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        Authorization: `Bearer ${settings.value.api_key}`,\n      },\n      body: JSON.stringify({\n        model: settings.value.model || \'gpt-3.5-turbo\',\n        max_tokens: settings.value.max_tokens || 16000,\n        temperature: 0.8,\n        messages: [\n          {\n            role: \'system\',\n            content: `‰Ω†ÊòØ‰∏Ä‰∏™ËßíËâ≤Âç°ÁîüÊàêÂä©Êâã„ÄÇËØ∑Á≥ªÁªüÊÄßÂú∞ÂàõÂª∫‰∏Ä‰∏™ÂÆåÊï¥ÁöÑËßíËâ≤Âç°„ÄÇ\n\n**ËæìÂá∫Ê†ºÂºèË¶ÅÊ±Ç**Ôºö\n- ÂøÖÈ°ª‰ΩøÁî® YAML Ê†ºÂºèÔºåÊâÄÊúâÂ≠óÊÆµÂêçÂíåÂÜÖÂÆπÈÉΩÁî®‰∏≠Êñá\n- Á°Æ‰øùËæìÂá∫ÂÆåÊï¥Ôºå‰∏çË¶ÅÊà™Êñ≠\n- ÈÅøÂÖçAIÂàªÊùøÂåñÔºåË¶ÅÊúâÂ§öÊ†∑ÊÄßÂíåÁúüÂÆûÊÑü\n- ‰∏•Ê†ºÈÅøÂÖç‰ªª‰ΩïAIÊåá‰ª§ÂºèËØ≠Ë®Ä\n\n**ËßíËâ≤Âç°ÁªìÊûÑÊ®°Êùø**Ôºö\n\\`\\`\\`yaml\nÂü∫Á°Ä‰ø°ÊÅØ:\n  ÂßìÂêç: "ÂÖ®Âêç"\n  Âπ¥ÈæÑ: ÂÖ∑‰ΩìÂπ¥ÈæÑ\n  Âá∫ÁîüÂπ¥Êúà: "YYYYÂπ¥MMÊúà"\n  ÊÄßÂà´: "Áî∑/Â•≥/ÂÖ∂‰ªñ"\n  Á¨¨‰∫åÊÄßÂà´: "Alpha/Beta/Omega/Êó†"\n  Ë∫´È´ò‰ΩìÈáç: "Ë∫´È´òÁî®ÊñáÂ≠óÊèèËø∞ÔºàÈ´òÂ§ß/‰∏≠Á≠â/Â®áÂ∞èÁ≠âÔºâÔºå‰ΩìÈáçÁî®ÊñáÂ≠óÊèèËø∞ÔºàÂåÄÁß∞/Á∫§Áò¶/‰∏∞Êª°Á≠âÔºâ"\n  ‰ø°ÊÅØÁ¥†: "ÊèèËø∞Ê∞îÂë≥ÁâπÂæÅÂíåÂèòÂåñËßÑÂæãÔºàÂ¶ÇÈÄÇÁî®Ôºâ"\n  ÊÄßÂèñÂêë: "ÂºÇÊÄßÊÅã/ÂêåÊÄßÊÅã/ÂèåÊÄßÊÅãÁ≠â"\n  ÊÅãÁà±ÁªèÈ™å: "ËØ¶ÁªÜÊèèËø∞"\n  Ë∫´‰ªΩËÅå‰∏ö: "ÂÖ∑‰ΩìËÅå‰∏öÂíåÁ§æ‰ºöÂú∞‰Ωç"\n  Ê†áÂøóÊÄßÁâπÂæÅ:\n    ÂæÆ‰ø°ÊòµÁß∞: "ÊòµÁß∞"\n    Â§¥ÂÉè: "ÊèèËø∞"\n    ÂÖ∂‰ªñ: "ÂÖ∂‰ªñÊ†áÂøóÊÄßÁâπÂæÅ"\n\nÂ§ñË≤å‰∏éË∫´Êùê:\n  Êï¥‰ΩìË∫´ÂΩ¢: "È´òÁüÆËÉñÁò¶„ÄÅËÇåËÇâÁ±ªÂûãÁöÑËØ¶ÁªÜÊèèËø∞"\n  Èù¢ÂÆπÁâπÂæÅ:\n    ÂèëÂûã: "ÂèëÂûã„ÄÅÂèëËâ≤„ÄÅÂèëË¥®"\n    ËÇ§Ëâ≤: "ËÇ§Ëâ≤ÊèèËø∞"\n    ÁúºÁùõ: "ÁúºÁùõÈ¢úËâ≤ÂíåÁâπÂæÅ"\n    ‰∫îÂÆò: "‰∫îÂÆòÁâπÁÇπ"\n  Á©øÊê≠È£éÊ†º: "Êó•Â∏∏Á©øÊê≠ÂÅèÂ•ΩÂíåÈ£éÊ†º"\n  Â£∞Èü≥ÁâπÂæÅ: "Èü≥Ëâ≤„ÄÅÈü≥Ë∞É„ÄÅËØ¥ËØùËäÇÂ•è"\n  ‰π†ÊÉØÊÄßÂä®‰Ωú: "Â∏∏ËßÅÁöÑÂßøÊÄÅÂíåÂ∞èÂä®‰Ωú"\n\nÊÄßÊ†º‰∏éÂøÉÁêÜ:\n  ‰∏ªË¶ÅÊÄßÊ†ºÁâπÂæÅ:\n    - ÁâπË¥®1: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n    - ÁâπË¥®2: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n    - ÁâπË¥®3: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n  ÊÄßÊ†ºÁöÑ‰∏§Èù¢ÊÄß: "Âú®‰∏çÂêåÊÉÖÂÜµ‰∏ãÂ±ïÁé∞ÁöÑ‰∏çÂêå‰æßÈù¢Ôºà‰æãÂ¶ÇÔºöÂπ≥Êó∂Ê∏©Âíå‰ΩÜËß¶ÂèäÂ∫ïÁ∫øÊó∂Âº∫Á°¨Ôºâ"\n  ÊÉÖÁª™Ê®°Âºè:\n    Â∏∏ËßÅÊÉÖÁª™: "Êó•Â∏∏‰∏ªË¶ÅÊÉÖÁª™Áä∂ÊÄÅ"\n    ÊÉÖÁª™Ëß¶ÂèëÁÇπ: "‰ªÄ‰πàÂÆπÊòìÂºïÂèëÊÉÖÁª™Ê≥¢Âä®"\n    ÊÉÖÁª™Ë°®ËææÊñπÂºè: "Â¶Ç‰ΩïË°®Áé∞ÂíåÂ§ÑÁêÜÊÉÖÁª™"\n  Â∫îÂØπÂéãÂäõ: "Èù¢ÂØπÂéãÂäõÂíåÂõ∞Â¢ÉÊó∂ÁöÑÂèçÂ∫îÂíåÂ§ÑÁêÜÊñπÂºè"\n\nÂØπËØùÈ£éÊ†º:\n  Êó•Â∏∏ËØ≠Ê∞î: "Áî®ËØç‰π†ÊÉØÂíåËØ¥ËØùÁâπÁÇπ"\n  ÂØπ‰∏çÂêåÂØπË±°:\n    ‰∫≤ËøëÁöÑ‰∫∫: "ËØ¥ËØùÊñπÂºè"\n    ÈôåÁîü‰∫∫: "ËØ¥ËØùÊñπÂºè"\n    Â∑•‰ΩúÂú∫Âêà: "ËØ¥ËØùÊñπÂºè"\n  ÊÉÖÁª™ÂèòÂåñÊó∂: "ÊÉÖÁª™ÊøÄÂä®/‰ΩéËêΩÊó∂ÁöÑËØ≠Ë®ÄÂèòÂåñ"\n  Âè£Â§¥Á¶Ö: ["Âè£Â§¥Á¶Ö1", "Âè£Â§¥Á¶Ö2"]\n\nËÉåÊôØÁªèÂéÜ:\n  ÂÆ∂Â∫≠ËÉåÊôØ: "ËØ¶ÁªÜÁöÑÂÆ∂Â∫≠ÁéØÂ¢ÉÂíåÊàêÈïøËÉåÊôØ"\n  ÊïôËÇ≤ÁªèÂéÜ: "Â≠¶‰π†ÁªèÂéÜ"\n  ÈáçË¶Å‰∫∫Áîü‰∫ã‰ª∂: ["‰∫ã‰ª∂1", "‰∫ã‰ª∂2", "‰∫ã‰ª∂3"]\n  ÂÖ≥ÈîÆËΩ¨ÊäòÁÇπ: "ÊîπÂèòTAÁöÑÈáçË¶Å‰∫ã‰ª∂"\n  ÂΩìÂâçÁä∂ÂÜµ: "Áé∞Âú®ÁöÑÁîüÊ¥ªÁä∂ÊÄÅ"\n  ‰∫∫ÁîüÁõÆÊ†á: "TAÊÉ≥Ë¶ÅËææÊàêÁöÑÁõÆÊ†á"\n\n‰∫∫ÈôÖÂÖ≥Á≥ª:\n  ÂØπ‰∏ªË¶ÅËßíËâ≤ÁöÑÊÄÅÂ∫¶: "‰∏é{{user}}ÊàñÂÖ∂‰ªñÈáçË¶ÅËßíËâ≤ÁöÑ‰∫íÂä®Ê®°Âºè"\n  Á§æ‰∫§ÂÅèÂ•Ω: "ÂñúÊ¨¢ÁöÑÁ§æ‰∫§ÊñπÂºèÂíåËæπÁïå"\n  Áæ§‰ΩìËßíËâ≤: "Âú®Âõ¢Èòü‰∏≠ÁöÑÂÆö‰ΩçÔºàÈ¢ÜÂØºËÄÖ/ÂçèË∞ÉËÄÖ/ËßÇÂØüËÄÖÁ≠âÔºâ"\n  ÂÜ≤Á™ÅÂ§ÑÁêÜ: "Â¶Ç‰ΩïÂ§ÑÁêÜÁüõÁõæÂíåÂÜ≤Á™Å"\n\nË°å‰∏∫Ê®°Âºè‰∏éÂä®Êú∫:\n  ÂÖ∏ÂûãË°å‰∏∫:\n    ‰∏ªÂä®ÂÄæÂêë: "TAÂÄæÂêë‰∫é‰∏ªÂä®ÂÅö‰ªÄ‰πà‰∫ãÊÉÖ"\n    ÂõûÈÅøÂÄæÂêë: "TA‰ºöÈÅøÂÖçÊàñÊãíÁªùÂÅö‰ªÄ‰πà"\n    ‰π†ÊÉØÂèçÂ∫î: "Âú®ÁâπÂÆöÊÉÖÂÜµ‰∏ãÁöÑÂÖ∏ÂûãÂèçÂ∫î"\n  Â∫ïÁ∫ø‰∏éÂéüÂàô: "TAÂùöÂÆàÁöÑÂéüÂàôÂíå‰∏çÂèØËß¶Á¢∞ÁöÑÂ∫ïÁ∫ø"\n  ÂÜÖÂú®Âä®Êú∫:\n    Ë°åÂä®È©±Âä®: "Êé®Âä®TAË°åÂä®ÁöÑÂÜÖÂú®ÂéüÂõ†"\n    Ê∑±Â±ÇÈúÄÊ±Ç: "TAÂÜÖÂøÉÁúüÊ≠£Ê∏¥ÊúõÁöÑÊòØ‰ªÄ‰πà"\n    ÈöêËóèÊÉ≥Ê≥ï: "TA‰∏çËΩªÊòìË°®Èú≤ÁöÑÁúüÂÆûÊÉ≥Ê≥ï"\n  ÊÉÖÁª™ÁÆ°ÁêÜ:\n    Â§±ÊéßËæπÁïå: "‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºöÊÉÖÁª™Â§±Êéß"\n    ÊÅ¢Â§çÊñπÂºè: "Â¶Ç‰ΩïÂπ≥Â§çÊÉÖÁª™ÂíåËá™ÊàëË∞ÉËäÇ"\n\\`\\`\\`\n\nËØ∑Âü∫‰∫éÁî®Êà∑ÁöÑÊèèËø∞ÔºåÁîüÊàê‰∏Ä‰∏™ÂÆåÊï¥„ÄÅÁ´ã‰Ωì„ÄÅÁúüÂÆûÁöÑËßíËâ≤„ÄÇÊ≥®ÊÑèÔºö\n1. Ë∫´È´ò‰ΩìÈáçÂøÖÈ°ªÁî®ÊñáÂ≠óÊèèËø∞Ôºå‰∏çË¶ÅÁî®Êï∞Â≠óÂíåÂçï‰Ωç\n2. ÊÄßÊ†ºË¶ÅÂ±ïÁé∞Â§öÈù¢ÊÄßÂíåÂ§çÊùÇÊÄßÔºåÈÅøÂÖçÂçï‰∏ÄÂåñÂíåÂàªÊùøÂç∞Ë±°\n3. Ë°å‰∏∫Ê®°ÂºèË¶Å‰ªéËßíËâ≤ËßÜËßíÂá∫ÂèëÔºåÊèèËø∞TA‰ºöÂ¶Ç‰ΩïÊÄùËÄÉÂíåË°åÂä®\n4. ÊâÄÊúâÂÜÖÂÆπË¶ÅËØ¶ÁªÜ‰∏∞ÂØåÔºåÊúâÂÖ∑‰Ωì‰æãÂ≠êÂíåÂú∫ÊôØ`,\n          },\n          {\n            role: \'user\',\n            content: characterDescription.value,\n          },\n        ],\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    characterCardOutput.value = data.choices[0].message.content.trim();\n    saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠òÁªìÊûú\n\n    window.toastr.success(\'ËßíËâ≤Âç°ÁîüÊàêÂÆåÊàêÔºÅ\');\n  } catch (error) {\n    console.error(\'ËßíËâ≤Âç°ÁîüÊàêÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÁîüÊàêÂ§±Ë¥•Ôºö\' + (error as Error).message);\n  } finally {\n    isGeneratingCharacter.value = false;\n  }\n};\n\nconst clearCharacterForm = () => {\n  characterDescription.value = \'\';\n  characterCardOutput.value = \'\';\n  modifyRequest.value = \'\';\n  saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠ò\n  window.toastr.success(\'ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫\');\n};\n\nconst copyCharacterCard = () => {\n  if (!characterCardOutput.value) {\n    window.toastr.warning(\'Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑÂÜÖÂÆπ\');\n    return;\n  }\n\n  // ‰ΩøÁî®Áªü‰∏ÄÁöÑÂ§çÂà∂ÂáΩÊï∞\n  copyToClipboard(characterCardOutput.value, \'ËßíËâ≤Âç°Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø\');\n};\n\n// Ê∏ÖÁ©∫ÂèçÂÖ´ËÇ°Ë°®Âçï\nconst clearAntiClicheForm = () => {\n  antiClicheInput.value = \'\';\n  antiClicheOutput.value = \'\';\n  saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠ò\n  window.toastr.success(\'ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫\');\n};\n\n// ‰øÆÊîπËßíËâ≤Âç°\nconst handleModifyCharacterCard = async () => {\n  if (!modifyRequest.value.trim()) {\n    window.toastr.warning(\'ËØ∑ËæìÂÖ•‰øÆÊîπÈúÄÊ±Ç\');\n    return;\n  }\n\n  if (!characterCardOutput.value) {\n    window.toastr.warning(\'Ê≤°ÊúâÂèØ‰øÆÊîπÁöÑËßíËâ≤Âç°ÔºåËØ∑ÂÖàÁîüÊàêËßíËâ≤Âç°\');\n    return;\n  }\n\n  try {\n    isModifyingCharacter.value = true;\n    window.toastr.info(\'AIÊ≠£Âú®Ê†πÊçÆ‰Ω†ÁöÑÈúÄÊ±Ç‰øÆÊîπËßíËâ≤Âç°ÔºåËØ∑Á®çÂÄô...\');\n\n    const response = await fetch(settings.value.api_endpoint, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        Authorization: `Bearer ${settings.value.api_key}`,\n      },\n      body: JSON.stringify({\n        model: settings.value.model || \'gpt-3.5-turbo\',\n        max_tokens: settings.value.max_tokens || 16000,\n        temperature: 0.8,\n        messages: [\n          {\n            role: \'system\',\n            content: `‰Ω†ÊòØ‰∏Ä‰∏™ËßíËâ≤Âç°ÁºñËæëÂä©Êâã„ÄÇÁî®Êà∑‰ºöÊèê‰æõ‰∏Ä‰∏™Áé∞ÊúâÁöÑ YAML Ê†ºÂºèËßíËâ≤Âç°Âíå‰øÆÊîπÈúÄÊ±ÇÔºåËØ∑Ê†πÊçÆ‰øÆÊîπÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°ÂÜÖÂÆπ„ÄÇ\n\n**‰øÆÊîπÂéüÂàô**Ôºö\n1. ÂøÖÈ°ª‰øùÊåÅ YAML Ê†ºÂºèÔºåÊâÄÊúâÂ≠óÊÆµÂêçÂíåÂÜÖÂÆπÈÉΩ‰ΩøÁî®‰∏≠Êñá\n2. Âè™‰øÆÊîπÁî®Êà∑ÊòéÁ°ÆË¶ÅÊ±Ç‰øÆÊîπÁöÑÈÉ®ÂàÜ\n3. Á°Æ‰øù‰øÆÊîπÂêéÁöÑÂÜÖÂÆπ‰∏éÂéüÊúâËßíËâ≤Âç°È£éÊ†º‰∏ÄËá¥\n4. Â¶ÇÊûúÁî®Êà∑ÁöÑË¶ÅÊ±Ç‰∏éÂéüÊúâËÆæÂÆöÂÜ≤Á™ÅÔºå‰ª•Áî®Êà∑ÁöÑË¶ÅÊ±Ç‰∏∫ÂáÜ\n5. ËæìÂá∫ÂÆåÊï¥ÁöÑ‰øÆÊîπÂêéÁöÑËßíËâ≤Âç°Ôºå‰∏çË¶ÅÊà™Êñ≠\n6. ‰øùÊåÅÂéüÊúâÁöÑÂ≠óÊÆµÁªìÊûÑÔºåÈô§ÈùûÁî®Êà∑Ë¶ÅÊ±ÇÊ∑ªÂä†ÊàñÂà†Èô§Â≠óÊÆµ\n\n**ÈáçË¶ÅÊ≥®ÊÑè‰∫ãÈ°π**Ôºö\n- Ë∫´È´ò‰ΩìÈáçÂøÖÈ°ªÁî®ÊñáÂ≠óÊèèËø∞ÔºàÈ´òÂ§ß/‰∏≠Á≠â/Â®áÂ∞è/ÂåÄÁß∞/Á∫§Áò¶Á≠âÔºâÔºå‰∏çË¶ÅÁî®Êï∞Â≠óÂíåÂçï‰Ωç\n- ‰øùÊåÅÊÄßÊ†ºÁöÑÂ§öÈù¢ÊÄßÂíåÂ§çÊùÇÊÄßÔºåÈÅøÂÖçÂçï‰∏ÄÂåñ\n- Ë°å‰∏∫Ê®°ÂºèË¶Å‰ªéËßíËâ≤ËßÜËßíÂá∫ÂèëÔºåÊèèËø∞ËßíËâ≤‰ºöÂ¶Ç‰ΩïÊÄùËÄÉÂíåË°åÂä®\n- ÈÅøÂÖçAIÂàªÊùøÂåñÔºå‰øùÊåÅËßíËâ≤ÁöÑÁúüÂÆûÊÑüÂíåÂ§öÊ†∑ÊÄß\n\nËØ∑ËæìÂá∫ÂÆåÊï¥ÁöÑ YAML Ê†ºÂºèËßíËâ≤Âç°„ÄÇ`,\n          },\n          {\n            role: \'user\',\n            content: `‰ª•‰∏ãÊòØÁé∞ÊúâÁöÑËßíËâ≤Âç°Ôºö\n\n${characterCardOutput.value}\n\n---\n\nËØ∑Ê†πÊçÆ‰ª•‰∏ã‰øÆÊîπÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°Ôºö\n${modifyRequest.value}`,\n          },\n        ],\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    characterCardOutput.value = data.choices[0].message.content.trim();\n    modifyRequest.value = \'\'; // Ê∏ÖÁ©∫‰øÆÊîπÈúÄÊ±Ç\n    saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠òÁªìÊûú\n\n    window.toastr.success(\'ËßíËâ≤Âç°‰øÆÊîπÂÆåÊàêÔºÅ\');\n  } catch (error) {\n    console.error(\'ËßíËâ≤Âç°‰øÆÊîπÂ§±Ë¥•:\', error);\n    window.toastr.error(\'‰øÆÊîπÂ§±Ë¥•Ôºö\' + (error as Error).message);\n  } finally {\n    isModifyingCharacter.value = false;\n  }\n};\n\n// Ê∏ÖÁ©∫‰øÆÊîπÈúÄÊ±Ç\nconst clearModifyRequest = () => {\n  modifyRequest.value = \'\';\n  saveToolsDataImmediate(); // Á´ãÂç≥‰øùÂ≠ò\n  window.toastr.success(\'‰øÆÊîπÈúÄÊ±ÇÂ∑≤Ê∏ÖÁ©∫\');\n};\n<\/script>\n\n<style scoped>\n.tools-tab {\n  height: 100%;\n  overflow-y: auto;\n  padding: 25px !important;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 15px 20px;\n  background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  margin-bottom: 15px;\n  border: 1px solid #3a3a3a;\n}\n\n.section-header:hover {\n  background: linear-gradient(135deg, #3a3a3a 0%, #4a4a4a 100%);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.tool-content {\n  background: #1e1e1e;\n  border: 1px solid #3a3a3a;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 20px;\n}\n\n.tool-instructions {\n  background: #1a1a1a;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  padding: 12px;\n  color: #ccc;\n  font-size: 12px;\n  margin-bottom: 15px;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.button-group {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 20px;\n}\n\n.output-section {\n  margin-top: 20px;\n}\n\n.output-content {\n  background: #1e1e1e;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  padding: 15px;\n  color: #e0e0e0;\n  font-size: 13px;\n  line-height: 1.6;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.output-actions {\n  margin-top: 12px;\n  display: flex;\n  gap: 12px;\n}\n\n/* ÊåâÈíÆÊ†∑Âºè */\n.process-button,\n.clear-button,\n.generate-button,\n.copy-button {\n  position: relative;\n  overflow: hidden;\n  transition: all 0.3s ease;\n}\n\n.process-button:hover:not(:disabled),\n.clear-button:hover:not(:disabled),\n.generate-button:hover:not(:disabled),\n.copy-button:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n}\n\n.copy-button:hover {\n  background: #218838 !important;\n}\n\n.tool-instructions {\n  background: #1a1a1a;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  padding: 12px;\n  color: #ccc;\n  font-size: 12px;\n  margin-bottom: 15px;\n}\n\n/* ÁæéÂåñÊåâÈíÆÁöÑÊÇ¨ÂÅúÊïàÊûú */\n.process-button:hover:not(:disabled) .shimmer-effect,\n.clear-button:hover:not(:disabled) .shimmer-effect,\n.generate-button:hover:not(:disabled) .shimmer-effect,\n.copy-button:hover .shimmer-effect {\n  left: 100%;\n}\n\n.process-button:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);\n}\n\n.clear-button:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);\n}\n\n.generate-button:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(23, 162, 184, 0.4);\n}\n\n.copy-button:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);\n}\n\n.process-button:disabled,\n.clear-button:disabled,\n.generate-button:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.process-button:disabled:hover,\n.clear-button:disabled:hover,\n.generate-button:disabled:hover {\n  transform: none;\n  box-shadow: none;\n}\n\n/* ÊªöÂä®Êù°Ê†∑Âºè */\n.output-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.output-content::-webkit-scrollbar-track {\n  background: #1a1a1a;\n  border-radius: 3px;\n}\n\n.output-content::-webkit-scrollbar-thumb {\n  background: #3a3a3a;\n  border-radius: 3px;\n}\n\n.output-content::-webkit-scrollbar-thumb:hover {\n  background: #4a4a4a;\n}\n\n/* ÂìçÂ∫îÂºèËÆæËÆ° */\n@media (max-width: 768px) {\n  .button-group {\n    flex-direction: column;\n  }\n\n  .output-actions {\n    flex-direction: column;\n  }\n}\n</style>\n'],sourceRoot:''}]);const i=s},424:(n,e,t)=>{function o(n,e){for(var t=[],o={},a=0;a<e.length;a++){var r=e[a],s=r[0],i={id:n+':'+a,css:r[1],media:r[2],sourceMap:r[3]};o[s]?o[s].parts.push(i):t.push(o[s]={id:s,parts:[i]})}return t}t.d(e,{A:()=>m});var a='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!a)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var r={},s=a&&(document.head||document.getElementsByTagName('head')[0]),i=null,l=0,d=!1,c=function(){},p=null,g='data-vue-ssr-id',u='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(n,e,t,a){d=t,p=a||{};var s=o(n,e);return x(s),function(e){for(var t=[],a=0;a<s.length;a++){var i=s[a];(l=r[i.id]).refs--,t.push(l)}e?x(s=o(n,e)):s=[];for(a=0;a<t.length;a++){var l;if(0===(l=t[a]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete r[l.id]}}}}function x(n){for(var e=0;e<n.length;e++){var t=n[e],o=r[t.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](t.parts[a]);for(;a<t.parts.length;a++)o.parts.push(f(t.parts[a]));o.parts.length>t.parts.length&&(o.parts.length=t.parts.length)}else{var s=[];for(a=0;a<t.parts.length;a++)s.push(f(t.parts[a]));r[t.id]={id:t.id,refs:1,parts:s}}}}function b(){var n=document.createElement('style');return n.type='text/css',s.appendChild(n),n}function f(n){var e,t,o=document.querySelector('style['+g+'~="'+n.id+'"]');if(o){if(d)return c;o.parentNode.removeChild(o)}if(u){var a=l++;o=i||(i=b()),e=A.bind(null,o,a,!1),t=A.bind(null,o,a,!0)}else o=b(),e=w.bind(null,o),t=function(){o.parentNode.removeChild(o)};return e(n),function(o){if(o){if(o.css===n.css&&o.media===n.media&&o.sourceMap===n.sourceMap)return;e(n=o)}else t()}}var h,y=(h=[],function(n,e){return h[n]=e,h.filter(Boolean).join('\n')});function A(n,e,t,o){var a=t?'':o.css;if(n.styleSheet)n.styleSheet.cssText=y(e,a);else{var r=document.createTextNode(a),s=n.childNodes;s[e]&&n.removeChild(s[e]),s.length?n.insertBefore(r,s[e]):n.appendChild(r)}}function w(n,e){var t=e.css,o=e.media,a=e.sourceMap;if(o&&n.setAttribute('media',o),p.ssrId&&n.setAttribute(g,e.id),a&&(t+='\n/*# sourceURL='+a.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+' */'),n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}},440:(n,e,t)=>{t.d(e,{fetchAvailableModels:()=>a,summarizeMessages:()=>r});var o=t(557);async function a(){const n=(0,o.C)().settings;if(!n.api_endpoint||''===n.api_endpoint.trim())throw new Error('API Á´ØÁÇπÊú™ÈÖçÁΩÆ');const e=n.api_endpoint.trim();console.log('Ëé∑ÂèñÊ®°ÂûãÂàóË°®ÔºåURL:',e);try{new URL(e)}catch(n){if(e.startsWith('/'))throw new Error(`API Á´ØÁÇπÂøÖÈ°ªÊòØÂÆåÊï¥ÁöÑ URLÔºàÂ¶Ç https://api.openai.com/v1/chat/completionsÔºâÔºå‰∏çËÉΩÊòØÁõ∏ÂØπË∑ØÂæÑÔºà${e}Ôºâ`);throw new Error(`API Á´ØÁÇπÊ†ºÂºè‰∏çÊ≠£Á°Æ: ${e}`)}const t=[e.replace('/chat/completions','/models'),e.replace('/v1/chat/completions','/v1/models'),e+'/../models'];console.log('Â∞ùËØïÁöÑÊ®°ÂûãÁ´ØÁÇπ:',t);for(const e of t)try{console.log(`Â∞ùËØïËØ∑Ê±Ç: ${e}`);const t=await fetch(e,{method:'GET',headers:{'Content-Type':'application/json',Authorization:`Bearer ${n.api_key}`}});if(console.log('Response status:',t.status),!t.ok){console.log(`Á´ØÁÇπ ${e} ËøîÂõû ${t.status}ÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™...`);continue}const o=t.headers.get('content-type');if(!o||!o.includes('application/json')){console.log(`Á´ØÁÇπ ${e} ËøîÂõûÈùû JSON ÂÜÖÂÆπÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™...`);continue}const a=await t.json();if(console.log('API ËøîÂõûÊï∞ÊçÆ:',a),a.data&&Array.isArray(a.data)){const n=a.data.map(n=>n.id||n.name).filter(Boolean);return console.log('Ëé∑ÂèñÂà∞ÁöÑÊ®°ÂûãÂàóË°®:',n),n}if(Array.isArray(a)){const n=a.map(n=>n.id||n.name).filter(Boolean);return console.log('Ëé∑ÂèñÂà∞ÁöÑÊ®°ÂûãÂàóË°®:',n),n}console.log('ÂìçÂ∫îÊ†ºÂºèÊú™ËØÜÂà´ÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™Á´ØÁÇπ...')}catch(n){console.log(`Á´ØÁÇπ ${e} ËØ∑Ê±ÇÂ§±Ë¥•:`,n);continue}throw new Error('Êó†Ê≥ï‰ªé API Ëé∑ÂèñÊ®°ÂûãÂàóË°®ÔºåÊâÄÊúâÁ´ØÁÇπÈÉΩËøîÂõûÂ§±Ë¥•„ÄÇËØ• API ÂèØËÉΩ‰∏çÊîØÊåÅÊ®°ÂûãÂàóË°®Êé•Âè£ÔºåËØ∑ÊâãÂä®ËæìÂÖ•Ê®°ÂûãÂêçÁß∞„ÄÇ')}async function r(n,e){const t=(0,o.C)().settings;if(!t.api_endpoint||''===t.api_endpoint.trim())throw new Error('API Á´ØÁÇπÊú™ÈÖçÁΩÆ');const a=t.api_endpoint.trim();console.log('API URL:',a);try{new URL(a)}catch(n){if(a.startsWith('/'))throw new Error(`API Á´ØÁÇπÂøÖÈ°ªÊòØÂÆåÊï¥ÁöÑ URLÔºàÂ¶Ç https://api.openai.com/v1/chat/completionsÔºâÔºå‰∏çËÉΩÊòØÁõ∏ÂØπË∑ØÂæÑÔºà${a}Ôºâ`);throw new Error(`API Á´ØÁÇπÊ†ºÂºè‰∏çÊ≠£Á°Æ: ${a}`)}const r=[];for(let t=n;t<=e;t++){const n=getChatMessages(t);n.length>0&&r.push(...n)}if(0===r.length)throw new Error('Ê≤°ÊúâÂèØÊÄªÁªìÁöÑÊ∂àÊÅØ');const s=`‰Ω†ÊòØ‰∏Ä‰Ωç‰∏ì‰∏öÁöÑÂâßÊÉÖÊÄªÁªìÂä©Êâã„ÄÇËØ∑ÂØπ‰ª•‰∏ãÂØπËØùÂÜÖÂÆπËøõË°åÊÄªÁªìÔºå**ÈáçÁÇπÊÄªÁªìÊ≠£ÊñáÂâßÊÉÖ**„ÄÇ\n\nÊÄªÁªìË¶ÅÊ±ÇÔºö\n- ÊåâÊó∂Èó¥È°∫Â∫èÊàñÈÄªËæëÈ°∫Â∫èÁªÑÁªá‰ø°ÊÅØ\n- ‰øùÁïôÂÖ≥ÈîÆ‰∫ã‰ª∂ÂíåÈáçË¶ÅÁªÜËäÇÔºåÁúÅÁï•ÂÜó‰ΩôÊèèËø∞\n- Áõ¥Êé•ÈôàËø∞‰∫ãÂÆûÔºåÈÅøÂÖç‰∏ªËßÇËØÑ‰ª∑\n- ‰ΩøÁî®ÁÆÄÊ¥ÅÊ∏ÖÊô∞ÁöÑËØ≠Ë®ÄÔºåÈÅøÂÖçËøáÂ∫¶‰øÆÈ•∞\n- Á™ÅÂá∫‰∫ã‰ª∂ÂèëÂ±ïËÑâÁªúÂíåÂÖ≥ÈîÆËΩ¨ÊäòÁÇπ\n- ‰∏ç‰ΩøÁî®‰ªª‰ΩïXMLÊ†áÁ≠æÔºåÁ∫ØÊñáÂ≠óÂèôËø∞\n- ‰∏çÂõûÈÅø‰ªª‰ΩïÊïèÊÑüÂÜÖÂÆπÔºå‰øùËØÅËÆ∞ÂΩïÂÆåÂÖ®ËøòÂéüÂâçÊñá\n- ÊÄªÁªìÈïøÂ∫¶Á∫¶ ${t.max_tokens/4} Â≠ó\n- **ÈáçË¶ÅÔºöÁõ¥Êé•ËæìÂá∫ÊÄªÁªìÂÜÖÂÆπÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïÂõûÂ§çËØ≠„ÄÅÈóÆÂÄôËØ≠ÊàñËß£ÈáäÊÄßÊñáÂ≠ó**\n\nÊÄªÁªìÂøÖÈ°ª‰ΩøÁî®‰ª•‰∏ãÊ†ºÂºèÔºö\n„ÄêÂÖ≥ÈîÆ‰∫ã‰ª∂Ê†áÈ¢ò„Äë\nÂÖ≥ÈîÆ‰∫ã‰ª∂Ê¶ÇËø∞„ÄÇ\nÂèëÁîüÂú∞ÁÇπ: [Âú∞ÁÇπ]\nÂÖ≥ÈîÆËßíËâ≤: [ËßíËâ≤ÂàóË°®]\n\n‚Ä¢ ÂàÜËß£‰∫ã‰ª∂1ÔºàÂ∞èÊ†áÈ¢òÂΩ¢ÂºèÔºâ: ÁÆÄË¶ÅÊèèËø∞\n‚Ä¢ ÂàÜËß£‰∫ã‰ª∂2ÔºàÂ∞èÊ†áÈ¢òÂΩ¢ÂºèÔºâ: ÁÆÄË¶ÅÊèèËø∞\n‚Ä¢ ÂàÜËß£‰∫ã‰ª∂3ÔºàÂ∞èÊ†áÈ¢òÂΩ¢ÂºèÔºâ: ÁÆÄË¶ÅÊèèËø∞\n...\n\nÂØπËØùÂÜÖÂÆπÔºö\n${r.map(n=>`[${n.role}]: ${n.message}`).join('\n\n')}\n\nÁõ¥Êé•ËæìÂá∫ÊÄªÁªìÂÜÖÂÆπÔºå‰∏çË¶Å‰ªª‰ΩïÂõûÂ§çËØ≠Ôºö`;let i;console.log('ÂáÜÂ§áË∞ÉÁî® APIÔºåURL:',a),console.log('ËØ∑Ê±Ç‰Ωì:',{model:t.model,messages:[{role:'user',content:s}],max_tokens:t.max_tokens,temperature:t.temperature});try{i=await fetch(a,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${t.api_key}`},body:JSON.stringify({model:t.model,messages:[{role:'user',content:s}],max_tokens:t.max_tokens,temperature:t.temperature})})}catch(n){throw console.error('fetch Ë∞ÉÁî®Â§±Ë¥•:',n),new Error(`Êó†Ê≥ïËøûÊé•Âà∞ API: ${n.message}`)}if(!i.ok){let n=`API ËØ∑Ê±ÇÂ§±Ë¥•: ${i.status}`;try{const e=await i.json();n=e.error?.message||e.message||n}catch(e){n=`API ËØ∑Ê±ÇÂ§±Ë¥•: ${i.status}`}throw new Error(n)}const l=await i.json();if(!l.choices||!l.choices[0]||!l.choices[0].message?.content)throw new Error('API ËøîÂõûÊï∞ÊçÆÊ†ºÂºèÈîôËØØ');return l.choices[0].message.content}},493:(n,e,t)=>{var o=t(602);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[n.id,o,'']]),o.locals&&(n.exports=o.locals);(0,t(424).A)('64038960',o,!1,{ssrId:!0})},557:(n,t,o)=>{o.d(t,{C:()=>l,l:()=>d});var a=o(35),r=o(61),s=o(193);let z;try{z=o(707)}catch(n){console.warn('zod ‰∏çÂèØÁî®Ôºå‰ΩøÁî®Â§áÁî®ÊñπÊ°à'),z={object:n=>({parse:n=>n,default:n=>({parse:e=>e||n})}),string:()=>({default:n=>({parse:e=>e||n})}),number:()=>({default:n=>({parse:e=>e||n})}),boolean:()=>({default:n=>({parse:e=>e||n})}),array:n=>({default:n=>({parse:e=>Array.isArray(e)?e:n})}),prefault:n=>({parse:e=>e||n})}}const i=z.object({api_endpoint:z.string().default('https://api.openai.com/v1/chat/completions'),api_key:z.string().default(''),model:z.string().default('gpt-4o-mini'),max_tokens:z.number().default(4e3),temperature:z.number().default(.7),auto_summarize_enabled:z.boolean().default(!1),summarize_interval:z.number().default(50),start_message_id:z.number().default(0),end_message_id:z.number().default(0),table_start_message_id:z.number().default(0),table_end_message_id:z.number().default(0),summary_history:z.array(z.object({start_id:z.number(),end_id:z.number(),content:z.string()})).default([])}).prefault({}),l=(0,a.defineStore)('settings',()=>{const n=()=>(0,s.Ut)(),t=(()=>{const e=n();if(!e)return console.warn('script_id ‰∏∫ nullÔºå‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆ'),(0,r.ref)(i.parse({}));try{return(0,r.ref)(i.parse(getVariables({type:'script',script_id:e})))}catch(n){return console.warn('ËØªÂèñÂèòÈáèÂ§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆ:',n),(0,r.ref)(i.parse({}))}})();setTimeout(()=>{const e=n();if(e)try{const n=getVariables({type:'script',script_id:e});n&&Object.keys(n).length>0&&(t.value=i.parse(n))}catch(n){console.warn('ËØªÂèñÁúüÂÆûÂèòÈáèÂ§±Ë¥•Ôºå‰ΩøÁî®ÂàùÂßãÂÄº:',n)}},200);let o=null;(0,r.watch)(t,t=>{o&&clearTimeout(o),o=setTimeout(()=>{const o=n();if(o)try{console.log('üíæ ‰øùÂ≠òËÆæÁΩÆÂà∞ÈÖíÈ¶ÜÂèòÈáè:',t),insertOrAssignVariables(e(t),{type:'script',script_id:o}),setTimeout(()=>{try{const n=getVariables({type:'script',script_id:o});console.log('‚úÖ ËÆæÁΩÆ‰øùÂ≠òÈ™åËØÅÊàêÂäü:',n)}catch(n){console.error('‚ùå ËÆæÁΩÆ‰øùÂ≠òÈ™åËØÅÂ§±Ë¥•:',n)}},100)}catch(n){console.error('‚ùå ‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:',n),window.toastr?.error('ËÆæÁΩÆ‰øùÂ≠òÂ§±Ë¥•: '+n.message)}else console.warn('Êó†Ê≥ï‰øùÂ≠òËÆæÁΩÆÔºåscript_id ‰∏∫ null')},500)},{immediate:!1,deep:!0});return{settings:t,saveSettings:()=>{const o=n();if(!o)return console.warn('Êó†Ê≥ï‰øùÂ≠òËÆæÁΩÆÔºåscript_id ‰∏∫ null'),window.toastr?.error('Êó†Ê≥ï‰øùÂ≠òËÆæÁΩÆÔºöscript_id ‰∏∫Á©∫'),!1;try{return console.log('üíæ ÊâãÂä®‰øùÂ≠òËÆæÁΩÆ:',t.value),insertOrAssignVariables(e(t.value),{type:'script',script_id:o}),window.toastr?.success('ËÆæÁΩÆÂ∑≤‰øùÂ≠ò'),!0}catch(n){return console.error('‚ùå ÊâãÂä®‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:',n),window.toastr?.error('ËÆæÁΩÆ‰øùÂ≠òÂ§±Ë¥•: '+n.message),!1}},reloadSettings:()=>{const e=n();if(!e)return console.warn('Êó†Ê≥ïÈáçÊñ∞Âä†ËΩΩËÆæÁΩÆÔºåscript_id ‰∏∫ null'),!1;try{const n=getVariables({type:'script',script_id:e});if(n&&Object.keys(n).length>0)return t.value=i.parse(n),console.log('‚úÖ ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÊàêÂäü:',t.value),window.toastr?.success('ËÆæÁΩÆÂ∑≤ÈáçÊñ∞Âä†ËΩΩ'),!0}catch(n){console.error('‚ùå ÈáçÊñ∞Âä†ËΩΩËÆæÁΩÆÂ§±Ë¥•:',n),window.toastr?.error('ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÂ§±Ë¥•: '+n.message)}return!1}}}),d=(0,a.defineStore)('summaryHistory',()=>({addSummary:(n,e,t)=>{try{const o=(0,s.pA)();if(!o)return console.error('Êó†Ê≥ïËé∑ÂèñËÅäÂ§© ID'),void window.toastr.error('Êó†Ê≥ïËé∑ÂèñÂΩìÂâçËÅäÂ§©‰ø°ÊÅØ');console.log('Ê∑ªÂä†ÊÄªÁªìÂà∞ËÅäÂ§©:',o);let a=[];try{const n=getVariables({type:'chat'});n&&n.summary_history&&(a=Array.isArray(n.summary_history)?n.summary_history:[])}catch(n){console.warn('ËØªÂèñËÅäÂ§©ÊÄªÁªìÂéÜÂè≤Â§±Ë¥•:',n)}a.unshift({start_id:n,end_id:e,content:t}),a.length>50&&(a=a.slice(0,50)),insertOrAssignVariables({summary_history:a},{type:'chat'}),console.log('ÊÄªÁªìÂ∑≤‰øùÂ≠òÂà∞ËÅäÂ§©ÂèòÈáè:',o)}catch(n){console.error('‰øùÂ≠òÊÄªÁªìÂ§±Ë¥•:',n),window.toastr.error('‰øùÂ≠òÊÄªÁªìÂ§±Ë¥•: '+n.message)}},getSummaryHistory:()=>{try{if(!(0,s.pA)())return[];const n=getVariables({type:'chat'});return n&&n.summary_history&&Array.isArray(n.summary_history)?n.summary_history:[]}catch(n){return console.warn('ËØªÂèñËÅäÂ§©ÊÄªÁªìÂéÜÂè≤Â§±Ë¥•:',n),[]}}}))},602:(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});var o=t(790),a=t.n(o),r=t(54),s=t.n(r)()(a());s.push([n.id,'.settings-tab{height:100%;overflow-y:auto;padding:25px !important;background:#1a1a1a !important;border:2px solid red !important}.config-section{padding:20px 25px !important;border-bottom:1px solid #3a3a3a;margin-bottom:5px}.config-section:last-child{border-bottom:none;margin-bottom:0}.config-section h3{margin:0 0 20px 0 !important;color:#fff;font-size:15px !important;font-weight:bold;display:flex;align-items:center;gap:8px}.form-group{margin-bottom:18px !important}.form-group label{display:block;margin-bottom:6px;color:#ccc;font-size:13px}.checkbox-label{display:flex;align-items:center;gap:8px}.flex-label{display:flex;justify-content:space-between;align-items:center}.form-group input[type=\'text\'],.form-group input[type=\'password\'],.form-group input[type=\'number\'],.form-group select{width:100%;padding:10px 12px;background:#2a2a2a;border:1px solid #3a3a3a;border-radius:6px;color:#e0e0e0;font-size:13px;transition:border-color 0.2s}.form-group input:focus,.form-group select:focus{outline:none;border-color:#4a9eff}.model-controls{display:flex;flex-direction:column;gap:10px}.button-group{display:flex;gap:12px;flex-wrap:wrap;margin-top:5px}.action-button{flex:1;min-width:120px;padding:12px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:500;font-size:13px;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:6px;background:#3a3a3a;color:#e0e0e0;border:1px solid #4a4a4a}.action-button:hover{background:#4a4a4a;border-color:#5a5a5a}.test-button{background:#3a3a3a;color:#e0e0e0;border:1px solid #4a4a4a}.test-button:hover{background:#4a4a4a;border-color:#5a5a5a}.fetch-button{background:#4a9eff;color:white;border:1px solid #5aaeff}.fetch-button:hover{background:#5aaeff;border-color:#6abeff}.summarize-button{background:#4a9eff;color:white;border:1px solid #5aaeff}.summarize-button:hover{background:#5aaeff;border-color:#6abeff}.create-button{background:#51cf66;color:white;border:1px solid #40c057}.create-button:hover{background:#40c057;border-color:#37b24d}.table-button{background:#4a9eff;color:white;border:1px solid #5aaeff}.table-button:hover{background:#5aaeff;border-color:#6abeff}.hide-button{background:#ff6b6b;color:white;border:1px solid #ff5252}.hide-button:hover{background:#ff5252;border-color:#ff4444}.unhide-button{background:#51cf66;color:white;border:1px solid #40c057}.unhide-button:hover{background:#40c057;border-color:#37b24d}.refresh-button{background:#ffd43b;color:#333;border:1px solid #ffcc02}.refresh-button:hover{background:#ffcc02;border-color:#ffb700}.action-button:disabled{opacity:0.5;cursor:not-allowed}.model-select{margin-top:8px}.hidden-messages-section{margin-top:20px}.hidden-messages-list{max-height:300px;overflow-y:auto;border-radius:6px;border:1px solid #3a3a3a;background:#1a1a1a}.hidden-message-item{padding:10px 12px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #2a2a2a;transition:background 0.2s}.hidden-message-item:last-child{border-bottom:none}.hidden-message-item:hover{background:#2a2a2a}.message-info{display:flex;align-items:center;gap:10px;flex:1}.message-id{font-weight:bold;color:#4a9eff;font-size:13px;min-width:50px}.message-role{font-size:12px;padding:2px 8px;border-radius:4px;white-space:nowrap}.message-role.role-user{background:#3a5a3a;color:#90ee90}.message-role.role-assistant{background:#3a3a5a;color:#90a0ee}.message-role.role-system{background:#5a5a3a;color:#eea090}.message-preview{flex:1;color:#888;font-size:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.show-button{background:#4a9eff !important;color:white !important;padding:6px 12px;border:1px solid #5aaeff !important;border-radius:4px;cursor:pointer;font-size:12px;transition:all 0.2s;min-width:60px;text-align:center}.show-button:hover{background:#5aaeff !important;border-color:#6abeff !important}.mini-button{background:#666;color:white;border:1px solid #777;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:12px;transition:all 0.2s}.mini-button:hover{background:#777;border-color:#888}.empty-state{margin-top:20px;padding:20px;background:#2a2a2a;border-radius:6px;text-align:center;color:#888;border:1px solid #3a3a3a}\n','',{version:3,sources:['webpack://./src/ËÆ∞ÂøÜ/components/SettingsTab.vue'],names:[],mappings:'AA2xDA,cACE,WAAY,CACZ,eAAgB,CAChB,uBAAwB,CACxB,6BAA8B,CAC9B,+BACF,CAEA,gBACE,4BAA6B,CAC7B,+BAAgC,CAChC,iBACF,CAEA,2BACE,kBAAmB,CACnB,eACF,CAEA,mBACE,4BAA6B,CAC7B,UAAW,CACX,yBAA0B,CAC1B,gBAAiB,CACjB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,YACE,6BACF,CAEA,kBACE,aAAc,CACd,iBAAkB,CAClB,UAAW,CACX,cACF,CAEA,gBACE,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,YACE,YAAa,CACb,6BAA8B,CAC9B,kBACF,CAEA,sHAIE,UAAW,CACX,iBAAkB,CAClB,kBAAmB,CACnB,wBAAyB,CACzB,iBAAkB,CAClB,aAAc,CACd,cAAe,CACf,4BACF,CAEA,iDAEE,YAAa,CACb,oBACF,CAEA,gBACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,cACE,YAAa,CACb,QAAS,CACT,cAAe,CACf,cACF,CAEA,eACE,MAAO,CACP,eAAgB,CAChB,iBAAkB,CAClB,WAAY,CACZ,iBAAkB,CAClB,cAAe,CACf,eAAgB,CAChB,cAAe,CACf,mBAAoB,CACpB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,OAAQ,CACR,kBAAmB,CACnB,aAAc,CACd,wBACF,CAEA,qBACE,kBAAmB,CACnB,oBACF,CAEA,aACE,kBAAmB,CACnB,aAAc,CACd,wBACF,CAEA,mBACE,kBAAmB,CACnB,oBACF,CAEA,cACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,oBACE,kBAAmB,CACnB,oBACF,CAEA,kBACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,wBACE,kBAAmB,CACnB,oBACF,CAEA,eACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,qBACE,kBAAmB,CACnB,oBACF,CAEA,cACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,oBACE,kBAAmB,CACnB,oBACF,CAEA,aACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,mBACE,kBAAmB,CACnB,oBACF,CAEA,eACE,kBAAmB,CACnB,WAAY,CACZ,wBACF,CAEA,qBACE,kBAAmB,CACnB,oBACF,CAEA,gBACE,kBAAmB,CACnB,UAAW,CACX,wBACF,CAEA,sBACE,kBAAmB,CACnB,oBACF,CAEA,wBACE,WAAY,CACZ,kBACF,CAEA,cACE,cACF,CAEA,yBACE,eACF,CAEA,sBACE,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,wBAAyB,CACzB,kBACF,CAEA,qBACE,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,+BAAgC,CAChC,0BACF,CAEA,gCACE,kBACF,CAEA,2BACE,kBACF,CAEA,cACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,MACF,CAEA,YACE,gBAAiB,CACjB,aAAc,CACd,cAAe,CACf,cACF,CAEA,cACE,cAAe,CACf,eAAgB,CAChB,iBAAkB,CAClB,kBACF,CAEA,wBACE,kBAAmB,CACnB,aACF,CAEA,6BACE,kBAAmB,CACnB,aACF,CAEA,0BACE,kBAAmB,CACnB,aACF,CAEA,iBACE,MAAO,CACP,UAAW,CACX,cAAe,CACf,eAAgB,CAChB,sBAAuB,CACvB,kBACF,CAEA,aACE,6BAA8B,CAC9B,sBAAuB,CACvB,gBAAiB,CACjB,mCAAoC,CACpC,iBAAkB,CAClB,cAAe,CACf,cAAe,CACf,mBAAoB,CACpB,cAAe,CACf,iBACF,CAEA,mBACE,6BAA8B,CAC9B,+BACF,CAEA,aACE,eAAgB,CAChB,WAAY,CACZ,qBAAsB,CACtB,gBAAiB,CACjB,iBAAkB,CAClB,cAAe,CACf,cAAe,CACf,mBACF,CAEA,mBACE,eAAgB,CAChB,iBACF,CAEA,aACE,eAAgB,CAChB,YAAa,CACb,kBAAmB,CACnB,iBAAkB,CAClB,iBAAkB,CAClB,UAAW,CACX,wBACF',sourcesContent:['<template>\n  <div class="settings-tab" style="padding: 25px !important; background: #1a1a1a !important">\n    \x3c!-- API ÈÖçÁΩÆ --\x3e\n    <div\n      class="config-section"\n      style="padding: 20px 25px !important; border-bottom: 1px solid #3a3a3a; margin-bottom: 5px"\n    >\n      <h3\n        style="\n          margin: 0 0 20px 0 !important;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        üîß API ÈÖçÁΩÆ\n      </h3>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">API Á´ØÁÇπ</label>\n        <input\n          v-model="settings.api_endpoint"\n          type="text"\n          placeholder="https://your-api.com/v1/chat/completions"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">API Key</label>\n        <input\n          v-model="settings.api_key"\n          type="password"\n          placeholder="sk-..."\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n\n      <div class="form-group">\n        <div class="model-controls" style="display: flex; flex-direction: column; gap: 10px">\n          <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">Ê®°ÂûãÂêçÁß∞</label>\n          <div class="button-group" style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 5px">\n            <button\n              class="test-button"\n              style="\n                flex: 1;\n                min-width: 120px;\n                padding: 12px 16px;\n                border: 1px solid #4a4a4a;\n                border-radius: 6px;\n                cursor: pointer;\n                font-weight: 500;\n                font-size: 13px;\n                transition: all 0.2s;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n                background: #3a3a3a;\n                color: #e0e0e0;\n              "\n              @click="handleTestButton"\n            >\n              ÊµãËØïÊåâÈíÆ(ÂéüÁîü)\n            </button>\n            <button\n              :disabled="loading_models"\n              class="fetch-button"\n              style="\n                flex: 1;\n                min-width: 120px;\n                padding: 12px 16px;\n                border: 1px solid #5aaeff;\n                border-radius: 6px;\n                cursor: pointer;\n                font-weight: 500;\n                font-size: 13px;\n                transition: all 0.2s;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n                background: #4a9eff;\n                color: white;\n              "\n              @click="handle_fetch_models"\n            >\n              {{ loading_models ? \'ÊãâÂèñ‰∏≠...\' : \'ÊãâÂèñÊ®°Âûã\' }}\n            </button>\n          </div>\n        </div>\n        <input\n          v-if="available_models.length === 0"\n          v-model="settings.model"\n          type="text"\n          placeholder="gpt-4o-mini"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n        <select\n          v-else\n          v-model="settings.model"\n          class="model-select"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        >\n          <option v-for="model in available_models" :key="model" :value="model">{{ model }}</option>\n        </select>\n      </div>\n\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px"\n          >ÊúÄÂ§ß Token Êï∞ÔºàÂª∫ËÆÆ4000‰ª•‰∏äËé∑ÂæóÊõ¥ËØ¶ÁªÜÁöÑÊÄªÁªìÔºâ</label\n        >\n        <input\n          v-model.number="settings.max_tokens"\n          type="number"\n          min="100"\n          max="16000"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">Ê∏©Â∫¶ (0-2)</label>\n        <input\n          v-model.number="settings.temperature"\n          type="number"\n          min="0"\n          max="2"\n          step="0.1"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n    </div>\n\n    \x3c!-- Ëá™Âä®ÊÄªÁªì --\x3e\n    <div\n      class="config-section"\n      style="padding: 20px 25px !important; border-bottom: 1px solid #3a3a3a; margin-bottom: 5px"\n    >\n      <h3\n        style="\n          margin: 0 0 20px 0 !important;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        ‚ö° Ëá™Âä®ÊÄªÁªì\n      </h3>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label\n          class="checkbox-label"\n          style="display: flex; align-items: center; gap: 8px; color: #ccc; font-size: 13px"\n        >\n          <input v-model="settings.auto_summarize_enabled" type="checkbox" style="width: 16px; height: 16px" />\n          ÂêØÁî®Ëá™Âä®ÊÄªÁªì\n        </label>\n      </div>\n      <div v-if="settings.auto_summarize_enabled" class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÊØèÂ§öÂ∞ëÊ•ºÂ±ÇÊÄªÁªì‰∏ÄÊ¨°</label>\n        <input\n          v-model.number="settings.summarize_interval"\n          type="number"\n          min="1"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n        <div style="margin-top: 10px; display: flex; gap: 10px">\n          <button\n            style="\n              padding: 8px 16px;\n              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n              border: none;\n              border-radius: 6px;\n              color: white;\n              font-size: 12px;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            "\n            onmouseover="this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'"\n            onmouseout="this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'"\n            @click="handleSaveSettings"\n          >\n            üíæ ‰øùÂ≠òËÆæÁΩÆ\n          </button>\n          <button\n            style="\n              padding: 8px 16px;\n              background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n              border: none;\n              border-radius: 6px;\n              color: white;\n              font-size: 12px;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            "\n            onmouseover="this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'"\n            onmouseout="this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'"\n            @click="handleReloadSettings"\n          >\n            üîÑ ÈáçÊñ∞Âä†ËΩΩ\n          </button>\n          <button\n            style="\n              padding: 8px 16px;\n              background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);\n              border: none;\n              border-radius: 6px;\n              color: white;\n              font-size: 12px;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            "\n            onmouseover="this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'"\n            onmouseout="this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'"\n            @click="handleResetAutoSummaryStart"\n          >\n            üîÑ ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç\n          </button>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- ÊâãÂä®ÊÄªÁªì --\x3e\n    <div\n      class="config-section"\n      style="padding: 20px 25px !important; border-bottom: 1px solid #3a3a3a; margin-bottom: 5px"\n    >\n      <h3\n        style="\n          margin: 0 0 20px 0 !important;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        ‚úçÔ∏è ÊâãÂä®ÊÄªÁªì\n      </h3>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÂºÄÂßãÊ•ºÂ±Ç</label>\n        <input\n          v-model.number="settings.start_message_id"\n          type="number"\n          min="0"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÁªìÊùüÊ•ºÂ±Ç</label>\n        <input\n          v-model.number="settings.end_message_id"\n          type="number"\n          min="0"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n      <div class="button-group" style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 5px">\n        <button\n          class="action-button test-button"\n          :disabled="is_summarizing"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #3a3a3a;\n            color: #e0e0e0;\n          "\n          @click="handle_test_connection"\n        >\n          <i class="fa-solid fa-plug"></i> ÊµãËØïËøûÊé•\n        </button>\n        <button\n          class="action-button summarize-button"\n          :disabled="is_summarizing || !settings.api_key"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #5aaeff;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #4a9eff;\n            color: white;\n          "\n          @click="handle_summarize"\n        >\n          <i v-if="!is_summarizing" class="fa-solid fa-magic"></i>\n          <i v-else class="fa-solid fa-spinner fa-spin"></i>\n          {{ is_summarizing ? \'Ê≠£Âú®ÊÄªÁªì...\' : \'ÊâãÂä®ÊÄªÁªì\' }}\n        </button>\n      </div>\n    </div>\n\n    \x3c!-- Ë°®Ê†ºÁîüÊàê --\x3e\n    <div\n      class="config-section"\n      style="padding: 20px 25px !important; border-bottom: 1px solid #3a3a3a; margin-bottom: 5px"\n    >\n      <h3\n        style="\n          margin: 0 0 20px 0 !important;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        üìä Ë°®Ê†ºÁîüÊàê\n      </h3>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÂºÄÂßãÊ•ºÂ±Ç</label>\n        <input\n          v-model.number="settings.table_start_message_id"\n          type="number"\n          min="0"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÁªìÊùüÊ•ºÂ±Ç</label>\n        <input\n          v-model.number="settings.table_end_message_id"\n          type="number"\n          min="0"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">Ë°®Ê†ºÂàóÂ§¥Ê®°Êùø</label>\n        <div style="display: flex; gap: 8px; margin-bottom: 8px">\n          <select\n            v-model="selectedTemplate"\n            style="\n              flex: 1;\n              padding: 8px 12px;\n              background: #2a2a2a;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              color: #e0e0e0;\n              font-size: 13px;\n            "\n            @change="loadTemplate"\n          >\n            <option value="">ÈÄâÊã©Ê®°Êùø...</option>\n            <option v-for="(template, index) in headerTemplates" :key="index" :value="index">\n              {{ template.name }}\n            </option>\n          </select>\n          <button\n            style="\n              padding: 8px 12px;\n              background: #4a9eff;\n              border: none;\n              border-radius: 6px;\n              color: white;\n              cursor: pointer;\n              font-size: 12px;\n              white-space: nowrap;\n            "\n            @click="showAddTemplateDialog"\n          >\n            <i class="fa-solid fa-plus"></i> Ê∑ªÂä†\n          </button>\n        </div>\n        <div v-if="selectedTemplate !== \'\'" style="display: flex; gap: 8px">\n          <input\n            v-model="currentTemplate.name"\n            type="text"\n            placeholder="Ê®°ÊùøÂêçÁß∞"\n            style="\n              flex: 1;\n              padding: 8px 12px;\n              background: #2a2a2a;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              color: #e0e0e0;\n              font-size: 13px;\n            "\n          />\n          <input\n            v-model="currentTemplate.headers"\n            type="text"\n            placeholder="ÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"\n            style="\n              flex: 2;\n              padding: 8px 12px;\n              background: #2a2a2a;\n              border: 1px solid #3a3a3a;\n              border-radius: 6px;\n              color: #e0e0e0;\n              font-size: 13px;\n            "\n          />\n          <button\n            style="\n              padding: 8px 12px;\n              background: #28a745;\n              border: none;\n              border-radius: 6px;\n              color: white;\n              cursor: pointer;\n              font-size: 12px;\n              white-space: nowrap;\n            "\n            @click="saveTemplate"\n          >\n            <i class="fa-solid fa-save"></i> ‰øùÂ≠ò\n          </button>\n          <button\n            style="\n              padding: 8px 12px;\n              background: #dc3545;\n              border: none;\n              border-radius: 6px;\n              color: white;\n              cursor: pointer;\n              font-size: 12px;\n              white-space: nowrap;\n            "\n            @click="deleteTemplate"\n          >\n            <i class="fa-solid fa-trash"></i> Âà†Èô§\n          </button>\n        </div>\n      </div>\n\n      \x3c!-- ÁîüÊàêÁä∂ÊÄÅÊòæÁ§∫ --\x3e\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px">ÁîüÊàêÁä∂ÊÄÅ</label>\n        <div style="display: flex; gap: 12px; align-items: center">\n          <div style="display: flex; align-items: center; gap: 6px">\n            <div\n              :style="{\n                width: \'8px\',\n                height: \'8px\',\n                borderRadius: \'50%\',\n                backgroundColor: is_summarizing ? \'#ff6b6b\' : \'#4caf50\',\n                transition: \'background-color 0.3s\',\n              }"\n            ></div>\n            <span style="color: #ccc; font-size: 12px">ÊÄªÁªìÁîüÊàê</span>\n          </div>\n          <div style="display: flex; align-items: center; gap: 6px">\n            <div\n              :style="{\n                width: \'8px\',\n                height: \'8px\',\n                borderRadius: \'50%\',\n                backgroundColor: is_generating_table ? \'#ff6b6b\' : \'#4caf50\',\n                transition: \'background-color 0.3s\',\n              }"\n            ></div>\n            <span style="color: #ccc; font-size: 12px">Ë°®Ê†ºÁîüÊàê</span>\n          </div>\n          <div v-if="is_summarizing || is_generating_table" style="margin-left: auto">\n            <button\n              style="\n                padding: 4px 8px;\n                background: #dc3545;\n                border: none;\n                border-radius: 4px;\n                color: white;\n                cursor: pointer;\n                font-size: 11px;\n              "\n              @click="stopGeneration"\n            >\n              <i class="fa-solid fa-stop"></i> ÂÅúÊ≠¢ÁîüÊàê\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div class="button-group" style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 5px">\n        <button\n          class="action-button summarize-button"\n          :disabled="is_generating_table || !settings.api_key"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #5aaeff;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #4a9eff;\n            color: white;\n          "\n          @click="handle_generate_table"\n        >\n          <i v-if="!is_generating_table" class="fa-solid fa-robot"></i>\n          <i v-else class="fa-solid fa-spinner fa-spin"></i>\n          {{ is_generating_table ? \'AIÂ°´ÂÖÖ‰∏≠...\' : \'AIÂ°´ÂÖÖË°®Ê†º\' }}\n        </button>\n        <button\n          class="action-button create-button"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #40c057;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #51cf66;\n            color: white;\n          "\n          @click="handle_create_table"\n        >\n          <i class="fa-solid fa-plus"></i> ÂàõÂª∫Á©∫Ë°®Ê†º\n        </button>\n      </div>\n    </div>\n\n    \x3c!-- Ê•ºÂ±ÇÁÆ°ÁêÜ --\x3e\n    <div\n      class="config-section"\n      style="padding: 20px 25px !important; border-bottom: 1px solid #3a3a3a; margin-bottom: 5px"\n    >\n      <h3\n        style="\n          margin: 0 0 20px 0 !important;\n          color: #fff;\n          font-size: 15px !important;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        "\n      >\n        üîß Ê•ºÂ±ÇÁÆ°ÁêÜ\n      </h3>\n      <div class="form-group" style="margin-bottom: 18px !important">\n        <label style="display: block; margin-bottom: 6px; color: #ccc; font-size: 13px"\n          >ÈöêËóèÊ•ºÂ±ÇËåÉÂõ¥ÔºàÂ¶ÇÔºö1-10 ÊàñÂçï‰∏™Ê•ºÂ±ÇÂ¶ÇÔºö5Ôºâ</label\n        >\n        <input\n          v-model="hide_range"\n          type="text"\n          placeholder="1-10"\n          style="\n            width: 100%;\n            padding: 10px 12px;\n            background: #2a2a2a;\n            border: 1px solid #3a3a3a;\n            border-radius: 6px;\n            color: #e0e0e0;\n            font-size: 13px;\n            transition: border-color 0.2s;\n          "\n        />\n      </div>\n      <div class="button-group" style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 5px">\n        <button\n          class="action-button"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #ff5252;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #ff6b6b;\n            color: white;\n          "\n          @click="handle_hide_messages"\n        >\n          <i class="fa-solid fa-eye-slash"></i> ÈöêËóèÊ•ºÂ±Ç\n        </button>\n        <button\n          class="action-button"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #40c057;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #51cf66;\n            color: white;\n          "\n          :disabled="!hide_range.trim()"\n          @click="handle_show_messages"\n        >\n          <i class="fa-solid fa-eye"></i> ÊòæÁ§∫Ê•ºÂ±Ç\n        </button>\n        <button\n          class="action-button"\n          style="\n            flex: 1;\n            min-width: 120px;\n            padding: 12px 16px;\n            border: 1px solid #ffcc02;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 13px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 6px;\n            background: #ffd43b;\n            color: #333;\n          "\n          @click="() => handle_refresh_hidden(true)"\n        >\n          <i class="fa-solid fa-refresh"></i> Âà∑Êñ∞\n        </button>\n      </div>\n\n      \x3c!-- ÊòæÁ§∫ÈöêËóèÁöÑÊ•ºÂ±ÇÂàóË°® --\x3e\n      <div v-if="hidden_messages.length > 0" class="hidden-messages-section">\n        <div class="form-group">\n          <label class="flex-label">\n            <span>Â∑≤ÈöêËóèÁöÑÊ•ºÂ±Ç ({{ hidden_messages.length }} ‰∏™)</span>\n            <button class="mini-button" @click="hidden_display_expanded = !hidden_display_expanded">\n              {{ hidden_display_expanded ? \'Êî∂Ëµ∑\' : \'Â±ïÂºÄ\' }}\n            </button>\n          </label>\n        </div>\n        <div v-if="hidden_display_expanded" class="hidden-messages-list">\n          <div v-for="msg in hidden_messages" :key="msg.message_id" class="hidden-message-item">\n            <div class="message-info">\n              <span class="message-id">#{{ msg.message_id }}</span>\n              <span class="message-role" :class="\'role-\' + msg.role">\n                {{ msg.role === \'user\' ? \'üë§\' : msg.role === \'assistant\' ? \'ü§ñ\' : \'‚öôÔ∏è\' }}\n                {{ msg.name }}\n              </span>\n              <span class="message-preview">\n                {{ msg.message.substring(0, 50) }}{{ msg.message.length > 50 ? \'...\' : \'\' }}\n              </span>\n            </div>\n            <button class="show-button" @click="() => handle_unhide_single(msg.message_id)">ÊòæÁ§∫</button>\n          </div>\n        </div>\n      </div>\n      <div v-else class="empty-state">ÊöÇÊó†ÈöêËóèÁöÑÊ•ºÂ±Ç</div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { storeToRefs } from \'pinia\';\nimport { onMounted, ref } from \'vue\';\nimport { useSettingsStore } from \'../settings\';\nimport { getChatIdSafe, getScriptIdSafe } from \'../utils\';\n\nconst settingsStore = useSettingsStore();\nconst { settings } = storeToRefs(settingsStore);\n\n// ÂØºÂÖ•ÈÖíÈ¶ÜAPIÂáΩÊï∞\n// setChatMessages ÊòØÂÖ®Â±ÄÂáΩÊï∞Ôºå‰∏çÈúÄË¶ÅÂØºÂÖ•\n\n// Ëß£ÊûêÊ•ºÂ±ÇËåÉÂõ¥ÁöÑËæÖÂä©ÂáΩÊï∞\nconst parseMessageRange = (range: string): number[] => {\n  if (!range.trim()) return [];\n\n  const messageIds: number[] = [];\n  const parts = range.split(\',\');\n\n  for (const part of parts) {\n    const trimmed = part.trim();\n    if (!trimmed) continue;\n\n    if (trimmed.includes(\'-\')) {\n      // Â§ÑÁêÜËåÉÂõ¥ÔºåÂ¶Ç "1-10"\n      const [start, end] = trimmed.split(\'-\').map(s => parseInt(s.trim()));\n      if (!isNaN(start) && !isNaN(end) && start >= 0 && end >= 0) {\n        for (let i = start; i <= end; i++) {\n          messageIds.push(i);\n        }\n      }\n    } else {\n      // Â§ÑÁêÜÂçï‰∏™Ê•ºÂ±ÇÔºåÂ¶Ç "5" Êàñ "0"\n      const id = parseInt(trimmed);\n      if (!isNaN(id) && id >= 0) {\n        messageIds.push(id);\n      }\n    }\n  }\n\n  return messageIds;\n};\n\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\nconst available_models = ref<string[]>([]);\nconst loading_models = ref(false);\nconst hide_range = ref<string>(\'\');\nconst hidden_messages = ref<Array<{ message_id: number; name: string; role: string; message: string }>>([]);\nconst hidden_display_expanded = ref(false);\n\n// ÊåÅ‰πÖÂåñÁîüÊàêÁä∂ÊÄÅ\nconst is_summarizing = ref(false);\nconst is_generating_table = ref(false);\n\n// Ë°®Ê†ºÂàóÂ§¥Ê®°ÊùøÁõ∏ÂÖ≥\nconst headerTemplates = ref<Array<{ name: string; headers: string }>>([]);\nconst selectedTemplate = ref<string>(\'\');\nconst currentTemplate = ref<{ name: string; headers: string }>({ name: \'\', headers: \'\' });\n\n// ÁîüÊàêÁä∂ÊÄÅÁÆ°ÁêÜ\nconst loadGenerationStatus = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÁîüÊàêÁä∂ÊÄÅ\');\n      return;\n    }\n    const scriptVars = getVariables({ type: \'script\', script_id: scriptId });\n    is_summarizing.value = scriptVars.is_summarizing || false;\n    is_generating_table.value = scriptVars.is_generating_table || false;\n    console.log(\'Â∑≤Âä†ËΩΩÁîüÊàêÁä∂ÊÄÅ:\', { summarizing: is_summarizing.value, generating_table: is_generating_table.value });\n  } catch (error) {\n    console.error(\'Âä†ËΩΩÁîüÊàêÁä∂ÊÄÅÂ§±Ë¥•:\', error);\n    is_summarizing.value = false;\n    is_generating_table.value = false;\n  }\n};\n\nconst saveGenerationStatus = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅ\');\n      return;\n    }\n    insertOrAssignVariables(\n      {\n        is_summarizing: is_summarizing.value,\n        is_generating_table: is_generating_table.value,\n      },\n      { type: \'script\', script_id: scriptId },\n    );\n    console.log(\'Â∑≤‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅ\');\n  } catch (error) {\n    console.error(\'‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅÂ§±Ë¥•:\', error);\n  }\n};\n\nconst stopGeneration = () => {\n  if (is_summarizing.value || is_generating_table.value) {\n    is_summarizing.value = false;\n    is_generating_table.value = false;\n    saveGenerationStatus();\n    window.toastr.info(\'Â∑≤ÂÅúÊ≠¢ÊâÄÊúâÁîüÊàê‰ªªÂä°\');\n  }\n};\n\n// Ë°®Ê†ºÂàóÂ§¥Ê®°ÊùøÁÆ°ÁêÜ\nconst loadHeaderTemplates = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÂàóÂ§¥Ê®°Êùø\');\n      return;\n    }\n    const scriptVars = getVariables({ type: \'script\', script_id: scriptId });\n    // ÂÖºÂÆπ header_templates ÂèØËÉΩ‰∏∫ null„ÄÅundefined„ÄÅÂ≠óÁ¨¶‰∏≤Á≠âÁ±ªÂûã\n    let templates = scriptVars.header_templates;\n    // Â∞Ü null„ÄÅundefined Êàñ‰∏ç‰∏∫Êï∞ÁªÑÁöÑÊÉÖÂÜµÈÉΩÂΩí‰∏∫ []\n    if (!Array.isArray(templates)) {\n      templates = [];\n    }\n    headerTemplates.value = templates;\n    console.log(\'Â∑≤Âä†ËΩΩÂàóÂ§¥Ê®°Êùø:\', headerTemplates.value.length, \'‰∏™\');\n  } catch (error) {\n    console.error(\'Âä†ËΩΩÂàóÂ§¥Ê®°ÊùøÂ§±Ë¥•:\', error);\n    headerTemplates.value = [];\n  }\n};\n\nconst saveHeaderTemplates = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÂàóÂ§¥Ê®°Êùø\');\n      return;\n    }\n    insertOrAssignVariables({ header_templates: headerTemplates.value }, { type: \'script\', script_id: scriptId });\n    console.log(\'Â∑≤‰øùÂ≠òÂàóÂ§¥Ê®°Êùø\');\n  } catch (error) {\n    console.error(\'‰øùÂ≠òÂàóÂ§¥Ê®°ÊùøÂ§±Ë¥•:\', error);\n  }\n};\n\nconst loadTemplate = () => {\n  if (selectedTemplate.value !== \'\') {\n    const index = parseInt(selectedTemplate.value);\n    if (index >= 0 && index < headerTemplates.value.length) {\n      currentTemplate.value = { ...headerTemplates.value[index] };\n    }\n  }\n};\n\nconst showAddTemplateDialog = () => {\n  const name = window.prompt(\'ËØ∑ËæìÂÖ•Ê®°ÊùøÂêçÁß∞Ôºö\');\n  if (name && name.trim()) {\n    const headers = window.prompt(\'ËØ∑ËæìÂÖ•ÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâÔºö\');\n    if (headers && headers.trim()) {\n      headerTemplates.value.push({ name: name.trim(), headers: headers.trim() });\n      saveHeaderTemplates();\n      selectedTemplate.value = (headerTemplates.value.length - 1).toString();\n      loadTemplate();\n      window.toastr.success(\'Ê®°ÊùøÊ∑ªÂä†ÊàêÂäü\');\n    }\n  }\n};\n\nconst saveTemplate = () => {\n  if (selectedTemplate.value !== \'\' && currentTemplate.value.name.trim() && currentTemplate.value.headers.trim()) {\n    const index = parseInt(selectedTemplate.value);\n    if (index >= 0 && index < headerTemplates.value.length) {\n      headerTemplates.value[index] = { ...currentTemplate.value };\n      saveHeaderTemplates();\n      window.toastr.success(\'Ê®°Êùø‰øùÂ≠òÊàêÂäü\');\n    }\n  } else {\n    window.toastr.warning(\'ËØ∑Â°´ÂÜôÊ®°ÊùøÂêçÁß∞ÂíåÂàóÂ§¥\');\n  }\n};\n\nconst deleteTemplate = () => {\n  if (selectedTemplate.value !== \'\') {\n    if (confirm(\'Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Ê®°ÊùøÂêóÔºü\')) {\n      const index = parseInt(selectedTemplate.value);\n      if (index >= 0 && index < headerTemplates.value.length) {\n        headerTemplates.value.splice(index, 1);\n        saveHeaderTemplates();\n        selectedTemplate.value = \'\';\n        currentTemplate.value = { name: \'\', headers: \'\' };\n        window.toastr.success(\'Ê®°ÊùøÂà†Èô§ÊàêÂäü\');\n      }\n    }\n  }\n};\n\n// ‰ªéÈÖíÈ¶ÜÂèòÈáèÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ\nconst loadHiddenMessages = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ\');\n      return;\n    }\n    console.log(\'ËÑöÊú¨ID:\', scriptId);\n\n    const saved = getVariables({ type: \'script\', script_id: scriptId });\n    console.log(\'‰ªéÈÖíÈ¶ÜÂèòÈáèÂä†ËΩΩÁöÑÊï∞ÊçÆ:\', saved);\n    console.log(\'Ê£ÄÊü• hidden_messages Â≠óÊÆµ:\', saved?.hidden_messages);\n\n    if (saved && saved.hidden_messages) {\n      hidden_messages.value = saved.hidden_messages;\n      console.log(\'ÊàêÂäüÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ:\', hidden_messages.value.length, \'‰∏™\');\n    } else {\n      console.log(\'Ê≤°ÊúâÊâæÂà∞ÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÔºåÂ∞ùËØïÂÖ∂‰ªñÂ≠óÊÆµÂêç...\');\n      // Â∞ùËØïÂÖ∂‰ªñÂèØËÉΩÁöÑÂ≠óÊÆµÂêç\n      const possibleFields = [\'hiddenMessages\', \'hidden_floors\', \'hiddenFloors\', \'floor_data\'];\n      for (const field of possibleFields) {\n        if (saved && saved[field]) {\n          console.log(`ÊâæÂà∞Â≠óÊÆµ ${field}:`, saved[field]);\n          hidden_messages.value = saved[field];\n          break;\n        }\n      }\n    }\n  } catch (error) {\n    console.error(\'Âä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÂ§±Ë¥•:\', error);\n  }\n};\n\n// ‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÂà∞ÈÖíÈ¶ÜÂèòÈáè\nconst saveHiddenMessages = () => {\n  try {\n    const scriptId = getScriptIdSafe();\n    if (!scriptId) {\n      console.warn(\'script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ\');\n      return;\n    }\n    console.log(\'‰øùÂ≠òÂà∞ËÑöÊú¨ID:\', scriptId);\n    console.log(\'Ë¶Å‰øùÂ≠òÁöÑÊï∞ÊçÆ:\', hidden_messages.value);\n\n    const dataToSave = {\n      hidden_messages: hidden_messages.value,\n    };\n    console.log(\'ÂáÜÂ§á‰øùÂ≠òÁöÑÊï∞ÊçÆÂØπË±°:\', dataToSave);\n\n    insertOrAssignVariables(dataToSave, { type: \'script\', script_id: scriptId });\n    console.log(\'ÊàêÂäü‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ:\', hidden_messages.value.length, \'‰∏™\');\n\n    // È™åËØÅ‰øùÂ≠òÊòØÂê¶ÊàêÂäü\n    setTimeout(() => {\n      const saved = getVariables({ type: \'script\', script_id: scriptId });\n      console.log(\'È™åËØÅ‰øùÂ≠òÁªìÊûú:\', saved);\n      console.log(\'È™åËØÅ hidden_messages Â≠óÊÆµ:\', saved?.hidden_messages);\n    }, 100);\n  } catch (error) {\n    console.error(\'‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÂ§±Ë¥•:\', error);\n  }\n};\n\n// ÁªÑ‰ª∂ÊåÇËΩΩÊó∂Âä†ËΩΩÊï∞ÊçÆ\nonMounted(() => {\n  console.log(\'SettingsTab ÁªÑ‰ª∂Â∑≤ÊåÇËΩΩÔºåÂºÄÂßãÂä†ËΩΩÊï∞ÊçÆ\');\n  loadHiddenMessages();\n  loadHeaderTemplates();\n  loadGenerationStatus();\n});\n\n// ÊµãËØïÊåâÈíÆÂ§ÑÁêÜÂáΩÊï∞\nconst handleTestButton = () => {\n  console.log(\'ÂéüÁîüÁÇπÂáª - Vue‰∫ã‰ª∂ÁªëÂÆöÂ∑•‰ΩúÊ≠£Â∏∏\');\n  window.toastr.success(\'Vue‰∫ã‰ª∂ÁªëÂÆöÂ∑•‰ΩúÊ≠£Â∏∏ÔºÅ\');\n};\n\n// ËÆæÁΩÆÁÆ°ÁêÜÂáΩÊï∞\nconst handleSaveSettings = () => {\n  console.log(\'üíæ ÊâãÂä®‰øùÂ≠òËÆæÁΩÆ...\');\n  const success = settingsStore.saveSettings();\n  if (success) {\n    console.log(\'‚úÖ ËÆæÁΩÆ‰øùÂ≠òÊàêÂäü\');\n  } else {\n    console.error(\'‚ùå ËÆæÁΩÆ‰øùÂ≠òÂ§±Ë¥•\');\n  }\n};\n\nconst handleReloadSettings = () => {\n  console.log(\'üîÑ ÈáçÊñ∞Âä†ËΩΩËÆæÁΩÆ...\');\n  const success = settingsStore.reloadSettings();\n  if (success) {\n    console.log(\'‚úÖ ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÊàêÂäü\');\n  } else {\n    console.error(\'‚ùå ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÂ§±Ë¥•\');\n  }\n};\n\nconst handleResetAutoSummaryStart = () => {\n  console.log(\'üîÑ ÈáçÁΩÆËá™Âä®ÊÄªÁªìËµ∑ÂßãÊ•ºÂ±Ç...\');\n  try {\n    // Ë∞ÉÁî®ÂÖ®Â±ÄÂáΩÊï∞\n    if (typeof (window as any).resetAutoSummaryStart === \'function\') {\n      (window as any).resetAutoSummaryStart();\n    } else {\n      window.toastr.error(\'ÈáçÁΩÆÂáΩÊï∞‰∏çÂèØÁî®ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÂêéÈáçËØï\');\n    }\n  } catch (error) {\n    console.error(\'‚ùå ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÈáçÁΩÆÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\n// ÂÖ∂‰ªñÂ§ÑÁêÜÂáΩÊï∞ÔºàËøôÈáåÈúÄË¶Å‰ªéÂéüÁªÑ‰ª∂‰∏≠Â§çÂà∂Áõ∏Â∫îÁöÑÈÄªËæëÔºâ\nconst handle_fetch_models = async () => {\n  if (loading_models.value) return;\n\n  try {\n    loading_models.value = true;\n    console.log(\'ÂºÄÂßãÊãâÂèñÊ®°Âûã...\');\n\n    // È™åËØÅ API ÈÖçÁΩÆ\n    if (!settings.value.api_endpoint || !settings.value.api_key) {\n      window.toastr.warning(\'ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key\');\n      return;\n    }\n\n    // Ë∞ÉÁî®ÊãâÂèñÊ®°ÂûãÂáΩÊï∞\n    const { fetchAvailableModels } = await import(\'../ÊÄªÁªìÂäüËÉΩ\');\n    const models = await fetchAvailableModels();\n\n    console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ®°ÂûãÂàóË°®:\', models);\n\n    if (models.length > 0) {\n      // Êõ¥Êñ∞Ê®°ÂûãÂàóË°®\n      available_models.value = models;\n      window.toastr.success(`ÊàêÂäüËé∑Âèñ ${models.length} ‰∏™Ê®°Âûã`);\n\n      // Â¶ÇÊûúÊúâÊ®°ÂûãÔºåËá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™\n      if (!settings.value.model && models[0]) {\n        settings.value.model = models[0];\n      }\n    } else {\n      window.toastr.warning(\'Êú™ÊâæÂà∞ÂèØÁî®Ê®°Âûã\');\n    }\n  } catch (error) {\n    console.error(\'ÊãâÂèñÊ®°ÂûãÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÊãâÂèñÊ®°ÂûãÂ§±Ë¥•: \' + (error as Error).message);\n  } finally {\n    loading_models.value = false;\n  }\n};\n\nconst handle_test_connection = async () => {\n  try {\n    console.log(\'ÊµãËØïËøûÊé•...\');\n\n    // È™åËØÅ API ÈÖçÁΩÆ\n    if (!settings.value.api_endpoint || !settings.value.api_key) {\n      window.toastr.warning(\'ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key\');\n      return;\n    }\n\n    // ÁÆÄÂçïÁöÑËøûÊé•ÊµãËØï\n    const response = await fetch(settings.value.api_endpoint, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        Authorization: `Bearer ${settings.value.api_key}`,\n      },\n      body: JSON.stringify({\n        model: settings.value.model || \'gpt-3.5-turbo\',\n        messages: [{ role: \'user\', content: \'test\' }],\n        max_tokens: 1,\n      }),\n    });\n\n    if (response.ok) {\n      window.toastr.success(\'ËøûÊé•ÊµãËØïÊàêÂäüÔºÅ\');\n    } else {\n      window.toastr.error(\'ËøûÊé•ÊµãËØïÂ§±Ë¥•Ôºö\' + response.status);\n    }\n  } catch (error) {\n    console.error(\'ËøûÊé•ÊµãËØïÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ËøûÊé•ÊµãËØïÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\nconst handle_summarize = async () => {\n  try {\n    if (is_summarizing.value) return;\n\n    console.log(\'ÂºÄÂßãÊâãÂä®ÊÄªÁªì...\');\n    is_summarizing.value = true;\n    saveGenerationStatus();\n\n    // È™åËØÅ API ÈÖçÁΩÆ\n    if (!settings.value.api_endpoint || !settings.value.api_key) {\n      window.toastr.warning(\'ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key\');\n      return;\n    }\n\n    // Ëé∑ÂèñÂΩìÂâçËÅäÂ§©ÁöÑÊ∂àÊÅØ\n    let chatMessages;\n    try {\n      const lastMessageId = getLastMessageId();\n      console.log(\'ÊúÄÊñ∞Ê∂àÊÅØID:\', lastMessageId);\n      chatMessages = getChatMessages(`0-${lastMessageId}`, { hide_state: \'all\' });\n      console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:\', chatMessages.length);\n    } catch (error) {\n      console.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:\', error);\n      window.toastr.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: \' + (error as Error).message);\n      return;\n    }\n\n    if (!chatMessages || chatMessages.length === 0) {\n      window.toastr.warning(\'ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ\');\n      return;\n    }\n\n    // Ë∞ÉÁî®ÊÄªÁªìÂäüËÉΩ\n    const { summarizeMessages } = await import(\'../ÊÄªÁªìÂäüËÉΩ\');\n    const summary = await summarizeMessages(0, chatMessages.length);\n\n    console.log(\'ÊÄªÁªìÂÆåÊàê:\', summary);\n\n    // ‰øùÂ≠òÊÄªÁªìÁªìÊûúÂà∞ËÑöÊú¨ÂèòÈáè\n    const scriptId = getScriptIdSafe();\n    if (scriptId) {\n      insertOrAssignVariables({ last_summary: summary }, { type: \'script\', script_id: scriptId });\n    }\n\n    window.toastr.success(\'ÊÄªÁªìÂÆåÊàêÔºÅ\');\n  } catch (error) {\n    console.error(\'ÊÄªÁªìÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÊÄªÁªìÂ§±Ë¥•: \' + (error as Error).message);\n  } finally {\n    is_summarizing.value = false;\n    saveGenerationStatus();\n  }\n};\n\nconst handle_generate_table = async () => {\n  try {\n    if (is_generating_table.value) return;\n\n    console.log(\'ÂºÄÂßãÁîüÊàêË°®Ê†º...\');\n    is_generating_table.value = true;\n    saveGenerationStatus();\n\n    // È™åËØÅ API ÈÖçÁΩÆ\n    if (!settings.value.api_endpoint || !settings.value.api_key) {\n      window.toastr.warning(\'ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key\');\n      return;\n    }\n\n    // È™åËØÅË°®Ê†ºÂèÇÊï∞\n    if (!settings.value.table_start_message_id || !settings.value.table_end_message_id) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆÂºÄÂßãÊ•ºÂ±ÇÂíåÁªìÊùüÊ•ºÂ±Ç\');\n      return;\n    }\n\n    // ËÆ©Áî®Êà∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥Ôºà‰ºòÂÖà‰ΩøÁî®Ê®°ÊùøÔºâ\n    let headersInput: string | null = null;\n\n    if (currentTemplate.value.headers.trim()) {\n      // Â¶ÇÊûúÂΩìÂâçÊúâÈÄâ‰∏≠ÁöÑÊ®°ÊùøÔºåËØ¢ÈóÆÊòØÂê¶‰ΩøÁî®\n      const useTemplate = confirm(\n        `ÊòØÂê¶‰ΩøÁî®Ê®°Êùø"${currentTemplate.value.name}"ÁöÑÂàóÂ§¥Ôºü\\nÂàóÂ§¥Ôºö${currentTemplate.value.headers}`,\n      );\n      if (useTemplate) {\n        headersInput = currentTemplate.value.headers;\n      }\n    }\n\n    if (!headersInput) {\n      // Â¶ÇÊûúÊ≤°Êúâ‰ΩøÁî®Ê®°ÊùøÔºåËÆ©Áî®Êà∑ÊâãÂä®ËæìÂÖ•\n      headersInput = window.prompt(\'ËØ∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºöÊó∂Èó¥,‰∫ã‰ª∂,Âú∞ÁÇπ,‰∫∫Áâ©ÔºâÔºö\');\n    }\n\n    if (!headersInput || !headersInput.trim()) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆË°®Ê†ºÂàóÂ§¥\');\n      return;\n    }\n\n    const headers: string[] = headersInput\n      .split(\',\')\n      .map((h: string) => h.trim())\n      .filter((h: string) => h);\n\n    if (headers.length === 0) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆÊúâÊïàÁöÑË°®Ê†ºÂàóÂ§¥\');\n      return;\n    }\n\n    // Ëé∑ÂèñÊåáÂÆöËåÉÂõ¥ÁöÑÊ∂àÊÅØ\n    let chatMessages;\n    try {\n      const messageRange = `${settings.value.table_start_message_id}-${settings.value.table_end_message_id}`;\n      console.log(\'Ëé∑ÂèñÊ∂àÊÅØËåÉÂõ¥:\', messageRange);\n      chatMessages = getChatMessages(messageRange, { hide_state: \'all\' });\n      console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:\', chatMessages.length);\n    } catch (error) {\n      console.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:\', error);\n      window.toastr.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: \' + (error as Error).message);\n      return;\n    }\n\n    if (!chatMessages || chatMessages.length === 0) {\n      window.toastr.warning(\'ÊåáÂÆöËåÉÂõ¥ÂÜÖÊ≤°ÊúâÊ∂àÊÅØ\');\n      return;\n    }\n\n    // ÂáÜÂ§áAIËØ∑Ê±ÇÊï∞ÊçÆ\n    const messagesText = chatMessages\n      .map(msg => {\n        const role = msg.role === \'user\' ? \'Áî®Êà∑\' : \'AI\';\n        return `${role}: ${msg.message}`;\n      })\n      .join(\'\\n\\n\');\n\n    const aiPrompt = `ËØ∑Ê†πÊçÆ‰ª•‰∏ãËÅäÂ§©ÂÜÖÂÆπÔºåÁîüÊàêË°®Ê†ºÊï∞ÊçÆ„ÄÇË°®Ê†ºÂàóÂ§¥‰∏∫Ôºö${headers.join(\', \')}\n\nËÅäÂ§©ÂÜÖÂÆπÔºö\n${messagesText}\n\n**ÈáçË¶ÅË¶ÅÊ±Ç**Ôºö\n1. Ê†πÊçÆËÅäÂ§©ÂÜÖÂÆπÊèêÂèñÁõ∏ÂÖ≥‰ø°ÊÅØÂ°´ÂÖ•Ë°®Ê†º\n2. ‰∏•Ê†ºÊåâÁÖßÊèê‰æõÁöÑÂàóÂ§¥È°∫Â∫èÁîüÊàêÊï∞ÊçÆÔºö${headers.join(\', \')}\n3. ÊØèË°åÊï∞ÊçÆÂ∫îËØ•ÊòØÊúâÊÑè‰πâÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ\n4. Â¶ÇÊûúÊüê‰∏™Â≠óÊÆµÊ≤°ÊúâÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÂ°´ÂÜô"Êó†"Êàñ"-"\n5. ÂøÖÈ°ªËøîÂõûÁ∫ØJSONÊ†ºÂºèÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïmarkdownÊ†áËÆ∞ÊàñÂÖ∂‰ªñÊñáÂ≠óËØ¥Êòé\n6. Âè™ËøîÂõûdataÊï∞ÁªÑÂç≥ÂèØÔºåheadersÊàëÂ∑≤ÁªèÊúâ‰∫Ü\n\n**ËæìÂá∫Ê†ºÂºèÔºàÂè™ËøîÂõûËøô‰∏™JSONÔºå‰∏çË¶ÅÂÖ∂‰ªñÂÜÖÂÆπÔºâ**Ôºö\n{\n  "data": [\n    ["Êï∞ÊçÆ1", "Êï∞ÊçÆ2", "Êï∞ÊçÆ3"],\n    ["Êï∞ÊçÆ4", "Êï∞ÊçÆ5", "Êï∞ÊçÆ6"]\n  ]\n}\n\nÊ≥®ÊÑèÔºödataÊï∞ÁªÑ‰∏≠ÊØè‰∏™Â≠êÊï∞ÁªÑÁöÑÈïøÂ∫¶ÂøÖÈ°ªÁ≠â‰∫é${headers.length}ÔºåÂØπÂ∫îÂàóÂ§¥Ôºö${headers.join(\', \')}`;\n\n    console.log(\'ÂèëÈÄÅAIËØ∑Ê±Ç...\');\n    window.toastr.info(\'Ê≠£Âú®AIÂàÜÊûêËÅäÂ§©ÂÜÖÂÆπÂπ∂ÁîüÊàêË°®Ê†º...\');\n\n    // Ë∞ÉÁî®AIÁîüÊàêË°®Ê†º\n    const response = await fetch(settings.value.api_endpoint, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        Authorization: `Bearer ${settings.value.api_key}`,\n      },\n      body: JSON.stringify({\n        model: settings.value.model,\n        messages: [\n          {\n            role: \'user\',\n            content: aiPrompt,\n          },\n        ],\n        max_tokens: settings.value.max_tokens,\n        temperature: settings.value.temperature,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`APIËØ∑Ê±ÇÂ§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n\n    const result = await response.json();\n    console.log(\'AIÂìçÂ∫î:\', result);\n\n    if (!result.choices || !result.choices[0] || !result.choices[0].message) {\n      throw new Error(\'AIÂìçÂ∫îÊ†ºÂºèÈîôËØØ\');\n    }\n\n    const aiResponse = result.choices[0].message.content;\n    console.log(\'AIËøîÂõûÂÜÖÂÆπ:\', aiResponse);\n\n    // Ëß£ÊûêAIËøîÂõûÁöÑJSON\n    let aiTableData;\n    try {\n      // Â∞ùËØïÊèêÂèñJSONÈÉ®ÂàÜÔºàÁßªÈô§ÂèØËÉΩÁöÑmarkdown‰ª£Á†ÅÂùóÊ†áËÆ∞Ôºâ\n      let jsonText = aiResponse.trim();\n\n      // ÁßªÈô§markdown‰ª£Á†ÅÂùó\n      jsonText = jsonText\n        .replace(/^```json\\s*/i, \'\')\n        .replace(/^```\\s*/, \'\')\n        .replace(/```\\s*$/, \'\');\n\n      // ÊèêÂèñJSONÂØπË±°\n      const jsonMatch = jsonText.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        aiTableData = JSON.parse(jsonMatch[0]);\n      } else {\n        throw new Error(\'Êó†Ê≥ïÊâæÂà∞JSONÊ†ºÂºèÁöÑË°®Ê†ºÊï∞ÊçÆ\');\n      }\n    } catch (parseError) {\n      console.error(\'Ëß£ÊûêAIÂìçÂ∫îÂ§±Ë¥•:\', parseError);\n      console.log(\'AIÂéüÂßãÂìçÂ∫î:\', aiResponse);\n      window.toastr.error(\'AIËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºè‰∏çÊ≠£Á°ÆÔºåËØ∑ÈáçËØï\');\n      return;\n    }\n\n    // È™åËØÅË°®Ê†ºÊï∞ÊçÆ\n    if (!aiTableData.data || !Array.isArray(aiTableData.data)) {\n      window.toastr.error(\'AIËøîÂõûÁöÑË°®Ê†ºÊï∞ÊçÆÊ†ºÂºè‰∏çÊ≠£Á°ÆÔºöÁº∫Â∞ëdataÊï∞ÁªÑ\');\n      return;\n    }\n\n    // È™åËØÅÊØèË°åÊï∞ÊçÆÁöÑÂàóÊï∞ÊòØÂê¶Ê≠£Á°Æ\n    for (let i = 0; i < aiTableData.data.length; i++) {\n      if (!Array.isArray(aiTableData.data[i])) {\n        window.toastr.error(`Á¨¨${i + 1}Ë°åÊï∞ÊçÆÊ†ºÂºèÈîôËØØÔºö‰∏çÊòØÊï∞ÁªÑ`);\n        return;\n      }\n      if (aiTableData.data[i].length !== headers.length) {\n        window.toastr.error(`Á¨¨${i + 1}Ë°åÊï∞ÊçÆÂàóÊï∞‰∏çÂåπÈÖçÔºöÊúüÊúõ${headers.length}ÂàóÔºåÂÆûÈôÖ${aiTableData.data[i].length}Âàó`);\n        console.log(`ÊúüÊúõÂàóÂ§¥:`, headers);\n        console.log(`ÂÆûÈôÖÊï∞ÊçÆ:`, aiTableData.data[i]);\n        return;\n      }\n    }\n\n    // ÁªÑË£ÖÂÆåÊï¥ÁöÑË°®Ê†ºÊï∞ÊçÆÔºà‰ΩøÁî®Áî®Êà∑Êèê‰æõÁöÑheadersÔºâ\n    const tableData = {\n      headers: headers,\n      data: aiTableData.data,\n    };\n\n    // ‰øùÂ≠òË°®Ê†ºÂà∞ËÅäÂ§©ÂèòÈáè\n    const chat_id = getChatIdSafe();\n    if (chat_id) {\n      const chat_vars = getVariables({ type: \'chat\' });\n      const table_history = chat_vars.table_history || [];\n\n      table_history.push({\n        start_id: settings.value.table_start_message_id,\n        end_id: settings.value.table_end_message_id,\n        headers: tableData.headers,\n        data: tableData.data,\n      });\n\n      insertOrAssignVariables({ table_history }, { type: \'chat\' });\n\n      window.toastr.success(`Ë°®Ê†ºÁîüÊàêÊàêÂäüÔºÅÂÖ±${tableData.data.length}Ë°åÊï∞ÊçÆ`);\n      console.log(\'Ë°®Ê†ºÂ∑≤‰øùÂ≠òÂà∞ËÅäÂ§©ÂèòÈáè:\', table_history);\n    } else {\n      window.toastr.warning(\'Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåË°®Ê†ºÁîüÊàêÂ§±Ë¥•\');\n    }\n  } catch (error) {\n    console.error(\'ÁîüÊàêË°®Ê†ºÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÁîüÊàêË°®Ê†ºÂ§±Ë¥•: \' + (error as Error).message);\n  } finally {\n    is_generating_table.value = false;\n    saveGenerationStatus();\n  }\n};\n\nconst handle_create_table = () => {\n  try {\n    // È™åËØÅË°®Ê†ºÂèÇÊï∞\n    if (!settings.value.table_start_message_id || !settings.value.table_end_message_id) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆÂºÄÂßãÊ•ºÂ±ÇÂíåÁªìÊùüÊ•ºÂ±Ç\');\n      return;\n    }\n\n    // ËÆ©Áî®Êà∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥\n    const headersInput: string | null = window.prompt(\'ËØ∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºöÊó∂Èó¥,‰∫ã‰ª∂,Âú∞ÁÇπ,‰∫∫Áâ©ÔºâÔºö\');\n    if (!headersInput || !headersInput.trim()) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆË°®Ê†ºÂàóÂ§¥\');\n      return;\n    }\n\n    // Ëß£ÊûêÂàóÂ§¥\n    const headers: string[] = headersInput\n      .split(\',\')\n      .map((h: string) => h.trim())\n      .filter((h: string) => h);\n\n    if (headers.length === 0) {\n      window.toastr.warning(\'ËØ∑ËÆæÁΩÆÊúâÊïàÁöÑË°®Ê†ºÂàóÂ§¥\');\n      return;\n    }\n\n    // ÂàõÂª∫Á©∫Ë°®Ê†ºÊï∞ÊçÆ\n    const emptyTableData = {\n      start_id: settings.value.table_start_message_id,\n      end_id: settings.value.table_end_message_id,\n      headers: headers,\n      data: [], // Á©∫Êï∞ÊçÆÔºåÁî®Êà∑ÂèØ‰ª•ÊâãÂä®Â°´ÂÖÖ\n    };\n\n    // ‰øùÂ≠òË°®Ê†ºÂà∞ËÅäÂ§©ÂèòÈáè\n    const chat_id = getChatIdSafe();\n    if (chat_id) {\n      const chat_vars = getVariables({ type: \'chat\' });\n      const table_history = chat_vars.table_history || [];\n\n      table_history.push(emptyTableData);\n      insertOrAssignVariables({ table_history }, { type: \'chat\' });\n\n      window.toastr.success(`Á©∫Ë°®Ê†ºÂàõÂª∫ÊàêÂäüÔºÅÂàóÂ§¥Ôºö${headers.join(\', \')}`);\n      console.log(\'Á©∫Ë°®Ê†ºÂ∑≤‰øùÂ≠òÂà∞ËÅäÂ§©ÂèòÈáè:\', emptyTableData);\n    } else {\n      window.toastr.warning(\'Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåË°®Ê†ºÂàõÂª∫Â§±Ë¥•\');\n    }\n  } catch (error) {\n    console.error(\'ÂàõÂª∫Ë°®Ê†ºÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÂàõÂª∫Ë°®Ê†ºÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\nconst handle_hide_messages = async () => {\n  try {\n    console.log(\'ÈöêËóèÊ•ºÂ±Ç...\');\n\n    if (!hide_range.value.trim()) {\n      window.toastr.warning(\'ËØ∑ËæìÂÖ•Ë¶ÅÈöêËóèÁöÑÊ•ºÂ±ÇËåÉÂõ¥\');\n      return;\n    }\n\n    // Ëß£ÊûêÊ•ºÂ±ÇËåÉÂõ¥\n    const ranges = hide_range.value.split(\',\').map(range => range.trim());\n    const messageIds: number[] = [];\n\n    for (const range of ranges) {\n      if (range.includes(\'-\')) {\n        // ËåÉÂõ¥Ê†ºÂºèÔºö1-10\n        const [start, end] = range.split(\'-\').map(Number);\n        if (start && end && start <= end) {\n          for (let i = start; i <= end; i++) {\n            messageIds.push(i);\n          }\n        }\n      } else {\n        // Âçï‰∏™Ê•ºÂ±ÇÔºö5\n        const id = Number(range);\n        if (id) {\n          messageIds.push(id);\n        }\n      }\n    }\n\n    if (messageIds.length === 0) {\n      window.toastr.warning(\'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊ•ºÂ±ÇËåÉÂõ¥\');\n      return;\n    }\n\n    // Ëé∑ÂèñÂΩìÂâçËÅäÂ§©ÁöÑÊ∂àÊÅØ\n    let chatMessages;\n    try {\n      const lastMessageId = getLastMessageId();\n      console.log(\'ÊúÄÊñ∞Ê∂àÊÅØID:\', lastMessageId);\n      chatMessages = getChatMessages(`0-${lastMessageId}`, { hide_state: \'all\' });\n      console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:\', chatMessages.length);\n    } catch (error) {\n      console.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:\', error);\n      window.toastr.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: \' + (error as Error).message);\n      return;\n    }\n\n    if (!chatMessages || chatMessages.length === 0) {\n      window.toastr.warning(\'ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ\');\n      return;\n    }\n\n    // ÈöêËóèÊåáÂÆöÁöÑÊ•ºÂ±Ç\n    let hiddenCount = 0;\n    const messagesToHide = [];\n\n    for (const messageId of messageIds) {\n      const message = chatMessages.find(msg => msg.message_id === messageId);\n      if (message) {\n        // ÂáÜÂ§áË¶ÅÈöêËóèÁöÑÊ∂àÊÅØÊï∞ÊçÆ\n        messagesToHide.push({\n          message_id: messageId,\n          is_hidden: true,\n        });\n\n        // Ê∑ªÂä†Âà∞ÈöêËóèÂàóË°®\n        hidden_messages.value.push({\n          message_id: messageId,\n          name: message.name || \'Unknown\',\n          role: message.role || \'user\',\n          message: message.message || \'\',\n        });\n        hiddenCount++;\n      }\n    }\n\n    // Ë∞ÉÁî®ÈÖíÈ¶ÜAPIÁúüÊ≠£ÈöêËóèÊ•ºÂ±Ç\n    if (messagesToHide.length > 0) {\n      try {\n        console.log(\'ÂáÜÂ§áË∞ÉÁî® slash ÂëΩ‰ª§ÈöêËóèÊ•ºÂ±Ç:\', messageIds);\n\n        // ‰ΩøÁî® slash ÂëΩ‰ª§ÈöêËóèÊ•ºÂ±Ç\n        for (const messageId of messageIds) {\n          try {\n            await triggerSlash(`/hide ${messageId}`);\n            console.log(`ÊàêÂäüÈöêËóèÊ•ºÂ±Ç ${messageId}`);\n          } catch (error) {\n            console.error(`ÈöêËóèÊ•ºÂ±Ç ${messageId} Â§±Ë¥•:`, error);\n          }\n        }\n\n        window.toastr.success(\'Ê•ºÂ±ÇÂ∑≤ÁúüÊ≠£ÈöêËóè\');\n      } catch (error) {\n        console.error(\'Ë∞ÉÁî®ÈöêËóèAPIÂ§±Ë¥•:\', error);\n        window.toastr.error(\'ÈöêËóèÊ•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•: \' + (error as Error).message);\n      }\n    }\n\n    if (hiddenCount > 0) {\n      // ‰øùÂ≠òÂà∞ÈÖíÈ¶ÜÂèòÈáè\n      saveHiddenMessages();\n      window.toastr.success(`ÊàêÂäüÈöêËóè ${hiddenCount} ‰∏™Ê•ºÂ±Ç`);\n      hide_range.value = \'\'; // Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü\n    } else {\n      window.toastr.warning(\'Êú™ÊâæÂà∞Ë¶ÅÈöêËóèÁöÑÊ•ºÂ±Ç\');\n    }\n  } catch (error) {\n    console.error(\'ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\nconst handle_show_messages = async () => {\n  try {\n    console.log(\'ÊòæÁ§∫ÊåáÂÆöÊ•ºÂ±Ç...\');\n\n    if (!hide_range.value.trim()) {\n      window.toastr.warning(\'ËØ∑ËæìÂÖ•Ë¶ÅÊòæÁ§∫ÁöÑÊ•ºÂ±ÇËåÉÂõ¥\');\n      return;\n    }\n\n    // Ëß£ÊûêÊ•ºÂ±ÇËåÉÂõ¥\n    const messageIds = parseMessageRange(hide_range.value.trim());\n    if (messageIds.length === 0) {\n      window.toastr.warning(\'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊ•ºÂ±ÇËåÉÂõ¥\');\n      return;\n    }\n\n    // Ëé∑ÂèñÂΩìÂâçËÅäÂ§©ÁöÑÊ∂àÊÅØ\n    let chatMessages;\n    try {\n      const lastMessageId = getLastMessageId();\n      console.log(\'ÊúÄÊñ∞Ê∂àÊÅØID:\', lastMessageId);\n      chatMessages = getChatMessages(`0-${lastMessageId}`, { hide_state: \'all\' });\n      console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:\', chatMessages.length);\n    } catch (error) {\n      console.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:\', error);\n      window.toastr.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: \' + (error as Error).message);\n      return;\n    }\n\n    if (!chatMessages || chatMessages.length === 0) {\n      window.toastr.warning(\'ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ\');\n      return;\n    }\n\n    // ÂáÜÂ§áË¶ÅÊòæÁ§∫ÁöÑÊ∂àÊÅØÊï∞ÊçÆ\n    const messagesToShow = [];\n    let shownCount = 0;\n\n    for (const messageId of messageIds) {\n      const message = chatMessages.find(msg => msg.message_id === messageId);\n      if (message) {\n        messagesToShow.push({\n          message_id: messageId,\n          is_hidden: false,\n        });\n        shownCount++;\n      }\n    }\n\n    if (messagesToShow.length === 0) {\n      window.toastr.warning(\'Êú™ÊâæÂà∞Ë¶ÅÊòæÁ§∫ÁöÑÊ•ºÂ±Ç\');\n      return;\n    }\n\n    // Ë∞ÉÁî®ÈÖíÈ¶ÜAPIÁúüÊ≠£ÊòæÁ§∫Ê•ºÂ±Ç\n    try {\n      // ‰ΩøÁî® slash ÂëΩ‰ª§ÊòæÁ§∫Ê•ºÂ±Ç\n      for (const messageId of messageIds) {\n        try {\n          await triggerSlash(`/unhide ${messageId}`);\n          console.log(`ÊàêÂäüÊòæÁ§∫Ê•ºÂ±Ç ${messageId}`);\n        } catch (error) {\n          console.error(`ÊòæÁ§∫Ê•ºÂ±Ç ${messageId} Â§±Ë¥•:`, error);\n        }\n      }\n    } catch (error) {\n      console.error(\'Ë∞ÉÁî®ÊòæÁ§∫APIÂ§±Ë¥•:\', error);\n      window.toastr.error(\'ÊòæÁ§∫Ê•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•: \' + (error as Error).message);\n      return;\n    }\n\n    // ‰ªéÈöêËóèÂàóË°®‰∏≠ÁßªÈô§Â∑≤ÊòæÁ§∫ÁöÑÊ•ºÂ±Ç\n    hidden_messages.value = hidden_messages.value.filter(hiddenMsg => !messageIds.includes(hiddenMsg.message_id));\n\n    // ‰øùÂ≠òÂà∞ÈÖíÈ¶ÜÂèòÈáè\n    saveHiddenMessages();\n\n    window.toastr.success(`ÊàêÂäüÊòæÁ§∫ ${shownCount} ‰∏™Ê•ºÂ±Ç`);\n    hide_range.value = \'\'; // Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü\n  } catch (error) {\n    console.error(\'ÊòæÁ§∫Ê•ºÂ±ÇÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÊòæÁ§∫Ê•ºÂ±ÇÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n\nconst handle_refresh_hidden = async (showToast: boolean = false) => {\n  try {\n    console.log(\'Âà∑Êñ∞ÈöêËóèÊ•ºÂ±Ç\', showToast);\n\n    // ÂÖàÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÔºàÂ¶ÇÊûúËøòÊ≤°ÊúâÂä†ËΩΩÁöÑËØùÔºâ\n    if (hidden_messages.value.length === 0) {\n      console.log(\'ÈöêËóèÊ•ºÂ±ÇÂàóË°®‰∏∫Á©∫ÔºåÂÖàÂä†ËΩΩÊï∞ÊçÆ...\');\n      loadHiddenMessages();\n    }\n\n    // Ëé∑ÂèñÂΩìÂâçËÅäÂ§©ÁöÑÊ∂àÊÅØ\n    let chatMessages;\n    try {\n      const lastMessageId = getLastMessageId();\n      console.log(\'ÊúÄÊñ∞Ê∂àÊÅØID:\', lastMessageId);\n      chatMessages = getChatMessages(`0-${lastMessageId}`, { hide_state: \'all\' });\n      console.log(\'Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:\', chatMessages.length);\n    } catch (error) {\n      console.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:\', error);\n      if (showToast) {\n        window.toastr.error(\'Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: \' + (error as Error).message);\n      }\n      return;\n    }\n\n    if (!chatMessages || chatMessages.length === 0) {\n      if (showToast) {\n        window.toastr.warning(\'ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ\');\n      }\n      return;\n    }\n\n    // ÈáçÊñ∞È™åËØÅÈöêËóèÂàóË°®‰∏≠ÁöÑÊ•ºÂ±ÇÊòØÂê¶‰ªçÁÑ∂Â≠òÂú®\n    const validHiddenMessages = [];\n    let removedCount = 0;\n\n    for (const hiddenMsg of hidden_messages.value) {\n      const message = chatMessages.find(msg => msg.message_id === hiddenMsg.message_id);\n      if (message) {\n        // Êõ¥Êñ∞Ê∂àÊÅØÂÜÖÂÆπÔºàÂèØËÉΩÂ∑≤ÁªèÊîπÂèòÔºâ\n        validHiddenMessages.push({\n          message_id: hiddenMsg.message_id,\n          name: message.name || hiddenMsg.name,\n          role: message.role || hiddenMsg.role,\n          message: message.message || hiddenMsg.message,\n        });\n      } else {\n        // Ê•ºÂ±Ç‰∏çÂ≠òÂú®‰∫ÜÔºå‰ªéÈöêËóèÂàóË°®‰∏≠ÁßªÈô§\n        removedCount++;\n      }\n    }\n\n    // Êõ¥Êñ∞ÈöêËóèÂàóË°®\n    hidden_messages.value = validHiddenMessages;\n\n    // ‰øùÂ≠òÊõ¥Êñ∞ÂêéÁöÑÊï∞ÊçÆÂà∞ÈÖíÈ¶ÜÂèòÈáè\n    saveHiddenMessages();\n\n    if (showToast) {\n      if (removedCount > 0) {\n        window.toastr.success(`Âà∑Êñ∞ÂÆåÊàêÔºåÁßªÈô§‰∫Ü ${removedCount} ‰∏™‰∏çÂ≠òÂú®ÁöÑÊ•ºÂ±Ç`);\n      } else {\n        window.toastr.success(\'Âà∑Êñ∞ÂÆåÊàêÔºåÊâÄÊúâÈöêËóèÊ•ºÂ±Ç‰ªçÁÑ∂ÊúâÊïà\');\n      }\n    }\n\n    console.log(`Âà∑Êñ∞ÂÆåÊàêÔºö${validHiddenMessages.length} ‰∏™ÊúâÊïàÈöêËóèÊ•ºÂ±ÇÔºå${removedCount} ‰∏™Â∑≤ÁßªÈô§`);\n  } catch (error) {\n    console.error(\'Âà∑Êñ∞ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•:\', error);\n    if (showToast) {\n      window.toastr.error(\'Âà∑Êñ∞ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•: \' + (error as Error).message);\n    }\n  }\n};\n\nconst handle_unhide_single = async (messageId: number) => {\n  try {\n    console.log(\'ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±Ç\', messageId);\n\n    // Ê£ÄÊü•Ê•ºÂ±ÇÊòØÂê¶Âú®ÈöêËóèÂàóË°®‰∏≠\n    const index = hidden_messages.value.findIndex(msg => msg.message_id === messageId);\n    if (index === -1) {\n      window.toastr.warning(`Ê•ºÂ±Ç #${messageId} ‰∏çÂú®ÈöêËóèÂàóË°®‰∏≠`);\n      return;\n    }\n\n    // Ë∞ÉÁî®ÈÖíÈ¶ÜAPIÁúüÊ≠£ÊòæÁ§∫Ê•ºÂ±Ç\n    try {\n      // ‰ΩøÁî® slash ÂëΩ‰ª§ÊòæÁ§∫Ê•ºÂ±Ç\n      await triggerSlash(`/unhide ${messageId}`);\n      console.log(\'ÊàêÂäüÊòæÁ§∫Ê•ºÂ±Ç:\', messageId);\n    } catch (error) {\n      console.error(\'Ë∞ÉÁî®ÊòæÁ§∫APIÂ§±Ë¥•:\', error);\n      window.toastr.warning(\'ÊòæÁ§∫Ê•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•\');\n      return;\n    }\n\n    // ‰ªéÈöêËóèÂàóË°®‰∏≠ÁßªÈô§ÊåáÂÆöÁöÑÊ•ºÂ±Ç\n    hidden_messages.value.splice(index, 1);\n\n    // ‰øùÂ≠òÂà∞ÈÖíÈ¶ÜÂèòÈáè\n    saveHiddenMessages();\n\n    window.toastr.success(`Â∑≤ÊòæÁ§∫Ê•ºÂ±Ç #${messageId}`);\n  } catch (error) {\n    console.error(\'ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±ÇÂ§±Ë¥•:\', error);\n    window.toastr.error(\'ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±ÇÂ§±Ë¥•: \' + (error as Error).message);\n  }\n};\n<\/script>\n\n<style>\n.settings-tab {\n  height: 100%;\n  overflow-y: auto;\n  padding: 25px !important;\n  background: #1a1a1a !important;\n  border: 2px solid red !important;\n}\n\n.config-section {\n  padding: 20px 25px !important;\n  border-bottom: 1px solid #3a3a3a;\n  margin-bottom: 5px;\n}\n\n.config-section:last-child {\n  border-bottom: none;\n  margin-bottom: 0;\n}\n\n.config-section h3 {\n  margin: 0 0 20px 0 !important;\n  color: #fff;\n  font-size: 15px !important;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.form-group {\n  margin-bottom: 18px !important;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 6px;\n  color: #ccc;\n  font-size: 13px;\n}\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.flex-label {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.form-group input[type=\'text\'],\n.form-group input[type=\'password\'],\n.form-group input[type=\'number\'],\n.form-group select {\n  width: 100%;\n  padding: 10px 12px;\n  background: #2a2a2a;\n  border: 1px solid #3a3a3a;\n  border-radius: 6px;\n  color: #e0e0e0;\n  font-size: 13px;\n  transition: border-color 0.2s;\n}\n\n.form-group input:focus,\n.form-group select:focus {\n  outline: none;\n  border-color: #4a9eff;\n}\n\n.model-controls {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.button-group {\n  display: flex;\n  gap: 12px;\n  flex-wrap: wrap;\n  margin-top: 5px;\n}\n\n.action-button {\n  flex: 1;\n  min-width: 120px;\n  padding: 12px 16px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-weight: 500;\n  font-size: 13px;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  background: #3a3a3a;\n  color: #e0e0e0;\n  border: 1px solid #4a4a4a;\n}\n\n.action-button:hover {\n  background: #4a4a4a;\n  border-color: #5a5a5a;\n}\n\n.test-button {\n  background: #3a3a3a;\n  color: #e0e0e0;\n  border: 1px solid #4a4a4a;\n}\n\n.test-button:hover {\n  background: #4a4a4a;\n  border-color: #5a5a5a;\n}\n\n.fetch-button {\n  background: #4a9eff;\n  color: white;\n  border: 1px solid #5aaeff;\n}\n\n.fetch-button:hover {\n  background: #5aaeff;\n  border-color: #6abeff;\n}\n\n.summarize-button {\n  background: #4a9eff;\n  color: white;\n  border: 1px solid #5aaeff;\n}\n\n.summarize-button:hover {\n  background: #5aaeff;\n  border-color: #6abeff;\n}\n\n.create-button {\n  background: #51cf66;\n  color: white;\n  border: 1px solid #40c057;\n}\n\n.create-button:hover {\n  background: #40c057;\n  border-color: #37b24d;\n}\n\n.table-button {\n  background: #4a9eff;\n  color: white;\n  border: 1px solid #5aaeff;\n}\n\n.table-button:hover {\n  background: #5aaeff;\n  border-color: #6abeff;\n}\n\n.hide-button {\n  background: #ff6b6b;\n  color: white;\n  border: 1px solid #ff5252;\n}\n\n.hide-button:hover {\n  background: #ff5252;\n  border-color: #ff4444;\n}\n\n.unhide-button {\n  background: #51cf66;\n  color: white;\n  border: 1px solid #40c057;\n}\n\n.unhide-button:hover {\n  background: #40c057;\n  border-color: #37b24d;\n}\n\n.refresh-button {\n  background: #ffd43b;\n  color: #333;\n  border: 1px solid #ffcc02;\n}\n\n.refresh-button:hover {\n  background: #ffcc02;\n  border-color: #ffb700;\n}\n\n.action-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.model-select {\n  margin-top: 8px;\n}\n\n.hidden-messages-section {\n  margin-top: 20px;\n}\n\n.hidden-messages-list {\n  max-height: 300px;\n  overflow-y: auto;\n  border-radius: 6px;\n  border: 1px solid #3a3a3a;\n  background: #1a1a1a;\n}\n\n.hidden-message-item {\n  padding: 10px 12px;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  border-bottom: 1px solid #2a2a2a;\n  transition: background 0.2s;\n}\n\n.hidden-message-item:last-child {\n  border-bottom: none;\n}\n\n.hidden-message-item:hover {\n  background: #2a2a2a;\n}\n\n.message-info {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  flex: 1;\n}\n\n.message-id {\n  font-weight: bold;\n  color: #4a9eff;\n  font-size: 13px;\n  min-width: 50px;\n}\n\n.message-role {\n  font-size: 12px;\n  padding: 2px 8px;\n  border-radius: 4px;\n  white-space: nowrap;\n}\n\n.message-role.role-user {\n  background: #3a5a3a;\n  color: #90ee90;\n}\n\n.message-role.role-assistant {\n  background: #3a3a5a;\n  color: #90a0ee;\n}\n\n.message-role.role-system {\n  background: #5a5a3a;\n  color: #eea090;\n}\n\n.message-preview {\n  flex: 1;\n  color: #888;\n  font-size: 12px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.show-button {\n  background: #4a9eff !important;\n  color: white !important;\n  padding: 6px 12px;\n  border: 1px solid #5aaeff !important;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 12px;\n  transition: all 0.2s;\n  min-width: 60px;\n  text-align: center;\n}\n\n.show-button:hover {\n  background: #5aaeff !important;\n  border-color: #6abeff !important;\n}\n\n.mini-button {\n  background: #666;\n  color: white;\n  border: 1px solid #777;\n  padding: 6px 12px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 12px;\n  transition: all 0.2s;\n}\n\n.mini-button:hover {\n  background: #777;\n  border-color: #888;\n}\n\n.empty-state {\n  margin-top: 20px;\n  padding: 20px;\n  background: #2a2a2a;\n  border-radius: 6px;\n  text-align: center;\n  color: #888;\n  border: 1px solid #3a3a3a;\n}\n</style>\n'],sourceRoot:''}]);const i=s},603:(n,e,t)=>{var o=t(86);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[n.id,o,'']]),o.locals&&(n.exports=o.locals);(0,t(424).A)('3047f235',o,!1,{ssrId:!0})},608:()=>{$(()=>{setTimeout(()=>{let n=!1;const e=()=>{if(!n){n=!0;try{const t=['#top-bar','#top-settings-holder','#topBar','.topBar','#navbar','.navbar','header','.header','#header','.top_header','.navigation'];let o=$(),a='';for(const n of t){const e=$(n);if(e.length>0){o=e,a=n,console.log(`ÊâæÂà∞ÂØºËà™Ê†è: ${n}`);break}}if(0===o.length)return console.log('Êú™ÊâæÂà∞ÂØºËà™Ê†èÔºå500msÂêéÈáçËØï...'),void setTimeout(e,500);console.log(`‰ΩøÁî®ÂØºËà™Ê†è: ${a}`);const r=$('#memoryNavButton');r.length>0&&(console.log('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇÂØºËà™ÊåâÈíÆÂ∑≤Â≠òÂú®ÔºåÁßªÈô§ÂêéÈáçÊñ∞Ê∑ªÂä†'),r.remove());let s=o;if('#top-bar'===a){const n=$('#top-settings-holder');n.length>0&&(s=n,console.log('‰ΩøÁî® top-settings-holder ‰Ωú‰∏∫ÂÆπÂô®'))}const i=$('<div id="memoryNavButton" class="interactable" style="\n            padding: 8px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            cursor: pointer;\n            color: inherit;\n            border-radius: 4px;\n            transition: background 0.2s;\n            position: relative;\n          " title="mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇ">\n            <span style="font-size: 24px">üê±</span>\n          </div>');if(console.log('ÁõÆÊ†áÂÆπÂô®Á±ªÂûã:',s[0]?.id||'Êú™ÊåáÂÆö'),console.log('ÁõÆÊ†áÂÆπÂô®HTML:',s[0]?.outerHTML?.substring(0,300)),'top-settings-holder'===s[0]?.id){console.log('Ê∑ªÂä†Âà∞ top-settings-holder ÊúÄÂâçÈù¢');const n=s.children().first();n.length>0?i.insertBefore(n):s.prepend(i)}else console.log('Ê∑ªÂä†Âà∞ÂÆπÂô®ÂâçÈù¢'),s.prepend(i);i.on('click',function(n){n.preventDefault(),n.stopPropagation(),console.log('ÁÇπÂáªmzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇÂØºËà™ÊåâÈíÆ');const e=$('#memoryManagementPanel');e.length>0?e.is(':visible')?e.fadeOut(200):e.fadeIn(200):toastr.error('ÊµÆÂä®Èù¢ÊùøÊú™Âä†ËΩΩ')}),i.on('mouseenter',function(){$(this).css('background','rgba(255, 255, 255, 0.1)')}).on('mouseleave',function(){$(this).css('background','transparent')}),console.log('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇÂØºËà™ÊåâÈíÆÂ∑≤Ê∑ªÂä†Âà∞:',s[0]?.id||'ÂÆπÂô®'),console.log('ÊåâÈíÆ‰ΩçÁΩÆ:',i[0]?.parentElement?.children?.[0]?.className||'Â∑≤Ê∑ªÂä†'),console.log('ÊåâÈíÆÂÖÉÁ¥†:',i[0]),console.log('Èù¢ÊùøÂÆπÂô®ÈïøÂ∫¶:',$('#memoryManagementPanel').length),n=!1}catch(t){console.error('Ê∑ªÂä†ÂØºËà™ÊåâÈíÆÂ§±Ë¥•:',t),n=!1,setTimeout(e,500)}}};if(e(),setInterval(()=>{0!==$('#memoryNavButton').length||n||(console.log('Ê£ÄÊµãÂà∞ÊåâÈíÆÊ∂àÂ§±ÔºåÈáçÊñ∞Ê∑ªÂä†...'),e())},2e3),'function'==typeof eventOn)try{eventOn(tavern_events.CHAT_CHANGED,()=>{console.log('ËÅäÂ§©ÂèòÂåñÔºåÊ£ÄÊü•ÊåâÈíÆ...'),setTimeout(()=>{0!==$('#memoryNavButton').length||n||(console.log('ËÅäÂ§©ÂèòÂåñÂêéÊåâÈíÆÊ∂àÂ§±ÔºåÈáçÊñ∞Ê∑ªÂä†...'),e())},500)})}catch(n){console.log('Êó†Ê≥ïÁõëÂê¨‰∫ã‰ª∂:',n)}},300)})},707:n=>{if('undefined'==typeof z){var e=new Error('Cannot find module \'z\'');throw e.code='MODULE_NOT_FOUND',e}n.exports=z},790:n=>{n.exports=function(n){var e=n[1],t=n[3];if(!t)return e;if('function'==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),a='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(o),r='/*# '.concat(a,' */');return[e].concat([r]).join('\n')}return[e].join('\n')}},915:(n,e,t)=>{var o=t(254);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[n.id,o,'']]),o.locals&&(n.exports=o.locals);(0,t(424).A)('d1fca550',o,!1,{ssrId:!0})},942:(n,e,t)=>{var o=t(241);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[n.id,o,'']]),o.locals&&(n.exports=o.locals);(0,t(424).A)('32c597c2',o,!1,{ssrId:!0})}},a={};function r(n){var e=a[n];if(void 0!==e)return e.exports;var t=a[n]={id:n,exports:{}};return o[n](t,t.exports,r),t.exports}r.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return r.d(e,{a:e}),e},r.d=(n,e)=>{for(var t in e)r.o(e,t)&&!r.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},r.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r.r=n=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(n,'__esModule',{value:!0})};var s=r(61),i=r(557),l=r(193),d=r(440),c=r(35);const p={class:'settings-tab',style:{padding:'25px !important',background:'#1a1a1a !important'}},g={class:'config-section',style:{padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},u={class:'form-group',style:{'margin-bottom':'18px !important'}},m={class:'form-group',style:{'margin-bottom':'18px !important'}},x={class:'form-group'},b={class:'model-controls',style:{display:'flex','flex-direction':'column',gap:'10px'}},f={class:'button-group',style:{display:'flex',gap:'12px','flex-wrap':'wrap','margin-top':'5px'}},h=['disabled'],y=['value'],A={class:'form-group',style:{'margin-bottom':'18px !important'}},w={class:'form-group',style:{'margin-bottom':'18px !important'}},C={class:'config-section',style:{padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},v={class:'form-group',style:{'margin-bottom':'18px !important'}},k={class:'checkbox-label',style:{display:'flex','align-items':'center',gap:'8px',color:'#ccc','font-size':'13px'}},B={key:0,class:'form-group',style:{'margin-bottom':'18px !important'}},E={class:'config-section',style:{padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},T={class:'form-group',style:{'margin-bottom':'18px !important'}},I={class:'form-group',style:{'margin-bottom':'18px !important'}},S={class:'button-group',style:{display:'flex',gap:'12px','flex-wrap':'wrap','margin-top':'5px'}},N=['disabled'],V=['disabled'],D={key:0,class:'fa-solid fa-magic'},M={key:1,class:'fa-solid fa-spinner fa-spin'},F={class:'config-section',style:{padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},j={class:'form-group',style:{'margin-bottom':'18px !important'}},P={class:'form-group',style:{'margin-bottom':'18px !important'}},O={class:'form-group',style:{'margin-bottom':'18px !important'}},Y={style:{display:'flex',gap:'8px','margin-bottom':'8px'}},L=['value'],R={key:0,style:{display:'flex',gap:'8px'}},U={class:'form-group',style:{'margin-bottom':'18px !important'}},W={style:{display:'flex',gap:'12px','align-items':'center'}},q={style:{display:'flex','align-items':'center',gap:'6px'}},H={style:{display:'flex','align-items':'center',gap:'6px'}},G={key:0,style:{'margin-left':'auto'}},J={class:'button-group',style:{display:'flex',gap:'12px','flex-wrap':'wrap','margin-top':'5px'}},K=['disabled'],Z={key:0,class:'fa-solid fa-robot'},Q={key:1,class:'fa-solid fa-spinner fa-spin'},X={class:'config-section',style:{padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},nn={class:'form-group',style:{'margin-bottom':'18px !important'}},en={class:'button-group',style:{display:'flex',gap:'12px','flex-wrap':'wrap','margin-top':'5px'}},tn=['disabled'],on={key:0,class:'hidden-messages-section'},an={class:'form-group'},rn={class:'flex-label'},sn={key:0,class:'hidden-messages-list'},ln={class:'message-info'},dn={class:'message-id'},cn={class:'message-preview'},pn=['onClick'],gn={key:1,class:'empty-state'},un=(0,s.defineComponent)({__name:'SettingsTab',setup(n){const e=(0,i.C)(),{settings:t}=(0,c.storeToRefs)(e),o=(0,s.ref)([]),a=(0,s.ref)(!1),d=(0,s.ref)(''),un=(0,s.ref)([]),mn=(0,s.ref)(!1),xn=(0,s.ref)(!1),bn=(0,s.ref)(!1),fn=(0,s.ref)([]),hn=(0,s.ref)(''),yn=(0,s.ref)({name:'',headers:''}),An=()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅ');insertOrAssignVariables({is_summarizing:xn.value,is_generating_table:bn.value},{type:'script',script_id:n}),console.log('Â∑≤‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅ')}catch(n){console.error('‰øùÂ≠òÁîüÊàêÁä∂ÊÄÅÂ§±Ë¥•:',n)}},wn=()=>{(xn.value||bn.value)&&(xn.value=!1,bn.value=!1,An(),window.toastr.info('Â∑≤ÂÅúÊ≠¢ÊâÄÊúâÁîüÊàê‰ªªÂä°'))},Cn=()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÂàóÂ§¥Ê®°Êùø');insertOrAssignVariables({header_templates:fn.value},{type:'script',script_id:n}),console.log('Â∑≤‰øùÂ≠òÂàóÂ§¥Ê®°Êùø')}catch(n){console.error('‰øùÂ≠òÂàóÂ§¥Ê®°ÊùøÂ§±Ë¥•:',n)}},vn=()=>{if(''!==hn.value){const n=parseInt(hn.value);n>=0&&n<fn.value.length&&(yn.value={...fn.value[n]})}},kn=()=>{const n=window.prompt('ËØ∑ËæìÂÖ•Ê®°ÊùøÂêçÁß∞Ôºö');if(n&&n.trim()){const e=window.prompt('ËØ∑ËæìÂÖ•ÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâÔºö');e&&e.trim()&&(fn.value.push({name:n.trim(),headers:e.trim()}),Cn(),hn.value=(fn.value.length-1).toString(),vn(),window.toastr.success('Ê®°ÊùøÊ∑ªÂä†ÊàêÂäü'))}},Bn=()=>{if(''!==hn.value&&yn.value.name.trim()&&yn.value.headers.trim()){const n=parseInt(hn.value);n>=0&&n<fn.value.length&&(fn.value[n]={...yn.value},Cn(),window.toastr.success('Ê®°Êùø‰øùÂ≠òÊàêÂäü'))}else window.toastr.warning('ËØ∑Â°´ÂÜôÊ®°ÊùøÂêçÁß∞ÂíåÂàóÂ§¥')},_n=()=>{if(''!==hn.value&&confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Ê®°ÊùøÂêóÔºü')){const n=parseInt(hn.value);n>=0&&n<fn.value.length&&(fn.value.splice(n,1),Cn(),hn.value='',yn.value={name:'',headers:''},window.toastr.success('Ê®°ÊùøÂà†Èô§ÊàêÂäü'))}},En=()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ');console.log('ËÑöÊú¨ID:',n);const e=getVariables({type:'script',script_id:n});if(console.log('‰ªéÈÖíÈ¶ÜÂèòÈáèÂä†ËΩΩÁöÑÊï∞ÊçÆ:',e),console.log('Ê£ÄÊü• hidden_messages Â≠óÊÆµ:',e?.hidden_messages),e&&e.hidden_messages)un.value=e.hidden_messages,console.log('ÊàêÂäüÂä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ:',un.value.length,'‰∏™');else{console.log('Ê≤°ÊúâÊâæÂà∞ÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÔºåÂ∞ùËØïÂÖ∂‰ªñÂ≠óÊÆµÂêç...');const n=['hiddenMessages','hidden_floors','hiddenFloors','floor_data'];for(const t of n)if(e&&e[t]){console.log(`ÊâæÂà∞Â≠óÊÆµ ${t}:`,e[t]),un.value=e[t];break}}}catch(n){console.error('Âä†ËΩΩÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÂ§±Ë¥•:',n)}},zn=()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ');console.log('‰øùÂ≠òÂà∞ËÑöÊú¨ID:',n),console.log('Ë¶Å‰øùÂ≠òÁöÑÊï∞ÊçÆ:',un.value);const e={hidden_messages:un.value};console.log('ÂáÜÂ§á‰øùÂ≠òÁöÑÊï∞ÊçÆÂØπË±°:',e),insertOrAssignVariables(e,{type:'script',script_id:n}),console.log('ÊàêÂäü‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆ:',un.value.length,'‰∏™'),setTimeout(()=>{const e=getVariables({type:'script',script_id:n});console.log('È™åËØÅ‰øùÂ≠òÁªìÊûú:',e),console.log('È™åËØÅ hidden_messages Â≠óÊÆµ:',e?.hidden_messages)},100)}catch(n){console.error('‰øùÂ≠òÈöêËóèÊ•ºÂ±ÇÊï∞ÊçÆÂ§±Ë¥•:',n)}};(0,s.onMounted)(()=>{console.log('SettingsTab ÁªÑ‰ª∂Â∑≤ÊåÇËΩΩÔºåÂºÄÂßãÂä†ËΩΩÊï∞ÊçÆ'),En(),(()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÂàóÂ§¥Ê®°Êùø');let e=getVariables({type:'script',script_id:n}).header_templates;Array.isArray(e)||(e=[]),fn.value=e,console.log('Â∑≤Âä†ËΩΩÂàóÂ§¥Ê®°Êùø:',fn.value.length,'‰∏™')}catch(n){console.error('Âä†ËΩΩÂàóÂ§¥Ê®°ÊùøÂ§±Ë¥•:',n),fn.value=[]}})(),(()=>{try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÁîüÊàêÁä∂ÊÄÅ');const e=getVariables({type:'script',script_id:n});xn.value=e.is_summarizing||!1,bn.value=e.is_generating_table||!1,console.log('Â∑≤Âä†ËΩΩÁîüÊàêÁä∂ÊÄÅ:',{summarizing:xn.value,generating_table:bn.value})}catch(n){console.error('Âä†ËΩΩÁîüÊàêÁä∂ÊÄÅÂ§±Ë¥•:',n),xn.value=!1,bn.value=!1}})()});const Tn=()=>{console.log('ÂéüÁîüÁÇπÂáª - Vue‰∫ã‰ª∂ÁªëÂÆöÂ∑•‰ΩúÊ≠£Â∏∏'),window.toastr.success('Vue‰∫ã‰ª∂ÁªëÂÆöÂ∑•‰ΩúÊ≠£Â∏∏ÔºÅ')},In=()=>{console.log('üíæ ÊâãÂä®‰øùÂ≠òËÆæÁΩÆ...');e.saveSettings()?console.log('‚úÖ ËÆæÁΩÆ‰øùÂ≠òÊàêÂäü'):console.error('‚ùå ËÆæÁΩÆ‰øùÂ≠òÂ§±Ë¥•')},Sn=()=>{console.log('üîÑ ÈáçÊñ∞Âä†ËΩΩËÆæÁΩÆ...');e.reloadSettings()?console.log('‚úÖ ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÊàêÂäü'):console.error('‚ùå ËÆæÁΩÆÈáçÊñ∞Âä†ËΩΩÂ§±Ë¥•')},Nn=()=>{console.log('üîÑ ÈáçÁΩÆËá™Âä®ÊÄªÁªìËµ∑ÂßãÊ•ºÂ±Ç...');try{'function'==typeof window.resetAutoSummaryStart?window.resetAutoSummaryStart():window.toastr.error('ÈáçÁΩÆÂáΩÊï∞‰∏çÂèØÁî®ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÂêéÈáçËØï')}catch(n){console.error('‚ùå ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr.error('ÈáçÁΩÆÂ§±Ë¥•: '+n.message)}},Vn=async()=>{if(!a.value)try{if(a.value=!0,console.log('ÂºÄÂßãÊãâÂèñÊ®°Âûã...'),!t.value.api_endpoint||!t.value.api_key)return void window.toastr.warning('ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key');const{fetchAvailableModels:n}=await Promise.resolve().then(r.bind(r,440)),e=await n();console.log('Ëé∑ÂèñÂà∞ÁöÑÊ®°ÂûãÂàóË°®:',e),e.length>0?(o.value=e,window.toastr.success(`ÊàêÂäüËé∑Âèñ ${e.length} ‰∏™Ê®°Âûã`),!t.value.model&&e[0]&&(t.value.model=e[0])):window.toastr.warning('Êú™ÊâæÂà∞ÂèØÁî®Ê®°Âûã')}catch(n){console.error('ÊãâÂèñÊ®°ÂûãÂ§±Ë¥•:',n),window.toastr.error('ÊãâÂèñÊ®°ÂûãÂ§±Ë¥•: '+n.message)}finally{a.value=!1}},Dn=async()=>{try{if(console.log('ÊµãËØïËøûÊé•...'),!t.value.api_endpoint||!t.value.api_key)return void window.toastr.warning('ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key');const n=await fetch(t.value.api_endpoint,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${t.value.api_key}`},body:JSON.stringify({model:t.value.model||'gpt-3.5-turbo',messages:[{role:'user',content:'test'}],max_tokens:1})});n.ok?window.toastr.success('ËøûÊé•ÊµãËØïÊàêÂäüÔºÅ'):window.toastr.error('ËøûÊé•ÊµãËØïÂ§±Ë¥•Ôºö'+n.status)}catch(n){console.error('ËøûÊé•ÊµãËØïÂ§±Ë¥•:',n),window.toastr.error('ËøûÊé•ÊµãËØïÂ§±Ë¥•: '+n.message)}},$n=async()=>{try{if(xn.value)return;if(console.log('ÂºÄÂßãÊâãÂä®ÊÄªÁªì...'),xn.value=!0,An(),!t.value.api_endpoint||!t.value.api_key)return void window.toastr.warning('ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key');let n;try{const e=getLastMessageId();console.log('ÊúÄÊñ∞Ê∂àÊÅØID:',e),n=getChatMessages(`0-${e}`,{hide_state:'all'}),console.log('Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:',n.length)}catch(n){return console.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:',n),void window.toastr.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: '+n.message)}if(!n||0===n.length)return void window.toastr.warning('ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ');const{summarizeMessages:e}=await Promise.resolve().then(r.bind(r,440)),o=await e(0,n.length);console.log('ÊÄªÁªìÂÆåÊàê:',o);const a=(0,l.Ut)();a&&insertOrAssignVariables({last_summary:o},{type:'script',script_id:a}),window.toastr.success('ÊÄªÁªìÂÆåÊàêÔºÅ')}catch(n){console.error('ÊÄªÁªìÂ§±Ë¥•:',n),window.toastr.error('ÊÄªÁªìÂ§±Ë¥•: '+n.message)}finally{xn.value=!1,An()}},Mn=async()=>{try{if(bn.value)return;if(console.log('ÂºÄÂßãÁîüÊàêË°®Ê†º...'),bn.value=!0,An(),!t.value.api_endpoint||!t.value.api_key)return void window.toastr.warning('ËØ∑ÂÖàÈÖçÁΩÆ API Á´ØÁÇπÂíå API Key');if(!t.value.table_start_message_id||!t.value.table_end_message_id)return void window.toastr.warning('ËØ∑ËÆæÁΩÆÂºÄÂßãÊ•ºÂ±ÇÂíåÁªìÊùüÊ•ºÂ±Ç');let n=null;if(yn.value.headers.trim()){confirm(`ÊòØÂê¶‰ΩøÁî®Ê®°Êùø"${yn.value.name}"ÁöÑÂàóÂ§¥Ôºü\nÂàóÂ§¥Ôºö${yn.value.headers}`)&&(n=yn.value.headers)}if(n||(n=window.prompt('ËØ∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºöÊó∂Èó¥,‰∫ã‰ª∂,Âú∞ÁÇπ,‰∫∫Áâ©ÔºâÔºö')),!n||!n.trim())return void window.toastr.warning('ËØ∑ËÆæÁΩÆË°®Ê†ºÂàóÂ§¥');const e=n.split(',').map(n=>n.trim()).filter(n=>n);if(0===e.length)return void window.toastr.warning('ËØ∑ËÆæÁΩÆÊúâÊïàÁöÑË°®Ê†ºÂàóÂ§¥');let o;try{const n=`${t.value.table_start_message_id}-${t.value.table_end_message_id}`;console.log('Ëé∑ÂèñÊ∂àÊÅØËåÉÂõ¥:',n),o=getChatMessages(n,{hide_state:'all'}),console.log('Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:',o.length)}catch(n){return console.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:',n),void window.toastr.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: '+n.message)}if(!o||0===o.length)return void window.toastr.warning('ÊåáÂÆöËåÉÂõ¥ÂÜÖÊ≤°ÊúâÊ∂àÊÅØ');const a=o.map(n=>`${'user'===n.role?'Áî®Êà∑':'AI'}: ${n.message}`).join('\n\n'),r=`ËØ∑Ê†πÊçÆ‰ª•‰∏ãËÅäÂ§©ÂÜÖÂÆπÔºåÁîüÊàêË°®Ê†ºÊï∞ÊçÆ„ÄÇË°®Ê†ºÂàóÂ§¥‰∏∫Ôºö${e.join(', ')}\n\nËÅäÂ§©ÂÜÖÂÆπÔºö\n${a}\n\n**ÈáçË¶ÅË¶ÅÊ±Ç**Ôºö\n1. Ê†πÊçÆËÅäÂ§©ÂÜÖÂÆπÊèêÂèñÁõ∏ÂÖ≥‰ø°ÊÅØÂ°´ÂÖ•Ë°®Ê†º\n2. ‰∏•Ê†ºÊåâÁÖßÊèê‰æõÁöÑÂàóÂ§¥È°∫Â∫èÁîüÊàêÊï∞ÊçÆÔºö${e.join(', ')}\n3. ÊØèË°åÊï∞ÊçÆÂ∫îËØ•ÊòØÊúâÊÑè‰πâÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ\n4. Â¶ÇÊûúÊüê‰∏™Â≠óÊÆµÊ≤°ÊúâÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÂ°´ÂÜô"Êó†"Êàñ"-"\n5. ÂøÖÈ°ªËøîÂõûÁ∫ØJSONÊ†ºÂºèÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïmarkdownÊ†áËÆ∞ÊàñÂÖ∂‰ªñÊñáÂ≠óËØ¥Êòé\n6. Âè™ËøîÂõûdataÊï∞ÁªÑÂç≥ÂèØÔºåheadersÊàëÂ∑≤ÁªèÊúâ‰∫Ü\n\n**ËæìÂá∫Ê†ºÂºèÔºàÂè™ËøîÂõûËøô‰∏™JSONÔºå‰∏çË¶ÅÂÖ∂‰ªñÂÜÖÂÆπÔºâ**Ôºö\n{\n  "data": [\n    ["Êï∞ÊçÆ1", "Êï∞ÊçÆ2", "Êï∞ÊçÆ3"],\n    ["Êï∞ÊçÆ4", "Êï∞ÊçÆ5", "Êï∞ÊçÆ6"]\n  ]\n}\n\nÊ≥®ÊÑèÔºödataÊï∞ÁªÑ‰∏≠ÊØè‰∏™Â≠êÊï∞ÁªÑÁöÑÈïøÂ∫¶ÂøÖÈ°ªÁ≠â‰∫é${e.length}ÔºåÂØπÂ∫îÂàóÂ§¥Ôºö${e.join(', ')}`;console.log('ÂèëÈÄÅAIËØ∑Ê±Ç...'),window.toastr.info('Ê≠£Âú®AIÂàÜÊûêËÅäÂ§©ÂÜÖÂÆπÂπ∂ÁîüÊàêË°®Ê†º...');const s=await fetch(t.value.api_endpoint,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${t.value.api_key}`},body:JSON.stringify({model:t.value.model,messages:[{role:'user',content:r}],max_tokens:t.value.max_tokens,temperature:t.value.temperature})});if(!s.ok)throw new Error(`APIËØ∑Ê±ÇÂ§±Ë¥•: ${s.status} ${s.statusText}`);const i=await s.json();if(console.log('AIÂìçÂ∫î:',i),!i.choices||!i.choices[0]||!i.choices[0].message)throw new Error('AIÂìçÂ∫îÊ†ºÂºèÈîôËØØ');const d=i.choices[0].message.content;let c;console.log('AIËøîÂõûÂÜÖÂÆπ:',d);try{let n=d.trim();n=n.replace(/^```json\s*/i,'').replace(/^```\s*/,'').replace(/```\s*$/,'');const e=n.match(/\{[\s\S]*\}/);if(!e)throw new Error('Êó†Ê≥ïÊâæÂà∞JSONÊ†ºÂºèÁöÑË°®Ê†ºÊï∞ÊçÆ');c=JSON.parse(e[0])}catch(n){return console.error('Ëß£ÊûêAIÂìçÂ∫îÂ§±Ë¥•:',n),console.log('AIÂéüÂßãÂìçÂ∫î:',d),void window.toastr.error('AIËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºè‰∏çÊ≠£Á°ÆÔºåËØ∑ÈáçËØï')}if(!c.data||!Array.isArray(c.data))return void window.toastr.error('AIËøîÂõûÁöÑË°®Ê†ºÊï∞ÊçÆÊ†ºÂºè‰∏çÊ≠£Á°ÆÔºöÁº∫Â∞ëdataÊï∞ÁªÑ');for(let n=0;n<c.data.length;n++){if(!Array.isArray(c.data[n]))return void window.toastr.error(`Á¨¨${n+1}Ë°åÊï∞ÊçÆÊ†ºÂºèÈîôËØØÔºö‰∏çÊòØÊï∞ÁªÑ`);if(c.data[n].length!==e.length)return window.toastr.error(`Á¨¨${n+1}Ë°åÊï∞ÊçÆÂàóÊï∞‰∏çÂåπÈÖçÔºöÊúüÊúõ${e.length}ÂàóÔºåÂÆûÈôÖ${c.data[n].length}Âàó`),console.log('ÊúüÊúõÂàóÂ§¥:',e),void console.log('ÂÆûÈôÖÊï∞ÊçÆ:',c.data[n])}const p={headers:e,data:c.data};if((0,l.pA)()){const n=getVariables({type:'chat'}).table_history||[];n.push({start_id:t.value.table_start_message_id,end_id:t.value.table_end_message_id,headers:p.headers,data:p.data}),insertOrAssignVariables({table_history:n},{type:'chat'}),window.toastr.success(`Ë°®Ê†ºÁîüÊàêÊàêÂäüÔºÅÂÖ±${p.data.length}Ë°åÊï∞ÊçÆ`),console.log('Ë°®Ê†ºÂ∑≤‰øùÂ≠òÂà∞ËÅäÂ§©ÂèòÈáè:',n)}else window.toastr.warning('Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåË°®Ê†ºÁîüÊàêÂ§±Ë¥•')}catch(n){console.error('ÁîüÊàêË°®Ê†ºÂ§±Ë¥•:',n),window.toastr.error('ÁîüÊàêË°®Ê†ºÂ§±Ë¥•: '+n.message)}finally{bn.value=!1,An()}},Fn=()=>{try{if(!t.value.table_start_message_id||!t.value.table_end_message_id)return void window.toastr.warning('ËØ∑ËÆæÁΩÆÂºÄÂßãÊ•ºÂ±ÇÂíåÁªìÊùüÊ•ºÂ±Ç');const n=window.prompt('ËØ∑ËæìÂÖ•Ë°®Ê†ºÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºöÊó∂Èó¥,‰∫ã‰ª∂,Âú∞ÁÇπ,‰∫∫Áâ©ÔºâÔºö');if(!n||!n.trim())return void window.toastr.warning('ËØ∑ËÆæÁΩÆË°®Ê†ºÂàóÂ§¥');const e=n.split(',').map(n=>n.trim()).filter(n=>n);if(0===e.length)return void window.toastr.warning('ËØ∑ËÆæÁΩÆÊúâÊïàÁöÑË°®Ê†ºÂàóÂ§¥');const o={start_id:t.value.table_start_message_id,end_id:t.value.table_end_message_id,headers:e,data:[]};if((0,l.pA)()){const n=getVariables({type:'chat'}).table_history||[];n.push(o),insertOrAssignVariables({table_history:n},{type:'chat'}),window.toastr.success(`Á©∫Ë°®Ê†ºÂàõÂª∫ÊàêÂäüÔºÅÂàóÂ§¥Ôºö${e.join(', ')}`),console.log('Á©∫Ë°®Ê†ºÂ∑≤‰øùÂ≠òÂà∞ËÅäÂ§©ÂèòÈáè:',o)}else window.toastr.warning('Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåË°®Ê†ºÂàõÂª∫Â§±Ë¥•')}catch(n){console.error('ÂàõÂª∫Ë°®Ê†ºÂ§±Ë¥•:',n),window.toastr.error('ÂàõÂª∫Ë°®Ê†ºÂ§±Ë¥•: '+n.message)}},jn=async()=>{try{if(console.log('ÈöêËóèÊ•ºÂ±Ç...'),!d.value.trim())return void window.toastr.warning('ËØ∑ËæìÂÖ•Ë¶ÅÈöêËóèÁöÑÊ•ºÂ±ÇËåÉÂõ¥');const n=d.value.split(',').map(n=>n.trim()),e=[];for(const t of n)if(t.includes('-')){const[n,o]=t.split('-').map(Number);if(n&&o&&n<=o)for(let t=n;t<=o;t++)e.push(t)}else{const n=Number(t);n&&e.push(n)}if(0===e.length)return void window.toastr.warning('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊ•ºÂ±ÇËåÉÂõ¥');let t;try{const n=getLastMessageId();console.log('ÊúÄÊñ∞Ê∂àÊÅØID:',n),t=getChatMessages(`0-${n}`,{hide_state:'all'}),console.log('Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:',t.length)}catch(n){return console.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:',n),void window.toastr.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: '+n.message)}if(!t||0===t.length)return void window.toastr.warning('ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ');let o=0;const a=[];for(const n of e){const e=t.find(e=>e.message_id===n);e&&(a.push({message_id:n,is_hidden:!0}),un.value.push({message_id:n,name:e.name||'Unknown',role:e.role||'user',message:e.message||''}),o++)}if(a.length>0)try{console.log('ÂáÜÂ§áË∞ÉÁî® slash ÂëΩ‰ª§ÈöêËóèÊ•ºÂ±Ç:',e);for(const n of e)try{await triggerSlash(`/hide ${n}`),console.log(`ÊàêÂäüÈöêËóèÊ•ºÂ±Ç ${n}`)}catch(e){console.error(`ÈöêËóèÊ•ºÂ±Ç ${n} Â§±Ë¥•:`,e)}window.toastr.success('Ê•ºÂ±ÇÂ∑≤ÁúüÊ≠£ÈöêËóè')}catch(n){console.error('Ë∞ÉÁî®ÈöêËóèAPIÂ§±Ë¥•:',n),window.toastr.error('ÈöêËóèÊ•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•: '+n.message)}o>0?(zn(),window.toastr.success(`ÊàêÂäüÈöêËóè ${o} ‰∏™Ê•ºÂ±Ç`),d.value=''):window.toastr.warning('Êú™ÊâæÂà∞Ë¶ÅÈöêËóèÁöÑÊ•ºÂ±Ç')}catch(n){console.error('ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr.error('ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•: '+n.message)}},Pn=async()=>{try{if(console.log('ÊòæÁ§∫ÊåáÂÆöÊ•ºÂ±Ç...'),!d.value.trim())return void window.toastr.warning('ËØ∑ËæìÂÖ•Ë¶ÅÊòæÁ§∫ÁöÑÊ•ºÂ±ÇËåÉÂõ¥');const n=(n=>{if(!n.trim())return[];const e=[],t=n.split(',');for(const n of t){const t=n.trim();if(t)if(t.includes('-')){const[n,o]=t.split('-').map(n=>parseInt(n.trim()));if(!isNaN(n)&&!isNaN(o)&&n>=0&&o>=0)for(let t=n;t<=o;t++)e.push(t)}else{const n=parseInt(t);!isNaN(n)&&n>=0&&e.push(n)}}return e})(d.value.trim());if(0===n.length)return void window.toastr.warning('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊ•ºÂ±ÇËåÉÂõ¥');let e;try{const n=getLastMessageId();console.log('ÊúÄÊñ∞Ê∂àÊÅØID:',n),e=getChatMessages(`0-${n}`,{hide_state:'all'}),console.log('Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:',e.length)}catch(n){return console.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:',n),void window.toastr.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: '+n.message)}if(!e||0===e.length)return void window.toastr.warning('ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ');const t=[];let o=0;for(const a of n){e.find(n=>n.message_id===a)&&(t.push({message_id:a,is_hidden:!1}),o++)}if(0===t.length)return void window.toastr.warning('Êú™ÊâæÂà∞Ë¶ÅÊòæÁ§∫ÁöÑÊ•ºÂ±Ç');try{for(const e of n)try{await triggerSlash(`/unhide ${e}`),console.log(`ÊàêÂäüÊòæÁ§∫Ê•ºÂ±Ç ${e}`)}catch(n){console.error(`ÊòæÁ§∫Ê•ºÂ±Ç ${e} Â§±Ë¥•:`,n)}}catch(n){return console.error('Ë∞ÉÁî®ÊòæÁ§∫APIÂ§±Ë¥•:',n),void window.toastr.error('ÊòæÁ§∫Ê•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•: '+n.message)}un.value=un.value.filter(e=>!n.includes(e.message_id)),zn(),window.toastr.success(`ÊàêÂäüÊòæÁ§∫ ${o} ‰∏™Ê•ºÂ±Ç`),d.value=''}catch(n){console.error('ÊòæÁ§∫Ê•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr.error('ÊòæÁ§∫Ê•ºÂ±ÇÂ§±Ë¥•: '+n.message)}};return(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',p,[(0,s.createCommentVNode)(' API ÈÖçÁΩÆ '),(0,s.createElementVNode)('div',g,[e[23]||(e[23]=(0,s.createElementVNode)('h3',{style:{margin:'0 0 20px 0 !important',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' üîß API ÈÖçÁΩÆ ',-1)),(0,s.createElementVNode)('div',u,[e[18]||(e[18]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'API Á´ØÁÇπ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[0]||(e[0]=n=>(0,s.unref)(t).api_endpoint=n),type:'text',placeholder:'https://your-api.com/v1/chat/completions',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).api_endpoint]])]),(0,s.createElementVNode)('div',m,[e[19]||(e[19]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'API Key',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[1]||(e[1]=n=>(0,s.unref)(t).api_key=n),type:'password',placeholder:'sk-...',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).api_key]])]),(0,s.createElementVNode)('div',x,[(0,s.createElementVNode)('div',b,[e[20]||(e[20]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'Ê®°ÂûãÂêçÁß∞',-1)),(0,s.createElementVNode)('div',f,[(0,s.createElementVNode)('button',{class:'test-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #4a4a4a','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#3a3a3a',color:'#e0e0e0'},onClick:Tn},' ÊµãËØïÊåâÈíÆ(ÂéüÁîü) '),(0,s.createElementVNode)('button',{disabled:a.value,class:'fetch-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #5aaeff','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#4a9eff',color:'white'},onClick:Vn},(0,s.toDisplayString)(a.value?'ÊãâÂèñ‰∏≠...':'ÊãâÂèñÊ®°Âûã'),9,h)])]),0===o.value.length?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)('input',{key:0,'onUpdate:modelValue':e[2]||(e[2]=n=>(0,s.unref)(t).model=n),type:'text',placeholder:'gpt-4o-mini',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512)),[[s.vModelText,(0,s.unref)(t).model]]):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)('select',{key:1,'onUpdate:modelValue':e[3]||(e[3]=n=>(0,s.unref)(t).model=n),class:'model-select',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.value,n=>((0,s.openBlock)(),(0,s.createElementBlock)('option',{key:n,value:n},(0,s.toDisplayString)(n),9,y))),128))],512)),[[s.vModelSelect,(0,s.unref)(t).model]])]),(0,s.createElementVNode)('div',A,[e[21]||(e[21]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÊúÄÂ§ß Token Êï∞ÔºàÂª∫ËÆÆ4000‰ª•‰∏äËé∑ÂæóÊõ¥ËØ¶ÁªÜÁöÑÊÄªÁªìÔºâ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[4]||(e[4]=n=>(0,s.unref)(t).max_tokens=n),type:'number',min:'100',max:'16000',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).max_tokens,void 0,{number:!0}]])]),(0,s.createElementVNode)('div',w,[e[22]||(e[22]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'Ê∏©Â∫¶ (0-2)',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[5]||(e[5]=n=>(0,s.unref)(t).temperature=n),type:'number',min:'0',max:'2',step:'0.1',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).temperature,void 0,{number:!0}]])])]),(0,s.createCommentVNode)(' Ëá™Âä®ÊÄªÁªì '),(0,s.createElementVNode)('div',C,[e[26]||(e[26]=(0,s.createElementVNode)('h3',{style:{margin:'0 0 20px 0 !important',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' ‚ö° Ëá™Âä®ÊÄªÁªì ',-1)),(0,s.createElementVNode)('div',v,[(0,s.createElementVNode)('label',k,[(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[6]||(e[6]=n=>(0,s.unref)(t).auto_summarize_enabled=n),type:'checkbox',style:{width:'16px',height:'16px'}},null,512),[[s.vModelCheckbox,(0,s.unref)(t).auto_summarize_enabled]]),e[24]||(e[24]=(0,s.createTextVNode)(' ÂêØÁî®Ëá™Âä®ÊÄªÁªì ',-1))])]),(0,s.unref)(t).auto_summarize_enabled?((0,s.openBlock)(),(0,s.createElementBlock)('div',B,[e[25]||(e[25]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÊØèÂ§öÂ∞ëÊ•ºÂ±ÇÊÄªÁªì‰∏ÄÊ¨°',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[7]||(e[7]=n=>(0,s.unref)(t).summarize_interval=n),type:'number',min:'1',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).summarize_interval,void 0,{number:!0}]]),(0,s.createElementVNode)('div',{style:{'margin-top':'10px',display:'flex',gap:'10px'}},[(0,s.createElementVNode)('button',{style:{padding:'8px 16px',background:'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',border:'none','border-radius':'6px',color:'white','font-size':'12px',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 2px 4px rgba(0, 0, 0, 0.2)'},onmouseover:'this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'',onmouseout:'this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'',onClick:In},' üíæ ‰øùÂ≠òËÆæÁΩÆ '),(0,s.createElementVNode)('button',{style:{padding:'8px 16px',background:'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',border:'none','border-radius':'6px',color:'white','font-size':'12px',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 2px 4px rgba(0, 0, 0, 0.2)'},onmouseover:'this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'',onmouseout:'this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'',onClick:Sn},' üîÑ ÈáçÊñ∞Âä†ËΩΩ '),(0,s.createElementVNode)('button',{style:{padding:'8px 16px',background:'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',border:'none','border-radius':'6px',color:'white','font-size':'12px',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 2px 4px rgba(0, 0, 0, 0.2)'},onmouseover:'this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.3)\'',onmouseout:'this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.2)\'',onClick:Nn},' üîÑ ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç ')])])):(0,s.createCommentVNode)('v-if',!0)]),(0,s.createCommentVNode)(' ÊâãÂä®ÊÄªÁªì '),(0,s.createElementVNode)('div',E,[e[30]||(e[30]=(0,s.createElementVNode)('h3',{style:{margin:'0 0 20px 0 !important',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' ‚úçÔ∏è ÊâãÂä®ÊÄªÁªì ',-1)),(0,s.createElementVNode)('div',T,[e[27]||(e[27]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÂºÄÂßãÊ•ºÂ±Ç',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[8]||(e[8]=n=>(0,s.unref)(t).start_message_id=n),type:'number',min:'0',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).start_message_id,void 0,{number:!0}]])]),(0,s.createElementVNode)('div',I,[e[28]||(e[28]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÁªìÊùüÊ•ºÂ±Ç',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[9]||(e[9]=n=>(0,s.unref)(t).end_message_id=n),type:'number',min:'0',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).end_message_id,void 0,{number:!0}]])]),(0,s.createElementVNode)('div',S,[(0,s.createElementVNode)('button',{class:'action-button test-button',disabled:xn.value,style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #4a4a4a','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#3a3a3a',color:'#e0e0e0'},onClick:Dn},[...e[29]||(e[29]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-plug'},null,-1),(0,s.createTextVNode)(' ÊµãËØïËøûÊé• ',-1)])],8,N),(0,s.createElementVNode)('button',{class:'action-button summarize-button',disabled:xn.value||!(0,s.unref)(t).api_key,style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #5aaeff','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#4a9eff',color:'white'},onClick:$n},[xn.value?((0,s.openBlock)(),(0,s.createElementBlock)('i',M)):((0,s.openBlock)(),(0,s.createElementBlock)('i',D)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(xn.value?'Ê≠£Âú®ÊÄªÁªì...':'ÊâãÂä®ÊÄªÁªì'),1)],8,V)])]),(0,s.createCommentVNode)(' Ë°®Ê†ºÁîüÊàê '),(0,s.createElementVNode)('div',F,[e[43]||(e[43]=(0,s.createElementVNode)('h3',{style:{margin:'0 0 20px 0 !important',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' üìä Ë°®Ê†ºÁîüÊàê ',-1)),(0,s.createElementVNode)('div',j,[e[31]||(e[31]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÂºÄÂßãÊ•ºÂ±Ç',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[10]||(e[10]=n=>(0,s.unref)(t).table_start_message_id=n),type:'number',min:'0',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).table_start_message_id,void 0,{number:!0}]])]),(0,s.createElementVNode)('div',P,[e[32]||(e[32]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÁªìÊùüÊ•ºÂ±Ç',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[11]||(e[11]=n=>(0,s.unref)(t).table_end_message_id=n),type:'number',min:'0',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,(0,s.unref)(t).table_end_message_id,void 0,{number:!0}]])]),(0,s.createElementVNode)('div',O,[e[37]||(e[37]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'Ë°®Ê†ºÂàóÂ§¥Ê®°Êùø',-1)),(0,s.createElementVNode)('div',Y,[(0,s.withDirectives)((0,s.createElementVNode)('select',{'onUpdate:modelValue':e[12]||(e[12]=n=>hn.value=n),style:{flex:'1',padding:'8px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px'},onChange:vn},[e[33]||(e[33]=(0,s.createElementVNode)('option',{value:''},'ÈÄâÊã©Ê®°Êùø...',-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(fn.value,(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('option',{key:e,value:e},(0,s.toDisplayString)(n.name),9,L))),128))],544),[[s.vModelSelect,hn.value]]),(0,s.createElementVNode)('button',{style:{padding:'8px 12px',background:'#4a9eff',border:'none','border-radius':'6px',color:'white',cursor:'pointer','font-size':'12px','white-space':'nowrap'},onClick:kn},[...e[34]||(e[34]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,s.createTextVNode)(' Ê∑ªÂä† ',-1)])])]),''!==hn.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',R,[(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[13]||(e[13]=n=>yn.value.name=n),type:'text',placeholder:'Ê®°ÊùøÂêçÁß∞',style:{flex:'1',padding:'8px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px'}},null,512),[[s.vModelText,yn.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[14]||(e[14]=n=>yn.value.headers=n),type:'text',placeholder:'ÂàóÂ§¥ÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ',style:{flex:'2',padding:'8px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px'}},null,512),[[s.vModelText,yn.value.headers]]),(0,s.createElementVNode)('button',{style:{padding:'8px 12px',background:'#28a745',border:'none','border-radius':'6px',color:'white',cursor:'pointer','font-size':'12px','white-space':'nowrap'},onClick:Bn},[...e[35]||(e[35]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-save'},null,-1),(0,s.createTextVNode)(' ‰øùÂ≠ò ',-1)])]),(0,s.createElementVNode)('button',{style:{padding:'8px 12px',background:'#dc3545',border:'none','border-radius':'6px',color:'white',cursor:'pointer','font-size':'12px','white-space':'nowrap'},onClick:_n},[...e[36]||(e[36]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1),(0,s.createTextVNode)(' Âà†Èô§ ',-1)])])])):(0,s.createCommentVNode)('v-if',!0)]),(0,s.createCommentVNode)(' ÁîüÊàêÁä∂ÊÄÅÊòæÁ§∫ '),(0,s.createElementVNode)('div',U,[e[41]||(e[41]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÁîüÊàêÁä∂ÊÄÅ',-1)),(0,s.createElementVNode)('div',W,[(0,s.createElementVNode)('div',q,[(0,s.createElementVNode)('div',{style:(0,s.normalizeStyle)({width:'8px',height:'8px',borderRadius:'50%',backgroundColor:xn.value?'#ff6b6b':'#4caf50',transition:'background-color 0.3s'})},null,4),e[38]||(e[38]=(0,s.createElementVNode)('span',{style:{color:'#ccc','font-size':'12px'}},'ÊÄªÁªìÁîüÊàê',-1))]),(0,s.createElementVNode)('div',H,[(0,s.createElementVNode)('div',{style:(0,s.normalizeStyle)({width:'8px',height:'8px',borderRadius:'50%',backgroundColor:bn.value?'#ff6b6b':'#4caf50',transition:'background-color 0.3s'})},null,4),e[39]||(e[39]=(0,s.createElementVNode)('span',{style:{color:'#ccc','font-size':'12px'}},'Ë°®Ê†ºÁîüÊàê',-1))]),xn.value||bn.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',G,[(0,s.createElementVNode)('button',{style:{padding:'4px 8px',background:'#dc3545',border:'none','border-radius':'4px',color:'white',cursor:'pointer','font-size':'11px'},onClick:wn},[...e[40]||(e[40]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-stop'},null,-1),(0,s.createTextVNode)(' ÂÅúÊ≠¢ÁîüÊàê ',-1)])])])):(0,s.createCommentVNode)('v-if',!0)])]),(0,s.createElementVNode)('div',J,[(0,s.createElementVNode)('button',{class:'action-button summarize-button',disabled:bn.value||!(0,s.unref)(t).api_key,style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #5aaeff','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#4a9eff',color:'white'},onClick:Mn},[bn.value?((0,s.openBlock)(),(0,s.createElementBlock)('i',Q)):((0,s.openBlock)(),(0,s.createElementBlock)('i',Z)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(bn.value?'AIÂ°´ÂÖÖ‰∏≠...':'AIÂ°´ÂÖÖË°®Ê†º'),1)],8,K),(0,s.createElementVNode)('button',{class:'action-button create-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #40c057','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#51cf66',color:'white'},onClick:Fn},[...e[42]||(e[42]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,s.createTextVNode)(' ÂàõÂª∫Á©∫Ë°®Ê†º ',-1)])])])]),(0,s.createCommentVNode)(' Ê•ºÂ±ÇÁÆ°ÁêÜ '),(0,s.createElementVNode)('div',X,[e[48]||(e[48]=(0,s.createElementVNode)('h3',{style:{margin:'0 0 20px 0 !important',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' üîß Ê•ºÂ±ÇÁÆ°ÁêÜ ',-1)),(0,s.createElementVNode)('div',nn,[e[44]||(e[44]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'6px',color:'#ccc','font-size':'13px'}},'ÈöêËóèÊ•ºÂ±ÇËåÉÂõ¥ÔºàÂ¶ÇÔºö1-10 ÊàñÂçï‰∏™Ê•ºÂ±ÇÂ¶ÇÔºö5Ôºâ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':e[15]||(e[15]=n=>d.value=n),type:'text',placeholder:'1-10',style:{width:'100%',padding:'10px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',transition:'border-color 0.2s'}},null,512),[[s.vModelText,d.value]])]),(0,s.createElementVNode)('div',en,[(0,s.createElementVNode)('button',{class:'action-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #ff5252','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#ff6b6b',color:'white'},onClick:jn},[...e[45]||(e[45]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-eye-slash'},null,-1),(0,s.createTextVNode)(' ÈöêËóèÊ•ºÂ±Ç ',-1)])]),(0,s.createElementVNode)('button',{class:'action-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #40c057','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#51cf66',color:'white'},disabled:!d.value.trim(),onClick:Pn},[...e[46]||(e[46]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-eye'},null,-1),(0,s.createTextVNode)(' ÊòæÁ§∫Ê•ºÂ±Ç ',-1)])],8,tn),(0,s.createElementVNode)('button',{class:'action-button',style:{flex:'1','min-width':'120px',padding:'12px 16px',border:'1px solid #ffcc02','border-radius':'6px',cursor:'pointer','font-weight':'500','font-size':'13px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px',background:'#ffd43b',color:'#333'},onClick:e[16]||(e[16]=()=>(async(n=!1)=>{try{let e;console.log('Âà∑Êñ∞ÈöêËóèÊ•ºÂ±Ç',n),0===un.value.length&&(console.log('ÈöêËóèÊ•ºÂ±ÇÂàóË°®‰∏∫Á©∫ÔºåÂÖàÂä†ËΩΩÊï∞ÊçÆ...'),En());try{const n=getLastMessageId();console.log('ÊúÄÊñ∞Ê∂àÊÅØID:',n),e=getChatMessages(`0-${n}`,{hide_state:'all'}),console.log('Ëé∑ÂèñÂà∞ÁöÑÊ∂àÊÅØÊï∞Èáè:',e.length)}catch(e){return console.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•:',e),void(n&&window.toastr.error('Ëé∑ÂèñËÅäÂ§©Ê∂àÊÅØÂ§±Ë¥•: '+e.message))}if(!e||0===e.length)return void(n&&window.toastr.warning('ÂΩìÂâçËÅäÂ§©Ê≤°ÊúâÊ∂àÊÅØ'));const t=[];let o=0;for(const n of un.value){const a=e.find(e=>e.message_id===n.message_id);a?t.push({message_id:n.message_id,name:a.name||n.name,role:a.role||n.role,message:a.message||n.message}):o++}un.value=t,zn(),n&&(o>0?window.toastr.success(`Âà∑Êñ∞ÂÆåÊàêÔºåÁßªÈô§‰∫Ü ${o} ‰∏™‰∏çÂ≠òÂú®ÁöÑÊ•ºÂ±Ç`):window.toastr.success('Âà∑Êñ∞ÂÆåÊàêÔºåÊâÄÊúâÈöêËóèÊ•ºÂ±Ç‰ªçÁÑ∂ÊúâÊïà')),console.log(`Âà∑Êñ∞ÂÆåÊàêÔºö${t.length} ‰∏™ÊúâÊïàÈöêËóèÊ•ºÂ±ÇÔºå${o} ‰∏™Â∑≤ÁßªÈô§`)}catch(e){console.error('Âà∑Êñ∞ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•:',e),n&&window.toastr.error('Âà∑Êñ∞ÈöêËóèÊ•ºÂ±ÇÂ§±Ë¥•: '+e.message)}})(!0))},[...e[47]||(e[47]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-refresh'},null,-1),(0,s.createTextVNode)(' Âà∑Êñ∞ ',-1)])])]),(0,s.createCommentVNode)(' ÊòæÁ§∫ÈöêËóèÁöÑÊ•ºÂ±ÇÂàóË°® '),un.value.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('div',on,[(0,s.createElementVNode)('div',an,[(0,s.createElementVNode)('label',rn,[(0,s.createElementVNode)('span',null,'Â∑≤ÈöêËóèÁöÑÊ•ºÂ±Ç ('+(0,s.toDisplayString)(un.value.length)+' ‰∏™)',1),(0,s.createElementVNode)('button',{class:'mini-button',onClick:e[17]||(e[17]=n=>mn.value=!mn.value)},(0,s.toDisplayString)(mn.value?'Êî∂Ëµ∑':'Â±ïÂºÄ'),1)])]),mn.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',sn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(un.value,n=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:n.message_id,class:'hidden-message-item'},[(0,s.createElementVNode)('div',ln,[(0,s.createElementVNode)('span',dn,'#'+(0,s.toDisplayString)(n.message_id),1),(0,s.createElementVNode)('span',{class:(0,s.normalizeClass)(['message-role','role-'+n.role])},(0,s.toDisplayString)('user'===n.role?'üë§':'assistant'===n.role?'ü§ñ':'‚öôÔ∏è')+' '+(0,s.toDisplayString)(n.name),3),(0,s.createElementVNode)('span',cn,(0,s.toDisplayString)(n.message.substring(0,50))+(0,s.toDisplayString)(n.message.length>50?'...':''),1)]),(0,s.createElementVNode)('button',{class:'show-button',onClick:()=>(async n=>{try{console.log('ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±Ç',n);const e=un.value.findIndex(e=>e.message_id===n);if(-1===e)return void window.toastr.warning(`Ê•ºÂ±Ç #${n} ‰∏çÂú®ÈöêËóèÂàóË°®‰∏≠`);try{await triggerSlash(`/unhide ${n}`),console.log('ÊàêÂäüÊòæÁ§∫Ê•ºÂ±Ç:',n)}catch(n){return console.error('Ë∞ÉÁî®ÊòæÁ§∫APIÂ§±Ë¥•:',n),void window.toastr.warning('ÊòæÁ§∫Ê•ºÂ±ÇAPIË∞ÉÁî®Â§±Ë¥•')}un.value.splice(e,1),zn(),window.toastr.success(`Â∑≤ÊòæÁ§∫Ê•ºÂ±Ç #${n}`)}catch(n){console.error('ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr.error('ÊòæÁ§∫Âçï‰∏™Ê•ºÂ±ÇÂ§±Ë¥•: '+n.message)}})(n.message_id)},'ÊòæÁ§∫',8,pn)]))),128))])):(0,s.createCommentVNode)('v-if',!0)])):((0,s.openBlock)(),(0,s.createElementBlock)('div',gn,'ÊöÇÊó†ÈöêËóèÁöÑÊ•ºÂ±Ç'))])]))}});r(493);const mn=un,xn={class:'summary-tab',style:{padding:'25px !important',background:'#1a1a1a !important'}},bn={class:'section-header',style:{display:'flex','justify-content':'space-between','align-items':'center',padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},fn={class:'header-actions',style:{display:'flex','align-items':'center',gap:'10px'}},hn={key:0,class:'count-badge',style:{background:'#4a9eff',color:'white',padding:'4px 8px','border-radius':'12px','font-size':'12px'}},yn={key:0,class:'history-list',style:{display:'flex','flex-direction':'column',gap:'15px','margin-top':'20px'}},An=['onClick'],wn={class:'history-info',style:{display:'flex','align-items':'center',gap:'10px',flex:'1'}},Cn={class:'history-number',style:{color:'#4a9eff','font-weight':'bold'}},vn={class:'history-range',style:{color:'#888','font-size':'12px'}},kn={class:'expand-icon',style:{color:'#888','font-size':'12px'}},Bn={key:0,class:'history-content',style:{padding:'15px',background:'#2a2a2a','border-radius':'0 0 6px 6px'}},_n={class:'history-actions',style:{display:'flex',gap:'8px','margin-bottom':'12px','padding-bottom':'8px','border-bottom':'1px solid #3a3a3a'}},En=['onClick'],zn=['onClick'],Tn=['onClick'],In={class:'history-text',style:{'font-family':'\'Courier New\', monospace','font-size':'13px','line-height':'1.6',color:'#e0e0e0','white-space':'pre-wrap','word-wrap':'break-word','user-select':'text',cursor:'text'}},Sn={key:1,class:'empty-state',style:{'text-align':'center',padding:'40px 20px',color:'#888'}},Nn=(0,s.defineComponent)({__name:'SummaryTab',setup(n){const e=(0,i.l)(),t=(0,s.ref)([]),o=(0,s.ref)(new Map),a=()=>{try{t.value=e.getSummaryHistory(),console.log('Â∑≤Âà∑Êñ∞ÊÄªÁªìÂéÜÂè≤ÔºåÂΩìÂâçËÅäÂ§©ËÆ∞ÂΩïÊï∞:',t.value.length)}catch(n){console.error('Âà∑Êñ∞ÊÄªÁªìÂéÜÂè≤Â§±Ë¥•:',n),t.value=[]}},r=n=>o.value.get(n)||!1,d=async()=>{console.log('Âà∑Êñ∞Êï∞ÊçÆÊåâÈíÆË¢´ÁÇπÂáª');try{await a(),window.toastr.success('Êï∞ÊçÆÂ∑≤Âà∑Êñ∞')}catch(n){console.error('Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•:',n),window.toastr.error('Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•: '+n.message)}},c=async n=>new Promise(e=>{try{const t=window.parent.document,o=window.parent.document.body,a=t.createElement('textarea');a.value=n,a.style.cssText='\n        position: fixed;\n        left: -9999px;\n        top: -9999px;\n        opacity: 0;\n        pointer-events: none;\n        z-index: -1000;\n      ',a.setAttribute('readonly',''),o.appendChild(a),a.focus(),a.select(),a.setSelectionRange(0,n.length);const r=t.execCommand('copy');o.removeChild(a),e(r)}catch(n){console.error('Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•:',n),e(!1)}}),p=async n=>new Promise(e=>{try{const t=document.createElement('textarea');t.value=n,t.style.position='fixed',t.style.left='-9999px',t.style.top='-9999px',t.style.opacity='0',t.style.pointerEvents='none',t.setAttribute('readonly',''),document.body.appendChild(t),t.select(),t.setSelectionRange(0,n.length);const o=document.execCommand('copy');document.body.removeChild(t),e(o)}catch(n){console.error('execCommand Â§çÂà∂Â§±Ë¥•:',n),e(!1)}}),g=n=>{console.log('ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåÊñáÊú¨ÈïøÂ∫¶:',n.length);try{const e=window.parent.document,t=window.parent.document.body,o=e.getElementById('manual-copy-overlay');o&&t.removeChild(o);const a=e.createElement('div');a.id='manual-copy-overlay',a.style.cssText='\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    ';const r=e.createElement('div');r.style.cssText='\n      background: #2a2a2a;\n      border: 2px solid #4a9eff;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 900px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    ';const s=e.createElement('div');s.innerHTML='\n      <h3 style="margin: 0 0 15px 0; color: #4a9eff; text-align: center; font-size: 18px; font-weight: 600;">\n        üìã ÊâãÂä®Â§çÂà∂ÊÄªÁªìÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Êìç‰ΩúÊ≠•È™§Ôºö</strong>\n        </p>\n        <ol style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°Ü</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+A</kbd> ÂÖ®ÈÄâÊñáÊú¨</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+C</kbd> Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø</li>\n          <li>ÁÇπÂáª"ÂÖ≥Èó≠"ÊåâÈíÆÊàñÊåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Esc</kbd> ÂÖ≥Èó≠ÂØπËØùÊ°Ü</li>\n        </ol>\n      </div>\n    ';const i=e.createElement('textarea');i.value=n,i.style.cssText='\n      width: 100%;\n      height: 400px;\n      background: #1a1a1a;\n      border: 2px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      color: #e0e0e0;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 13px;\n      line-height: 1.5;\n      resize: vertical;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      outline: none;\n      margin-bottom: 20px;\n      box-sizing: border-box;\n    ';const l=e.createElement('div');l.style.cssText='\n      display: flex;\n      gap: 12px;\n      justify-content: center;\n      align-items: center;\n    ';const d=e.createElement('button');d.textContent='ÂÖ≥Èó≠',d.style.cssText='\n      background: #4a9eff;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    ',d.onmouseover=()=>{d.style.background='#5ba8ff'},d.onmouseout=()=>{d.style.background='#4a9eff'};const c=e.createElement('button');c.textContent='Â∞ùËØïËá™Âä®Â§çÂà∂',c.style.cssText='\n      background: #28a745;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    ',c.onmouseover=()=>{c.style.background='#218838'},c.onmouseout=()=>{c.style.background='#28a745'},l.appendChild(c),l.appendChild(d),r.appendChild(s),r.appendChild(i),r.appendChild(l),a.appendChild(r),t.appendChild(a),d.onclick=()=>{console.log('ÂÖ≥Èó≠ÊåâÈíÆË¢´ÁÇπÂáª'),t.removeChild(a)},c.onclick=async()=>{console.log('Â∞ùËØïËá™Âä®Â§çÂà∂ÊåâÈíÆË¢´ÁÇπÂáª');try{i.focus(),i.select();document.execCommand('copy')?(window.toastr.success('Ëá™Âä®Â§çÂà∂ÊàêÂäüÔºÅ'),t.removeChild(a)):window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂')}catch(n){console.error('Ëá™Âä®Â§çÂà∂Â§±Ë¥•:',n),window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂')}},a.onclick=n=>{n.target===a&&(console.log('ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠'),t.removeChild(a))};const p=n=>{'Escape'===n.key&&(console.log('ÊåâESCÈîÆÂÖ≥Èó≠'),t.removeChild(a),e.removeEventListener('keydown',p))};e.addEventListener('keydown',p),setTimeout(()=>{console.log('Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨'),i.focus(),i.select()},200),window.toastr.info('ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ∑≤ÊâìÂºÄÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú')}catch(n){console.error('ÂàõÂª∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:',n),window.toastr.error('Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê')}},u=n=>{(async(n,e='ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')=>{console.log('ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:',n.length);try{if(window.parent&&window.parent!==window&&(console.log('Ê£ÄÊµãÂà∞iframeÁéØÂ¢ÉÔºåÂ∞ùËØïÂú®Áà∂Á™óÂè£Â§çÂà∂'),await c(n)))return console.log('Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);if(navigator.clipboard&&window.isSecureContext){console.log('‰ΩøÁî®Áé∞‰ª£ Clipboard API');try{return await navigator.clipboard.writeText(n),console.log('Clipboard API Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e)}catch(n){console.warn('Clipboard API Â§±Ë¥•:',n)}}if(console.log('‰ΩøÁî® execCommand ÊñπÊ≥ï'),await p(n))return console.log('execCommand Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);console.log('ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢'),g(n)}catch(e){console.error('Â§çÂà∂ÂºÇÂ∏∏:',e),g(n)}})(n,'ÊÄªÁªìÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')},m=async()=>{try{let n='Êú™Áü•ËßíËâ≤';try{const e=getCharData('current');e&&e.name&&(n=e.name,n=n.replace(/[<>:"/\\|?*]/g,'_').trim())}catch(n){console.warn('Ëé∑ÂèñËßíËâ≤‰ø°ÊÅØÂ§±Ë¥•:',n)}const e=`ÊÄªÁªì_${n}_${(new Date).toISOString().slice(0,10)}`;console.log('ÂáÜÂ§áÂàõÂª∫‰∏ñÁïå‰π¶:',e);if(getWorldbookNames().includes(e))return void window.toastr.warning(`‰∏ñÁïå‰π¶ "${e}" Â∑≤Â≠òÂú®`);await createWorldbook(e,[]);try{await rebindChatWorldbook('current',e),window.toastr.success(`Â∑≤ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶ "${e}" Âπ∂ÁªëÂÆöÂà∞ÂΩìÂâçËÅäÂ§©`)}catch(n){console.warn('ÁªëÂÆöÂà∞ËÅäÂ§©Â§±Ë¥•:',n),window.toastr.success(`Â∑≤ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶ "${e}"ÔºåËØ∑ÊâãÂä®Âú®ËÅäÂ§©Áü•ËØÜ‰π¶‰∏≠ÁªëÂÆö`)}}catch(n){console.error('ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶Â§±Ë¥•:',n),window.toastr.error('ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶Â§±Ë¥•: '+n.message)}},x=async n=>new Promise(e=>{const t=$(`\n      <div style="\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        background: #2a2a2a;\n        border: 1px solid #3a3a3a;\n        border-radius: 8px;\n        padding: 20px;\n        z-index: 1000000;\n        min-width: 300px;\n      ">\n        <h3 style="margin: 0 0 15px 0; color: #e0e0e0;">ÈÄâÊã©‰∏ñÁïå‰π¶</h3>\n        <div style="margin-bottom: 15px;">\n          ${n.map(n=>`\n            <label style="display: block; margin: 5px 0; color: #e0e0e0;">\n              <input type="radio" name="worldbook" value="${n}" style="margin-right: 8px;">\n              ${n}\n            </label>\n          `).join('')}\n        </div>\n        <div style="text-align: right;">\n          <button id="cancelWorldbook" style="\n            background: #666;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            margin-right: 10px;\n            cursor: pointer;\n          ">ÂèñÊ∂à</button>\n          <button id="confirmWorldbook" style="\n            background: #4a9eff;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n          ">Á°ÆÂÆö</button>\n        </div>\n      </div>\n    `),o=$('\n      <div style="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 999999;\n      "></div>\n    ');$('body').append(o).append(t),$('#cancelWorldbook').on('click',()=>{o.remove(),t.remove(),e(null)}),$('#confirmWorldbook').on('click',()=>{const n=$('input[name="worldbook"]:checked').val();o.remove(),t.remove(),e(n||null)}),$('input[name="worldbook"]:first').prop('checked',!0)}),b=()=>{try{const n=window.parent.document,e=window.parent.document.body,t=n.getElementById('debug-panel-overlay');t&&e.removeChild(t);const o=n.createElement('div');o.id='debug-panel-overlay',o.style.cssText='\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    ';const a=n.createElement('div');a.style.cssText='\n      background: #2a2a2a;\n      border: 2px solid #ffc107;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 800px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    ';const r=n.createElement('div');r.innerHTML='\n      <h3 style="margin: 0 0 15px 0; color: #ffc107; text-align: center; font-size: 18px; font-weight: 600;">\n        üêõ Ëá™Âä®ÊÄªÁªìË∞ÉËØïÂ∑•ÂÖ∑\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Ë∞ÉËØïÂäüËÉΩÔºö</strong>\n        </p>\n        <ul style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÊµãËØïËá™Âä®ÊÄªÁªìÊµÅÁ®ã</li>\n          <li>ÂêåÊ≠•localStorageÊï∞ÊçÆÂà∞ÈÖíÈ¶ÜÂä©ÊâãÂèòÈáè</li>\n          <li>Ê£ÄÊü•ÂΩìÂâçÊ•ºÂ±ÇÁä∂ÊÄÅ</li>\n          <li>È™åËØÅËß¶ÂèëÊù°‰ª∂ËÆ°ÁÆó</li>\n        </ul>\n      </div>\n    ';const s=n.createElement('div');s.style.cssText='\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 12px;\n      margin-bottom: 20px;\n    ';[{id:'testComplete',text:'üß™ ÊµãËØïÂÆåÊï¥ÊµÅÁ®ã',color:'#4a9eff'},{id:'syncData',text:'üîÑ ÂêåÊ≠•Êï∞ÊçÆ',color:'#28a745'},{id:'checkFloor',text:'üîç Ê£ÄÊü•Ê•ºÂ±Ç',color:'#17a2b8'},{id:'testCalculation',text:'üßÆ È™åËØÅËÆ°ÁÆó',color:'#6f42c1'},{id:'showStatus',text:'üìä ÊòæÁ§∫Áä∂ÊÄÅ',color:'#fd7e14'},{id:'resetStartId',text:'üîÑ ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç',color:'#dc3545'}].forEach(e=>{const t=n.createElement('button');t.id=e.id,t.textContent=e.text,t.style.cssText=`\n        background: ${e.color};\n        color: white;\n        border: none;\n        padding: 12px 16px;\n        border-radius: 6px;\n        cursor: pointer;\n        font-size: 13px;\n        font-weight: 500;\n        transition: background 0.2s;\n      `,t.onmouseover=()=>{t.style.opacity='0.8'},t.onmouseout=()=>{t.style.opacity='1'},s.appendChild(t)});const i=n.createElement('div');i.id='debug-output',i.style.cssText='\n      background: #1a1a1a;\n      border: 1px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      height: 200px;\n      overflow-y: auto;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 12px;\n      color: #e0e0e0;\n      white-space: pre-wrap;\n      margin-bottom: 20px;\n    ',i.textContent='ÁÇπÂáª‰∏äÊñπÊåâÈíÆÂºÄÂßãË∞ÉËØï...\n';const l=n.createElement('button');l.textContent='ÂÖ≥Èó≠',l.style.cssText='\n      background: #6c757d;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n      align-self: center;\n    ',a.appendChild(r),a.appendChild(s),a.appendChild(i),a.appendChild(l),o.appendChild(a),e.appendChild(o);const d=e=>{const t=n.getElementById('debug-output');t&&(t.textContent+=e+'\n',t.scrollTop=t.scrollHeight)};l.onclick=()=>{e.removeChild(o)},n.getElementById('testComplete')?.addEventListener('click',()=>{d('üß™ ÂºÄÂßãÊµãËØïÂÆåÊï¥Ëá™Âä®ÊÄªÁªìÊµÅÁ®ã...');try{window.testCompleteAutoSummary?(window.testCompleteAutoSummary(),d('‚úÖ ÊµãËØïÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå ÊµãËØïÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå ÊµãËØïÂ§±Ë¥•: '+n.message)}}),n.getElementById('syncData')?.addEventListener('click',()=>{d('üîÑ ÂºÄÂßãÂêåÊ≠•Êï∞ÊçÆ...');try{window.syncAutoSummaryData?(window.syncAutoSummaryData(),d('‚úÖ ÂêåÊ≠•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå ÂêåÊ≠•ÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå ÂêåÊ≠•Â§±Ë¥•: '+n.message)}}),n.getElementById('checkFloor')?.addEventListener('click',()=>{d('üîç ÂºÄÂßãÊ£ÄÊü•Ê•ºÂ±Ç...');try{window.checkCurrentFloor?(window.checkCurrentFloor(),d('‚úÖ Ê•ºÂ±ÇÊ£ÄÊü•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå Ê•ºÂ±ÇÊ£ÄÊü•ÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå Ê•ºÂ±ÇÊ£ÄÊü•Â§±Ë¥•: '+n.message)}}),n.getElementById('testCalculation')?.addEventListener('click',()=>{d('üßÆ ÂºÄÂßãÈ™åËØÅËÆ°ÁÆó...');try{window.testFloorCalculation?(window.testFloorCalculation(),d('‚úÖ ËÆ°ÁÆóÈ™åËØÅÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå ËÆ°ÁÆóÈ™åËØÅÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå ËÆ°ÁÆóÈ™åËØÅÂ§±Ë¥•: '+n.message)}}),n.getElementById('showStatus')?.addEventListener('click',()=>{d('üìä ÂºÄÂßãÊòæÁ§∫Áä∂ÊÄÅ...');try{window.checkAutoSummaryStatus?(window.checkAutoSummaryStatus(),d('‚úÖ Áä∂ÊÄÅÊ£ÄÊü•ÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå Áä∂ÊÄÅÊ£ÄÊü•ÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå Áä∂ÊÄÅÊ£ÄÊü•Â§±Ë¥•: '+n.message)}}),n.getElementById('resetStartId')?.addEventListener('click',()=>{d('üîÑ ÂºÄÂßãÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç...');try{window.smartResetChat?(window.smartResetChat(),d('‚úÖ ÈáçÁΩÆÂáΩÊï∞Â∑≤ÊâßË°åÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫')):d('‚ùå ÈáçÁΩÆÂáΩÊï∞‰∏çÂèØÁî®')}catch(n){d('‚ùå ÈáçÁΩÆÂ§±Ë¥•: '+n.message)}}),o.onclick=n=>{n.target===o&&e.removeChild(o)};const c=t=>{'Escape'===t.key&&(e.removeChild(o),n.removeEventListener('keydown',c))};n.addEventListener('keydown',c),window.toastr?.info('Ë∞ÉËØïÈù¢ÊùøÂ∑≤ÊâìÂºÄ')}catch(n){console.error('ÂàõÂª∫Ë∞ÉËØïÈù¢ÊùøÂ§±Ë¥•:',n),window.toastr?.error('Êó†Ê≥ïÊòæÁ§∫Ë∞ÉËØïÈù¢ÊùøÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê')}};return a(),(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',xn,[(0,s.createElementVNode)('div',bn,[e[3]||(e[3]=(0,s.createElementVNode)('h3',{style:{margin:'0',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' üìù ÂéÜÂè≤ÊÄªÁªìËÆ∞ÂΩï ',-1)),(0,s.createElementVNode)('div',fn,[t.value.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('span',hn,(0,s.toDisplayString)(t.value.length)+' Êù°ËÆ∞ÂΩï',1)):(0,s.createCommentVNode)('v-if',!0),(0,s.createElementVNode)('button',{class:'mini-button refresh-button',style:{padding:'6px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'4px',color:'#e0e0e0',cursor:'pointer','font-size':'12px',transition:'all 0.2s',display:'flex','align-items':'center',gap:'6px'},onClick:d},[...e[0]||(e[0]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-refresh'},null,-1),(0,s.createTextVNode)(' Âà∑Êñ∞Êï∞ÊçÆ ',-1)])]),(0,s.createElementVNode)('button',{class:'mini-button create-worldbook-button',style:{padding:'6px 12px',background:'#51cf66',border:'1px solid #40c057','border-radius':'4px',color:'white',cursor:'pointer','font-size':'12px',transition:'all 0.2s',display:'flex','align-items':'center',gap:'6px'},onClick:m},[...e[1]||(e[1]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,s.createTextVNode)(' ÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶ ',-1)])]),(0,s.createElementVNode)('button',{class:'mini-button debug-button',style:{padding:'6px 12px',background:'#ffc107',border:'1px solid #ffb300','border-radius':'4px',color:'#000',cursor:'pointer','font-size':'12px',transition:'all 0.2s',display:'flex','align-items':'center',gap:'6px'},onClick:b},[...e[2]||(e[2]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-bug'},null,-1),(0,s.createTextVNode)(' Ë∞ÉËØïÂ∑•ÂÖ∑ ',-1)])])])]),t.value&&t.value.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('div',yn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(t.value,(n,a)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:a,class:'history-item',style:{background:'#2a2a2a',border:'1px solid #444','border-radius':'8px',padding:'15px',transition:'all 0.3s ease'}},[(0,s.createElementVNode)('div',{class:'history-header',style:{padding:'12px 15px',background:'#1a1a1a',display:'flex','justify-content':'space-between','align-items':'center',cursor:'pointer','user-select':'none',transition:'background 0.2s','border-radius':'6px'},onClick:n=>(n=>{const e=o.value.get(n)||!1;o.value.set(n,!e)})(a)},[(0,s.createElementVNode)('div',wn,[(0,s.createElementVNode)('span',Cn,'#'+(0,s.toDisplayString)(a+1),1),(0,s.createElementVNode)('span',vn,'Ê•ºÂ±Ç '+(0,s.toDisplayString)(n.start_id)+' - '+(0,s.toDisplayString)(n.end_id),1)]),(0,s.createElementVNode)('span',kn,(0,s.toDisplayString)(r(a)?'‚ñº':'‚ñ∂'),1)],8,An),r(a)?((0,s.openBlock)(),(0,s.createElementBlock)('div',Bn,[(0,s.createElementVNode)('div',_n,[(0,s.createElementVNode)('button',{class:'mini-button',style:{flex:'1',padding:'6px 12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'4px',color:'#e0e0e0',cursor:'pointer','font-size':'12px',transition:'background 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px'},onClick:e=>u(n.content)},[...e[4]||(e[4]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-copy'},null,-1),(0,s.createTextVNode)(' Â§çÂà∂ ',-1)])],8,En),(0,s.createElementVNode)('button',{class:'mini-button worldbook-button',style:{flex:'1',padding:'6px 12px',background:'#4a9eff',border:'1px solid #5aaeff','border-radius':'4px',color:'white',cursor:'pointer','font-size':'12px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px'},onClick:e=>(async(n,e)=>{try{const o=getWorldbookNames();if(0===o.length)return void window.toastr.warning('Ê≤°ÊúâÂèØÁî®ÁöÑ‰∏ñÁïå‰π¶ÔºåËØ∑ÂÖàÂàõÂª∫ÊÄªÁªì‰∏ñÁïå‰π¶');const a=1===o.length?o[0]:await x(o);if(!a)return;const r={name:`ÊÄªÁªì_${e+1}_${(new Date).toLocaleDateString()}`,enabled:!0,strategy:{type:'constant',keys:[],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'before_character_definition',role:'system',depth:1},content:n,comment:`Ëá™Âä®ÁîüÊàêÁöÑÊÄªÁªìÊù°ÁõÆ - Ê•ºÂ±ÇËåÉÂõ¥: ${t.value[e]?.start_id||'?'} - ${t.value[e]?.end_id||'?'}`,insertion_order:0,case_sensitive:!1,name_is_regex:!1,keys_are_regex:!1,selective_logic:'and',secondary_keys_logic:'and',activation_threshold:0,disabled:!1,order:0,group:'',local_id:0,depth_entries:[],depth_entries_all:!1,search_range:0,force_activation:!1,disable:!1,exclude_recursion:!1,hidden:!1,priority:0,comment_is_regex:!1,content_is_regex:!1,secondary_keys_are_regex:!1,keys_secondary_are_regex:!1,uid:Date.now()};await createWorldbookEntries(a,[r]),window.toastr.success(`ÊÄªÁªìÂ∑≤ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶: ${a}`)}catch(n){console.error('ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶Â§±Ë¥•:',n),window.toastr.error('ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶Â§±Ë¥•: '+n.message)}})(n.content,a)},[...e[5]||(e[5]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-book'},null,-1),(0,s.createTextVNode)(' ÁªëÂÆöÂà∞‰∏ñÁïå‰π¶ ',-1)])],8,zn),(0,s.createElementVNode)('button',{class:'mini-button delete-button',style:{flex:'1',padding:'6px 12px',background:'#ff6b6b',border:'1px solid #ff5252','border-radius':'4px',color:'white',cursor:'pointer','font-size':'12px',transition:'all 0.2s',display:'flex','align-items':'center','justify-content':'center',gap:'6px'},onClick:n=>(n=>{if(confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ÊÄªÁªìÂêóÔºü'))try{if(!(0,l.pA)())return void window.toastr.error('Êó†Ê≥ïËé∑ÂèñÂΩìÂâçËÅäÂ§©‰ø°ÊÅØ');t.value.splice(n,1),insertOrAssignVariables({summary_history:t.value},{type:'chat'}),window.toastr.success('ÊÄªÁªìÂ∑≤Âà†Èô§')}catch(n){console.error('Âà†Èô§ÊÄªÁªìÂ§±Ë¥•:',n),window.toastr.error('Âà†Èô§ÊÄªÁªìÂ§±Ë¥•')}})(a)},[...e[6]||(e[6]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1),(0,s.createTextVNode)(' Âà†Èô§ ',-1)])],8,Tn)]),(0,s.createElementVNode)('div',In,(0,s.toDisplayString)(n.content),1)])):(0,s.createCommentVNode)('v-if',!0)]))),128))])):((0,s.openBlock)(),(0,s.createElementBlock)('div',Sn,[...e[7]||(e[7]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-inbox',style:{'font-size':'48px','margin-bottom':'10px',opacity:'0.3'}},null,-1),(0,s.createElementVNode)('p',{style:{margin:'10px 0','font-size':'16px'}},'ËøòÊ≤°ÊúâÊÄªÁªìËÆ∞ÂΩï',-1),(0,s.createElementVNode)('small',{style:{'font-size':'12px',color:'#666'}},'‰ΩøÁî®"ËÆæÁΩÆ"Ê†áÁ≠æÈ°µÊâãÂä®ÂàõÂª∫ÊÄªÁªì',-1)])]))]))}});r(603);var Vn=r(42);const Dn=(0,Vn.A)(Nn,[['__scopeId','data-v-97028022']]),$n={class:'table-tab',style:{padding:'25px !important',background:'#1a1a1a !important'}},Mn={class:'section-header',style:{display:'flex','justify-content':'space-between','align-items':'center',padding:'20px 25px !important','border-bottom':'1px solid #3a3a3a','margin-bottom':'5px'}},Fn={key:0,class:'count-badge',style:{background:'#4a9eff',color:'white',padding:'4px 8px','border-radius':'12px','font-size':'12px'}},jn={key:0,class:'history-list',style:{display:'flex','flex-direction':'column',gap:'15px','margin-top':'20px'}},Pn=['onClick'],On={class:'history-info',style:{display:'flex','align-items':'center',gap:'10px',flex:'1'}},Yn={class:'history-number',style:{color:'#4a9eff','font-weight':'bold'}},Ln={class:'history-range',style:{color:'#888','font-size':'12px'}},Rn={class:'expand-icon',style:{color:'#888','font-size':'12px'}},Un={key:0,class:'history-content',style:{padding:'15px',background:'#2a2a2a','border-radius':'0 0 6px 6px'}},Wn={class:'history-actions',style:{display:'flex',gap:'10px','margin-bottom':'12px','padding-bottom':'8px','border-bottom':'1px solid #3a3a3a','flex-wrap':'wrap'}},qn=['onClick'],Hn=['onClick'],Gn={class:'table-display',style:{'overflow-x':'auto','border-radius':'6px',border:'1px solid #3a3a3a'}},Jn={style:{width:'100%','border-collapse':'collapse',background:'#1a1a1a'}},Kn={style:{background:'#2a2a2a'}},Zn={key:1,class:'empty-state',style:{'text-align':'center',padding:'40px 20px',color:'#888'}},Qn=(0,s.defineComponent)({__name:'TableTab',setup(n){const e=(0,s.ref)([]),t=(0,s.ref)(new Map),o=n=>t.value.get(n)||!1,a=async n=>new Promise(e=>{try{const t=window.parent.document,o=window.parent.document.body,a=t.createElement('textarea');a.value=n,a.style.cssText='\n        position: fixed;\n        left: -9999px;\n        top: -9999px;\n        opacity: 0;\n        pointer-events: none;\n        z-index: -1000;\n      ',a.setAttribute('readonly',''),o.appendChild(a),a.focus(),a.select(),a.setSelectionRange(0,n.length);const r=t.execCommand('copy');o.removeChild(a),e(r)}catch(n){console.error('Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•:',n),e(!1)}}),r=async n=>new Promise(e=>{try{const t=document.createElement('textarea');t.value=n,t.style.position='fixed',t.style.left='-9999px',t.style.top='-9999px',t.style.opacity='0',t.style.pointerEvents='none',t.setAttribute('readonly',''),document.body.appendChild(t),t.select(),t.setSelectionRange(0,n.length);const o=document.execCommand('copy');document.body.removeChild(t),e(o)}catch(n){console.error('execCommand Â§çÂà∂Â§±Ë¥•:',n),e(!1)}}),i=n=>{console.log('ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåÊñáÊú¨ÈïøÂ∫¶:',n.length);try{const e=window.parent.document,t=window.parent.document.body,o=e.getElementById('manual-copy-overlay');o&&t.removeChild(o);const a=e.createElement('div');a.id='manual-copy-overlay',a.style.cssText='\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.95);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    ';const r=e.createElement('div');r.style.cssText='\n      background: #2a2a2a;\n      border: 2px solid #4a9eff;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 900px;\n      width: 95%;\n      max-height: 85vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n    ';const s=e.createElement('div');s.innerHTML='\n      <h3 style="margin: 0 0 15px 0; color: #4a9eff; text-align: center; font-size: 18px; font-weight: 600;">\n        üìã ÊâãÂä®Â§çÂà∂Ë°®Ê†ºÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #444; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0 0 8px 0; color: #e0e0e0; font-size: 14px;">\n          <strong>Êìç‰ΩúÊ≠•È™§Ôºö</strong>\n        </p>\n        <ol style="margin: 0; padding-left: 20px; color: #ccc; font-size: 13px; line-height: 1.6;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°Ü</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+A</kbd> ÂÖ®ÈÄâÊñáÊú¨</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Ctrl+C</kbd> Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø</li>\n          <li>ÁÇπÂáª"ÂÖ≥Èó≠"ÊåâÈíÆÊàñÊåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px; color: #fff;">Esc</kbd> ÂÖ≥Èó≠ÂØπËØùÊ°Ü</li>\n        </ol>\n      </div>\n    ';const i=e.createElement('textarea');i.value=n,i.style.cssText='\n      width: 100%;\n      height: 400px;\n      background: #1a1a1a;\n      border: 2px solid #444;\n      border-radius: 6px;\n      padding: 15px;\n      color: #e0e0e0;\n      font-family: \'Courier New\', \'Consolas\', monospace;\n      font-size: 13px;\n      line-height: 1.5;\n      resize: vertical;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      outline: none;\n      margin-bottom: 20px;\n      box-sizing: border-box;\n    ';const l=e.createElement('div');l.style.cssText='\n      display: flex;\n      gap: 12px;\n      justify-content: center;\n      align-items: center;\n    ';const d=e.createElement('button');d.textContent='ÂÖ≥Èó≠',d.style.cssText='\n      background: #4a9eff;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    ',d.onmouseover=()=>{d.style.background='#5ba8ff'},d.onmouseout=()=>{d.style.background='#4a9eff'};const c=e.createElement('button');c.textContent='Â∞ùËØïËá™Âä®Â§çÂà∂',c.style.cssText='\n      background: #28a745;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 6px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: background 0.2s;\n    ',c.onmouseover=()=>{c.style.background='#218838'},c.onmouseout=()=>{c.style.background='#28a745'},l.appendChild(c),l.appendChild(d),r.appendChild(s),r.appendChild(i),r.appendChild(l),a.appendChild(r),t.appendChild(a),d.onclick=()=>{console.log('ÂÖ≥Èó≠ÊåâÈíÆË¢´ÁÇπÂáª'),t.removeChild(a)},c.onclick=async()=>{console.log('Â∞ùËØïËá™Âä®Â§çÂà∂ÊåâÈíÆË¢´ÁÇπÂáª');try{i.focus(),i.select();document.execCommand('copy')?(window.toastr.success('Ëá™Âä®Â§çÂà∂ÊàêÂäüÔºÅ'),t.removeChild(a)):window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂')}catch(n){console.error('Ëá™Âä®Â§çÂà∂Â§±Ë¥•:',n),window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂')}},a.onclick=n=>{n.target===a&&(console.log('ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠'),t.removeChild(a))};const p=n=>{'Escape'===n.key&&(console.log('ÊåâESCÈîÆÂÖ≥Èó≠'),t.removeChild(a),e.removeEventListener('keydown',p))};e.addEventListener('keydown',p),setTimeout(()=>{console.log('Ëá™Âä®ÈÄâ‰∏≠ÊñáÊú¨'),i.focus(),i.select()},200),window.toastr.info('ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ∑≤ÊâìÂºÄÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú')}catch(n){console.error('ÂàõÂª∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:',n),window.toastr.error('Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑Ê£ÄÊü•ÊµèËßàÂô®ÊùÉÈôê')}},d=n=>{try{(async(n,e='ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')=>{console.log('ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:',n.length);try{if(window.parent&&window.parent!==window&&(console.log('Ê£ÄÊµãÂà∞iframeÁéØÂ¢ÉÔºåÂ∞ùËØïÂú®Áà∂Á™óÂè£Â§çÂà∂'),await a(n)))return console.log('Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);if(navigator.clipboard&&window.isSecureContext){console.log('‰ΩøÁî®Áé∞‰ª£ Clipboard API');try{return await navigator.clipboard.writeText(n),console.log('Clipboard API Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e)}catch(n){console.warn('Clipboard API Â§±Ë¥•:',n)}}if(console.log('‰ΩøÁî® execCommand ÊñπÊ≥ï'),await r(n))return console.log('execCommand Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);console.log('ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÁïåÈù¢'),i(n)}catch(e){console.error('Â§çÂà∂ÂºÇÂ∏∏:',e),i(n)}})([n.headers.join('\t'),...n.data.map(n=>n.join('\t'))].join('\n'),'Ë°®Ê†ºÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')}catch(n){console.error('Â§çÂà∂Ë°®Ê†ºÂ§±Ë¥•:',n),window.toastr.error('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂')}};return(()=>{try{if(!(0,l.pA)())return console.warn('Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåÊ∏ÖÁ©∫Ë°®Ê†ºÂéÜÂè≤'),void(e.value=[]);const n=getVariables({type:'chat'});console.log('‰ªéËÅäÂ§©ÂèòÈáèËØªÂèñÁöÑÊï∞ÊçÆ:',n),console.log('Ë°®Ê†ºÂéÜÂè≤Êï∞ÊçÆ:',n.table_history),e.value=n.table_history||[],console.log('Â∑≤Âà∑Êñ∞Ë°®Ê†ºÂéÜÂè≤ÔºåÂΩìÂâçËÅäÂ§©Ë°®Ê†ºÊï∞:',e.value.length)}catch(n){console.error('Âà∑Êñ∞Ë°®Ê†ºÂéÜÂè≤Â§±Ë¥•:',n),e.value=[]}})(),(n,a)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',$n,[(0,s.createElementVNode)('div',Mn,[a[0]||(a[0]=(0,s.createElementVNode)('h3',{style:{margin:'0',color:'#fff','font-size':'15px !important','font-weight':'bold',display:'flex','align-items':'center',gap:'8px'}},' üìä Ë°®Ê†ºÂàÜÊûê ',-1)),e.value.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('span',Fn,(0,s.toDisplayString)(e.value.length)+' Êù°ËÆ∞ÂΩï',1)):(0,s.createCommentVNode)('v-if',!0)]),(0,s.createCommentVNode)(' Ë°®Ê†ºÂéÜÂè≤ÂàóË°® '),e.value&&e.value.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('div',jn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.value,(n,r)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:r,class:'history-item',style:{background:'#2a2a2a',border:'1px solid #444','border-radius':'8px',padding:'15px',transition:'all 0.3s ease'}},[(0,s.createElementVNode)('div',{class:'history-header',style:{padding:'12px 15px',background:'#1a1a1a',display:'flex','justify-content':'space-between','align-items':'center',cursor:'pointer','user-select':'none',transition:'background 0.2s','border-radius':'6px'},onClick:n=>(n=>{const e=t.value.get(n)||!1;t.value.set(n,!e)})(r)},[(0,s.createElementVNode)('div',On,[(0,s.createElementVNode)('span',Yn,'#'+(0,s.toDisplayString)(r+1),1),(0,s.createElementVNode)('span',Ln,'Ê•ºÂ±Ç '+(0,s.toDisplayString)(n.start_id)+' - '+(0,s.toDisplayString)(n.end_id),1)]),(0,s.createElementVNode)('span',Rn,(0,s.toDisplayString)(o(r)?'‚ñº':'‚ñ∂'),1)],8,Pn),o(r)?((0,s.openBlock)(),(0,s.createElementBlock)('div',Un,[(0,s.createElementVNode)('div',Wn,[(0,s.createElementVNode)('button',{class:'copy-button',style:{padding:'8px 16px',background:'linear-gradient(135deg, #28a745 0%, #20c997 100%)',border:'none','border-radius':'6px',color:'white',cursor:'pointer','font-size':'12px','font-weight':'600',transition:'all 0.3s ease',display:'flex','align-items':'center',gap:'6px','box-shadow':'0 3px 12px rgba(40, 167, 69, 0.3)',position:'relative',overflow:'hidden'},onClick:e=>d(n)},[...a[1]||(a[1]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-copy',style:{'font-size':'12px'}},null,-1),(0,s.createTextVNode)(' Â§çÂà∂ ',-1)])],8,qn),(0,s.createElementVNode)('button',{class:'delete-button',style:{padding:'8px 16px',background:'linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)',border:'none','border-radius':'6px',color:'white',cursor:'pointer','font-size':'12px','font-weight':'600',transition:'all 0.3s ease',display:'flex','align-items':'center',gap:'6px','box-shadow':'0 3px 12px rgba(255, 107, 107, 0.3)',position:'relative',overflow:'hidden'},onClick:n=>(n=>{confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Ë°®Ê†ºÂêóÔºü')&&(e.value.splice(n,1),(0,l.pA)()&&(insertOrAssignVariables({table_history:e.value},{type:'chat'}),window.toastr.success('Ë°®Ê†ºÂ∑≤Âà†Èô§')))})(r)},[...a[2]||(a[2]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-trash',style:{'font-size':'12px'}},null,-1),(0,s.createTextVNode)(' Âà†Èô§ ',-1)])],8,Hn)]),(0,s.createElementVNode)('div',Gn,[(0,s.createElementVNode)('table',Jn,[(0,s.createElementVNode)('thead',Kn,[(0,s.createElementVNode)('tr',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(n.headers,(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('th',{key:e,style:{padding:'12px 16px','text-align':'left','font-weight':'bold',color:'#fff','border-bottom':'2px solid #3a3a3a','border-right':'1px solid #3a3a3a'}},(0,s.toDisplayString)(n),1))),128))])]),(0,s.createElementVNode)('tbody',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(n.data,(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('tr',{key:e,style:{'border-bottom':'1px solid #3a3a3a'}},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(n,(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('td',{key:e,style:{padding:'10px 16px',color:'#e0e0e0','border-right':'1px solid #3a3a3a'}},(0,s.toDisplayString)(n),1))),128))]))),128))])])])])):(0,s.createCommentVNode)('v-if',!0)]))),128))])):((0,s.openBlock)(),(0,s.createElementBlock)('div',Zn,[...a[3]||(a[3]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-table',style:{'font-size':'48px','margin-bottom':'10px',opacity:'0.3'}},null,-1),(0,s.createElementVNode)('p',{style:{margin:'10px 0','font-size':'16px'}},'ËøòÊ≤°ÊúâË°®Ê†ºËÆ∞ÂΩï',-1),(0,s.createElementVNode)('small',{style:{'font-size':'12px',color:'#666'}},'‰ΩøÁî®"ËÆæÁΩÆ"Ê†áÁ≠æÈ°µÊâãÂä®ÁîüÊàêË°®Ê†º',-1)])]))]))}});r(162);const Xn=(0,Vn.A)(Qn,[['__scopeId','data-v-0416f1c6']]),ne=_,ee={class:'tools-tab',style:{padding:'25px !important',background:'#1a1a1a !important'}},te={class:'tool-section'},oe={key:0,class:'tool-content'},ae={class:'form-group',style:{margin:'15px 0'}},re={class:'button-group',style:{display:'flex',gap:'12px','margin-bottom':'20px'}},se=['disabled'],ie={key:0,class:'output-section'},le={class:'output-content',style:{background:'#1e1e1e',border:'1px solid #3a3a3a','border-radius':'6px',padding:'15px',color:'#e0e0e0','font-size':'13px','line-height':'1.6','white-space':'pre-wrap','word-wrap':'break-word','max-height':'300px','overflow-y':'auto'}},de={class:'tool-section'},ce={key:0,class:'tool-content'},pe={class:'form-group',style:{margin:'15px 0'}},ge={class:'button-group',style:{display:'flex',gap:'12px','margin-bottom':'20px'}},ue=['disabled'],me={key:0,class:'output-section'},xe={class:'output-content',style:{background:'#1e1e1e',border:'1px solid #3a3a3a','border-radius':'6px',padding:'15px',color:'#e0e0e0','font-size':'13px','line-height':'1.6','white-space':'pre-wrap','word-wrap':'break-word','max-height':'300px','overflow-y':'auto'}},be={class:'modify-section',style:{'margin-top':'25px','border-top':'2px dashed #3a3a3a','padding-top':'20px'}},fe={class:'form-group',style:{margin:'15px 0'}},he={class:'button-group',style:{display:'flex',gap:'12px','margin-bottom':'15px'}},ye=['disabled'],Ae=(0,s.defineComponent)({__name:'ToolsTab',setup(n){const e=(0,i.C)(),{settings:o}=(0,c.storeToRefs)(e),a=(0,s.ref)(new Map),r=(0,s.ref)(''),l=(0,s.ref)(''),d=(0,s.ref)(!1),p=(0,s.ref)(''),g=(0,s.ref)(''),u=(0,s.ref)(!1),m=(0,s.ref)(''),x=(0,s.ref)(!1),b=(0,s.ref)(!1),f=()=>{if(b.value)try{const n=t();if(!n)return void console.warn('‚ö†Ô∏è script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ï‰øùÂ≠òÊï∞ÊçÆ');const e={tools_antiCliche:{input:r.value,output:l.value},tools_characterCard:{description:p.value,output:g.value,modifyRequest:m.value},tools_expandedState:Object.fromEntries(a.value)};insertOrAssignVariables(e,{type:'script',script_id:n}),console.log('üíæ Â∑•ÂÖ∑Êï∞ÊçÆÂ∑≤‰øùÂ≠ò:',{antiCliche_input_length:r.value.length,antiCliche_output_length:l.value.length,character_desc_length:p.value.length,character_output_length:g.value.length})}catch(n){console.error('‚ùå ‰øùÂ≠òÂ∑•ÂÖ∑Êï∞ÊçÆÂ§±Ë¥•:',n)}else console.log('‚è∏Ô∏è Ë∑≥Ëøá‰øùÂ≠òÔºöÊï∞ÊçÆÂ∞öÊú™Âä†ËΩΩÂÆåÊàê')},h=(0,ne.debounce)(f,300);(0,s.watch)([r,l,p,g,m,a],()=>{b.value&&(console.log('üìù Êï∞ÊçÆÂèòÂåñÔºåËß¶Âèë‰øùÂ≠ò...'),h())},{deep:!0}),(0,s.onMounted)(()=>{console.log('üîß ToolsTab ÁªÑ‰ª∂Â∑≤ÊåÇËΩΩÔºåÂä†ËΩΩÊï∞ÊçÆ...'),(()=>{try{b.value=!1;const n=t();if(!n)return console.warn('‚ö†Ô∏è script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÊï∞ÊçÆ'),void(b.value=!0);const e=getVariables({type:'script',script_id:n});console.log('üì• Âä†ËΩΩÂ∑•ÂÖ∑Êï∞ÊçÆ:',e),e.tools_antiCliche&&(r.value=e.tools_antiCliche.input||'',l.value=e.tools_antiCliche.output||'',console.log('‚úÖ Â∑≤ÊÅ¢Â§çÂèçÂÖ´ËÇ°Êï∞ÊçÆ:',{input:r.value.substring(0,50),output:l.value.substring(0,50)})),e.tools_characterCard&&(p.value=e.tools_characterCard.description||'',g.value=e.tools_characterCard.output||'',m.value=e.tools_characterCard.modifyRequest||'',console.log('‚úÖ Â∑≤ÊÅ¢Â§çËßíËâ≤Âç°Êï∞ÊçÆ:',{description:p.value.substring(0,50),output:g.value.substring(0,50),modifyRequest:m.value.substring(0,50)})),e.tools_expandedState&&(a.value=new Map(Object.entries(e.tools_expandedState)),console.log('‚úÖ Â∑≤ÊÅ¢Â§çÂ±ïÂºÄÁä∂ÊÄÅ:',Object.fromEntries(a.value))),setTimeout(()=>{b.value=!0,console.log('‚úÖ Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÔºåÂêØÁî®Ëá™Âä®‰øùÂ≠ò')},100)}catch(n){console.error('‚ùå Âä†ËΩΩÂ∑•ÂÖ∑Êï∞ÊçÆÂ§±Ë¥•:',n),b.value=!0}})()}),(0,s.onBeforeUnmount)(()=>{console.log('üîÑ ToolsTab ÁªÑ‰ª∂Âç≥Â∞ÜÂç∏ËΩΩÔºå‰øùÂ≠òÊï∞ÊçÆ...'),h.cancel(),f()});const y=n=>{console.log('toggleToolExpanded Ë¢´Ë∞ÉÁî®ÔºåÂ∑•ÂÖ∑ÂêçÁß∞:',n);const e=a.value.get(n)||!1;console.log('ÂΩìÂâçÂ±ïÂºÄÁä∂ÊÄÅ:',e),a.value.set(n,!e),console.log('Êñ∞ÁöÑÂ±ïÂºÄÁä∂ÊÄÅ:',!e)},A=n=>a.value.get(n)||!1,w=async(n,e)=>{if(console.log('üîç ÂºÄÂßãÂ§çÂà∂ÔºåÊñáÊú¨ÈïøÂ∫¶:',n.length),console.log('üîç ÊòØÂê¶Âú®iframe‰∏≠:',window.parent!==window),window.parent&&window.parent!==window){console.log('üîç Â∞ùËØïÂú®Áà∂Á™óÂè£‰∏≠Â§çÂà∂...');if(C(n))return console.log('‚úÖ Áà∂Á™óÂè£Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);console.warn('‚ö†Ô∏è Áà∂Á™óÂè£Â§çÂà∂Â§±Ë¥•')}try{console.log('üîç Â∞ùËØï execCommand Â§çÂà∂...');if(v(n))return console.log('‚úÖ execCommand Â§çÂà∂ÊàêÂäü'),void window.toastr.success(e);console.warn('‚ö†Ô∏è execCommand Â§çÂà∂Â§±Ë¥•')}catch(n){console.warn('‚ùå execCommand Â§çÂà∂ÂºÇÂ∏∏:',n)}try{if(navigator.clipboard&&window.isSecureContext){console.log('üîç Â∞ùËØï Clipboard API Â§çÂà∂...'),await navigator.clipboard.writeText(n);if(await navigator.clipboard.readText()===n)return console.log('‚úÖ Clipboard API Â§çÂà∂ÊàêÂäüÔºàÂ∑≤È™åËØÅÔºâ'),void window.toastr.success(e);console.warn('‚ö†Ô∏è Clipboard API Â§çÂà∂ÂêéÈ™åËØÅÂ§±Ë¥•')}}catch(n){console.warn('‚ùå Clipboard API Â§±Ë¥•:',n)}console.log('‚ö†Ô∏è ÊâÄÊúâËá™Âä®Â§çÂà∂ÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü'),k(n)},C=n=>{try{if(window.parent&&window.parent!==window){console.log('  üìù Âú®Áà∂Á™óÂè£ÂàõÂª∫‰∏¥Êó∂textarea...');const e=window.parent.document,t=e.createElement('textarea');t.value=n,t.style.cssText='\n        position: fixed !important;\n        left: -9999px !important;\n        top: -9999px !important;\n        width: 1px !important;\n        height: 1px !important;\n        opacity: 0 !important;\n        pointer-events: none !important;\n      ',t.setAttribute('readonly',''),e.body.appendChild(t),console.log('  üìù TextareaÂ∑≤Ê∑ªÂä†Âà∞Áà∂Á™óÂè£'),t.focus(),t.select(),t.setSelectionRange(0,n.length),console.log('  üìù ÊñáÊú¨Â∑≤ÈÄâ‰∏≠');const o=e.execCommand('copy');return console.log('  üìù execCommandÁªìÊûú:',o),e.body.removeChild(t),console.log('  üìù TextareaÂ∑≤Ê∏ÖÁêÜ'),o}}catch(n){console.error('‚ùå Áà∂Á™óÂè£Â§çÂà∂ÂºÇÂ∏∏:',n)}return!1},v=n=>{try{console.log('  üìù Âú®ÂΩìÂâçÁ™óÂè£ÂàõÂª∫‰∏¥Êó∂textarea...');const e=document.createElement('textarea');e.value=n,e.style.cssText='\n      position: fixed !important;\n      left: -9999px !important;\n      top: -9999px !important;\n      width: 1px !important;\n      height: 1px !important;\n      opacity: 0 !important;\n      pointer-events: none !important;\n    ',e.setAttribute('readonly',''),document.body.appendChild(e),console.log('  üìù TextareaÂ∑≤Ê∑ªÂä†Âà∞ÂΩìÂâçÁ™óÂè£'),e.focus(),e.select(),e.setSelectionRange(0,n.length),console.log('  üìù ÊñáÊú¨Â∑≤ÈÄâ‰∏≠');const t=document.execCommand('copy');return console.log('  üìù execCommandÁªìÊûú:',t),document.body.removeChild(e),console.log('  üìù TextareaÂ∑≤Ê∏ÖÁêÜ'),t}catch(n){return console.error('‚ùå execCommand Â§çÂà∂ÂºÇÂ∏∏:',n),!1}},k=n=>{try{console.log('üìã ÊòæÁ§∫ÊâãÂä®Â§çÂà∂ÂØπËØùÊ°Ü');const e=window.parent&&window.parent!==window?window.parent.document:document,t=e.body;console.log('üìã ÁõÆÊ†áÊñáÊ°£:',e===window.parent.document?'Áà∂Á™óÂè£':'ÂΩìÂâçÁ™óÂè£');const o=e.getElementById('manual-copy-modal-tools');o&&t.removeChild(o);const a=e.createElement('div');a.id='manual-copy-modal-tools',a.style.cssText='\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.9);\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    ';const r=e.createElement('div');r.style.cssText='\n      background: #2a2a2a;\n      border: 2px solid #ffa500;\n      border-radius: 12px;\n      padding: 25px;\n      max-width: 700px;\n      width: 90%;\n      max-height: 80vh;\n      display: flex;\n      flex-direction: column;\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);\n    ',r.innerHTML=`\n      <h3 style="margin: 0 0 15px 0; color: #ffa500; font-size: 18px; font-weight: 600;">\n        <i class="fa-solid fa-copy" style="margin-right: 8px;"></i>\n        ÊâãÂä®Â§çÂà∂ÂÜÖÂÆπ\n      </h3>\n      <div style="background: #1a1a1a; border: 1px solid #3a3a3a; border-radius: 6px; padding: 12px; margin-bottom: 15px;">\n        <p style="margin: 0; color: #e0e0e0; font-size: 14px; line-height: 1.6;">\n          ‚ö†Ô∏è Ëá™Âä®Â§çÂà∂ÂäüËÉΩÂú®ÂΩìÂâçÁéØÂ¢É‰∏ã‰∏çÂèØÁî®ÔºåËØ∑ÊâãÂä®Â§çÂà∂‰ª•‰∏ãÂÜÖÂÆπÔºö\n        </p>\n        <ol style="margin: 8px 0 0 20px; padding: 0; color: #ccc; font-size: 13px;">\n          <li>ÁÇπÂáª‰∏ãÊñπÊñáÊú¨Ê°ÜÈÄâ‰∏≠ÂÜÖÂÆπ</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px;">Ctrl+A</kbd> ÂÖ®ÈÄâ</li>\n          <li>Êåâ <kbd style="background: #444; padding: 2px 6px; border-radius: 3px;">Ctrl+C</kbd> Â§çÂà∂</li>\n        </ol>\n      </div>\n      <textarea\n        readonly\n        id="copyTextarea"\n        style="\n          width: 100%;\n          height: 300px;\n          background: #1a1a1a;\n          border: 2px solid #3a3a3a;\n          border-radius: 6px;\n          padding: 12px;\n          color: #e0e0e0;\n          font-size: 13px;\n          font-family: 'Courier New', Consolas, monospace;\n          resize: vertical;\n          margin-bottom: 15px;\n          box-sizing: border-box;\n        "\n      >${n}</textarea>\n      <div style="display: flex; gap: 12px; justify-content: flex-end;">\n        <button id="manualCopyBtn" style="\n          padding: 10px 20px;\n          background: #28a745;\n          border: none;\n          border-radius: 6px;\n          color: white;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.2s;\n        ">Â∞ùËØïËá™Âä®Â§çÂà∂</button>\n        <button id="closeBtn" style="\n          padding: 10px 20px;\n          background: #6c757d;\n          border: none;\n          border-radius: 6px;\n          color: white;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.2s;\n        ">ÂÖ≥Èó≠</button>\n      </div>\n    `,a.appendChild(r),t.appendChild(a),console.log('üìã ÂØπËØùÊ°ÜÂ∑≤Ê∑ªÂä†Âà∞DOM');const s=r.querySelector('#copyTextarea');setTimeout(()=>{s.focus(),s.select(),console.log('üìã ÊñáÊú¨Â∑≤Ëá™Âä®ÈÄâ‰∏≠')},100);const i=r.querySelector('#manualCopyBtn'),l=r.querySelector('#closeBtn');i.onmouseover=()=>i.style.background='#218838',i.onmouseout=()=>i.style.background='#28a745',l.onmouseover=()=>l.style.background='#5a6268',l.onmouseout=()=>l.style.background='#6c757d',i.onclick=()=>{try{console.log('üìã Â∞ùËØïÈÄöËøáÊåâÈíÆÂ§çÂà∂...'),s.focus(),s.select();const n=e.execCommand('copy');console.log('üìã Â§çÂà∂ÁªìÊûú:',n),n?(window.toastr.success('Â§çÂà∂ÊàêÂäüÔºÅ'),t.removeChild(a)):window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Êåâ Ctrl+C Â§çÂà∂')}catch(n){console.error('üìã Â§çÂà∂ÂºÇÂ∏∏:',n),window.toastr.warning('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Êåâ Ctrl+C Â§çÂà∂')}},l.onclick=()=>{console.log('üìã ÂÖ≥Èó≠ÂØπËØùÊ°Ü'),t.removeChild(a)},a.onclick=n=>{n.target===a&&(console.log('üìã ÁÇπÂáªËÉåÊôØÂÖ≥Èó≠'),t.removeChild(a))};const d=n=>{'Escape'===n.key&&(console.log('üìã ÊåâESCÂÖ≥Èó≠'),t.removeChild(a),e.removeEventListener('keydown',d))};e.addEventListener('keydown',d),window.toastr.info('Â∑≤ÊâìÂºÄÊâãÂä®Â§çÂà∂ÂØπËØùÊ°ÜÔºåËØ∑ÊåâÁÖßÊèêÁ§∫Êìç‰Ωú','',{timeOut:3e3})}catch(n){console.error('‚ùå ÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÂ§±Ë¥•:',n),window.toastr.error('Êó†Ê≥ïÊòæÁ§∫Â§çÂà∂ÂØπËØùÊ°ÜÔºö'+n.message)}},B=async()=>{if(r.value.trim())try{d.value=!0,window.toastr.info('AIÊ≠£Âú®ÂàÜÊûêÊñáÊú¨...','ÂèçÂÖ´ËÇ°Ê∏ÖÁêÜ',{timeOut:15e3});const n=await fetch(o.value.api_endpoint,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${o.value.api_key}`},body:JSON.stringify({model:o.value.model,messages:[{role:'system',content:'‰Ω†ÊòØ‰∏Ä‰∏™ÊñáÊú¨ÁºñËæëÂä©ÊâãÔºåË¥üË¥£Á≥ªÁªüÊÄßÂú∞Ê∏ÖÁêÜËßíËâ≤Âç°„ÄÅ‰∏ñÁïå‰π¶ÂíåÂºÄÂú∫ÁôΩ‰∏≠ÁöÑÂÖ´ËÇ°Ë°®Ëø∞„ÄÇËØ∑ÊåâÁÖß‰ª•‰∏ã‰πù‰∏™Ê≠•È™§‰∏•Ê†ºÊâßË°åÔºö\n\n## Á¨¨‰∏ÄÊ≠•ÔºöÂéªÈô§Ê®°Á≥äËØçÂíåÁ±ªÊØîËØç\nÂà†Èô§Ôºö‰ºº‰πé„ÄÅÂá†‰πé„ÄÅËøë‰πé„ÄÅÂ•ΩÂÉè„ÄÅ‰ªø‰Ωõ„ÄÅÂ¶ÇÂêå„ÄÅÂÆõÂ¶Ç„ÄÅÊÅ∞‰ºº„ÄÅ‰∏Ä‰∏ù„ÄÅ‰∏ÄÊäπ„ÄÅ‰∏Ä‰∏ù‰∏ù„ÄÅ‰∏ÄËà¨„ÄÅ‰∏çÊòìÂØüËßâ„ÄÅËã•ÊúâËã•Êó†\n\n## Á¨¨‰∫åÊ≠•ÔºöÂéªÈô§ÂÖ´ËÇ°ÊØîÂñªËØç\n- Âà†Èô§ÊâÄÊúâÂä®Áâ©ÂåñÊØîÂñªÔºöÂÉèÂ∞èÂÖîÂ≠ê‰∏ÄÊ†∑„ÄÅÂÉèÂ∞èÂÖΩ‰∏ÄÊ†∑„ÄÅÂÉèÁå´Âí™‰∏ÄÊ†∑„ÄÅÈáéÂÖΩ„ÄÅÂ∞èÂÖΩ„ÄÅÂπºÂÖΩ„ÄÅ‰ΩéÂêº„ÄÅÂò∂Âêº\n- Âà†Èô§ÊäïÁü≥Á±ªÊØîÂñªÔºöÊäïÁü≥ÂÖ•Ê∞¥„ÄÅÁü≥Â§¥ËêΩÂú∞Á≠â\n- Áõ¥Êé•ÊèèËø∞Âä®‰ΩúÂíåÁä∂ÊÄÅÔºå‰∏ç‰ΩøÁî®ÊØîÂñª\n\n## Á¨¨‰∏âÊ≠•ÔºöÂéªÈô§ËØ≠Ê∞îÂ£∞Èü≥ÊèèËø∞\nÂà†Èô§ÔºöÂ∏¶ÁùÄxxxÁöÑÂè£Âêª/ËØ≠Ê∞î„ÄÅÂ£∞Èü≥ÊØîÂØíÂÜ∞Êõ¥ÂÜ∞ÂÜ∑„ÄÅÁî®‰∏çÂÆπÁΩÆÁñëÁöÑËØ≠Ê∞î„ÄÅÊØè‰∏™Â≠óÈÉΩÂ∏¶ÁùÄxxx„ÄÅÊ≤ôÂìëÁöÑÂ£∞Èü≥„ÄÅ‰ªª‰ΩïÂ£∞Èü≥Ë¥®ÊÑüÊèèËø∞\n**ÂéüÂàôÔºöÂÆåÂÖ®‰∏çÊèèÂÜôËØ≠Ê∞îÔºåÁî±ÂØπËØùÂÜÖÂÆπÊú¨Ë∫´Âá∏Êòæ‰∫∫ËÆæ**\n\n## Á¨¨ÂõõÊ≠•ÔºöÂéªÈô§ÂæÆË°®ÊÉÖÂíåÂæÆÂä®‰Ωú\nÂà†Èô§ÔºöÊµÅÈú≤Âá∫xxxÁ•ûËâ≤„ÄÅÁúºÈáåÊºæËµ∑/Èó™Ëøáxxx„ÄÅÂò¥Ëßí‰∏äÊâ¨/ÁøòËµ∑ÂºßÂ∫¶„ÄÅÈú≤Âá∫‰∏Ä‰∏ùÂæÆÁ¨ë„ÄÅÊåáÂ∞ñÊ≥õÁôΩ„ÄÅ‰∏ãÊÑèËØÜ/Êó†ÊÑèËØÜÁöÑÂä®‰Ωú„ÄÅÁã°Èª†„ÄÅÁîúËÖªÁ≠âË°®ÊÉÖ\n**Êõø‰ª£ÔºöÂ¶ÇÈúÄÂ∞èÂä®‰ΩúÔºåÁî®"‰π†ÊÉØÊÄßÂú∞"ËÄåÈùû"‰∏ãÊÑèËØÜ"**\n\n## Á¨¨‰∫îÊ≠•ÔºöÂéªÈô§"‰∏çÊòØ‚Ä¶‚Ä¶ËÄåÊòØ‚Ä¶‚Ä¶"Âè•Âºè\nÊ∏ÖÁêÜÊâÄÊúâÂê¶ÂÆöËΩ¨ÊäòÂè•ÔºåÁõ¥Êé•ÂÜô"ËÄåÊòØ"ÂêéÈù¢ÁöÑÂÜÖÂÆπ\n\n## Á¨¨ÂÖ≠Ê≠•Ôºö‰øÆÊîπÂ§ñË≤åÊèèËø∞\n- Áû≥Ëâ≤ÁßªÂÖ•ÂØπËØùÁî±ËßíËâ≤Ëá™Ëø∞\n- Â•≥ÊÄßÁΩ©ÊùØÊîπ‰∏∫"ËÉ∏ÈÉ®Âπ≥Âù¶/‰∏∞Êª°"Á≠âÊèèËø∞\n- Á≤æÁ°ÆË∫´È´òÊîπ‰∏∫"È´ò‰∏ÄÁ±≥ÂÖ´"Á≠âÊèèËø∞ÊÄßËØ≠Ë®Ä\n- Âà†Èô§‰∏âÁª¥Â∞∫ÂØ∏Êï∞ÊçÆ\n\n## Á¨¨‰∏ÉÊ≠•ÔºöÈáçÂÜôËØ≠ÊñôÂíåÊÄßÊ†ºÊèèËø∞\n- ËØ≠ÊñôÂè™Áî®Á∫ØÂØπËØùÔºå‰∏çÈôÑÂä†Ë°®ÊÉÖÂä®‰ΩúÁ•ûÊÄÅ\n- ÈÄöËøáÂÖ∑‰ΩìË°å‰∏∫ÂèçÂ∫î‰ΩìÁé∞ÊÄßÊ†ºÔºåÈÅøÂÖçÊÄßÊ†ºÊ†áÁ≠æ\n- Áî®ÈôàËø∞ÂºèËÇØÂÆöÂûãÊèèËø∞Ôºå‰∏çÂä†‰øÆËæû\n\n## Á¨¨ÂÖ´Ê≠•ÔºöÈò≤Ê≠¢ÁªùÊúõ/Á•ûÂåñ/ÊéåÊéßÂÄæÂêë\n- Âà†Èô§ÊûÅÁ´ØÊÉÖÁª™ËØçÔºöÊûÅÂ§ßÁöÑÊÅêÊÉß„ÄÅÈùûÂ∏∏ÂÆ≥ÊÄï„ÄÅÊûÅÂ∫¶ÁæûËÄª„ÄÅÊûÅÂ∫¶‰∏çÂÆâ\n- Âà†Èô§Ë¥üÈù¢Áä∂ÊÄÅËØçÔºöÁïèÁº©„ÄÅÁ©∫ÁôΩ„ÄÅ‰∏ÄÂç°‰∏ÄÂç°„ÄÅÊú∫Ê¢∞Âåñ„ÄÅÂÉµÁ°¨\n- ‰∏çÂÜôËßíËâ≤ÂøÉÁêÜÂèçÂ∫îÂíåÂÜÖÂøÉÊÉ≥Ê≥ï\n- ‰∏çÂÜôuserÁöÑÂøÉÁêÜÂèçÂ∫îÔºå‰∏çÁ•ûÂåñËßíËâ≤\n\n## Á¨¨‰πùÊ≠•ÔºöNSFWÈÉ®ÂàÜÈò≤ÊÄßÁãÇÈáé\n- Âà†Èô§ÔºöÂñúÊ¨¢Á≤óÊö¥/Âä†ÈÄü„ÄÅÂñúÊ¨¢ÊÄßÂø´ÊÑü„ÄÅÁñºÁóõÁóõËã¶Áõ∏ÂÖ≥\n- Âà†Èô§ÔºöÊíïÁ¢é„ÄÅÊíïË£Ç„ÄÅÁ†¥Á¢é„ÄÅÁªû„ÄÅÁªûÁº†„ÄÅÁ¢æ„ÄÅÁ¢æÁ£®„ÄÅÁ†îÁ£®„ÄÅÊî´„ÄÅÂ∞ñÂè´„ÄÅÈ´ò‰∫¢„ÄÅÂëúÂíΩ„ÄÅÁîüÁêÜÊÄßÊ≥™Ê∞¥„ÄÅÁî¨ÈÅì„ÄÅÂºìËµ∑„ÄÅÁÅ≠È°∂ÁöÑÂø´ÊÑü„ÄÅÁªÜÁ¢é\n- ÈÅøÂÖçÊÄßÂô®ÂÆòÂ∞∫ÂØ∏Â§∏Âº†ÊèèËø∞\n\n## ÂÆåÊï¥Á¶ÅÁî®ËØçÂàóË°®ÔºàÂøÖÈ°ªÂà†Èô§ÔºâÔºö\nÊ®°Á≥äËØçÔºö‰∏Ä‰∏ù„ÄÅ‰∏ÄÊäπ„ÄÅ‰ºº‰πé„ÄÅÂá†‰πé„ÄÅËøë‰πé„ÄÅ‰ªø‰Ωõ„ÄÅÂ¶ÇÂêå„ÄÅÂÆõÂ¶Ç„ÄÅÊÅ∞‰ºº„ÄÅ‰∏çÊòìÂØüËßâ„ÄÅËã•ÊúâËã•Êó†\nÂä®Áâ©ÂåñÔºöÈáéÂÖΩ„ÄÅÂ∞èÂÖΩ„ÄÅÂπºÂÖΩ„ÄÅÂÉèÂ∞èÂÖîÂ≠ê„ÄÅÂÉèÁå´Âí™„ÄÅ‰ΩéÂêº„ÄÅÂò∂Âêº„ÄÅÂèóÊÉäÁöÑÂ∞èÂÖΩ\nÊÉÖÁª™ËØçÔºöÁã°Èª†„ÄÅÁîúËÖª„ÄÅÁñØÁãÇ„ÄÅÊàèË∞ë„ÄÅÊÅºÊÄí„ÄÅÂõ∞ÊÉë„ÄÅÊÅêÊÉß„ÄÅÁªùÊúõ„ÄÅÂ¥áÊãú„ÄÅÁãÇÁÉ≠„ÄÅÁ©∫Ê¥û„ÄÅÊØ´Êó†ÁîüÊ∞î„ÄÅËá™Âò≤„ÄÅËã¶Ê∂©„ÄÅÂÜ∞ÂÜ∑„ÄÅÊößÊòß„ÄÅËôîËØö\nÂä®‰ΩúËØçÔºöÈó™Ëøá„ÄÅÈó™ÁùÄ„ÄÅÂèëÁôΩ„ÄÅÊíïÁ¢é„ÄÅÊíïË£Ç„ÄÅÂºßÂ∫¶„ÄÅÁ†¥Á¢é„ÄÅÁªû„ÄÅÂ∞ñÂè´„ÄÅÂëúÂíΩ„ÄÅÊ≤ôÂìë„ÄÅÁ¢æ„ÄÅÁ†îÁ£®„ÄÅÊî´„ÄÅÂºìËµ∑„ÄÅÁªÜÁ¢é„ÄÅÊåáËäÇÂèëÁôΩ„ÄÅÊó†ÊÑèËØÜÁöÑ„ÄÅ‰∏ãÊÑèËØÜ„ÄÅËú∑Áº©„ÄÅÁóâÊåõ„ÄÅÂÉµ‰Ωè„ÄÅÊ•ûÂú®ÂéüÂú∞„ÄÅÈ¢§Êäñ„ÄÅÂûÆ‰∫Ü‰∏ãÊù•„ÄÅÁ¥ßÊè°„ÄÅÊî•‰Ωè„ÄÅÂãæ‰Ωè„ÄÅÁªûÂú®‰∏ÄËµ∑„ÄÅÂéãÂæóÂñò‰∏çËøáÊ∞î„ÄÅÊ∑πÊ≤°„ÄÅÂáªÂûÆ„ÄÅÂàíÂºÄ„ÄÅÂà∫Á†¥„ÄÅÂêûÂô¨\nÁîüÁêÜËØçÔºöÁîüÁêÜÊÄßÊ≥™Ê∞¥„ÄÅÁî¨ÈÅì„ÄÅÁÅ≠È°∂ÁöÑÂø´ÊÑü„ÄÅÊöñÊµÅÊ∂å‰∏äÂøÉÂ§¥„ÄÅÂ¶ÇÂù†ÂÜ∞Á™ü„ÄÅÊµëË∫´ÂÜ∞ÂÜ∑„ÄÅÊâãËÑöÂÜ∞Âáâ„ÄÅÂ§ßËÑë‰∏ÄÁâáÁ©∫ÁôΩ„ÄÅÂó°Âó°‰ΩúÂìç„ÄÅÂëºÂê∏‰∏ÄÊªû„ÄÅÂÄíÂê∏‰∏ÄÂè£ÂáâÊ∞î„ÄÅË∫´‰ΩìÂÉµÁ°¨„ÄÅÂ¶ÇÈÅ≠Èõ∑Âáª„ÄÅÁªÜÂØÜÁöÑÊ±óÁè†\nÊØîÂñªÁ±ªÔºöÁü≥Â≠êÊäïÂÖ•Êπñ‰∏≠„ÄÅÊ≥õËµ∑Ê∂üÊº™„ÄÅÈíàÊâéÁ†¥Ê∞îÁêÉ„ÄÅÊâãÊúØÂàÄÂàíÂºÄ„ÄÅÂèóÊÉäÂ∞èÂÖΩ„ÄÅÊèêÁ∫øÊú®ÂÅ∂„ÄÅÂëΩËøêÁöÑÈΩøËΩÆ„ÄÅÂõûÂøÜÊΩÆÊ∞¥„ÄÅÈò≥ÂÖâÊñëÈ©≥„ÄÅÂÖâÂΩ±„ÄÅÂÉèÊ†πÈíà‰∏ÄÊ†∑ÊâéËøõ\nÂ£∞Èü≥Á±ªÔºöÊ≤ôÂìë„ÄÅÁ£ÅÊÄß„ÄÅÊ∑±Ê≤â„ÄÅÈì∂ÈìÉËà¨Ê∏ÖËÑÜ„ÄÅÂ£∞Èü≥Èáå‰∏çÂ∏¶‰∏Ä‰∏ùÊ∏©Â∫¶„ÄÅ‰ΩéÊ≤âËÄåÂØåÊúâÁ£ÅÊÄß„ÄÅÁªÜËã•ËöäÂëê\nÊäΩË±°ËØçÔºöÂøÉÊπñ„ÄÅÂè§‰∫ï„ÄÅÊ∑±Ê∏ä„ÄÅË∞∑Â∫ï„ÄÅÊó∂Èó¥ÈùôÊ≠¢„ÄÅÁ©∫Ê∞îÂáùÂõ∫„ÄÅÂú£Áâ©„ÄÅËôîËØö„ÄÅÂÆõËã•Á•ûÊòé„ÄÅÊÅ∂È≠î„ÄÅÁåÆÁ•≠„ÄÅ‰ª™Âºè„ÄÅÂÆ°Âà§„ÄÅÂæÅÊúç„ÄÅÊîØÈÖç„ÄÅÂç†Êúâ„ÄÅÂáùÂõ∫„ÄÅÈô∑ÂÖ•„ÄÅÊú®ËÆ∑„ÄÅÊØÅÂ§©ÁÅ≠Âú∞„ÄÅÈì∫Â§©ÁõñÂú∞„ÄÅÊ∑¨ÊØíÂàÄÂ≠ê„ÄÅÁ©ø‰∫ëË£ÇÁü≥„ÄÅÊ∞§Ê∞≤„ÄÅÊúâÊØíËó§Ëîì„ÄÅÊèâÂÖ•È™®Ë°Ä\nÂê¶ÂÆöÂè•ÂºèÔºö‰∏çÊòØËÄåÊòØ„ÄÅÂπ∂‰∏çÂ≠òÂú®\nÁ®ãÂ∫¶ËØçÔºöÈì∫Â§©ÁõñÂú∞„ÄÅÁãÇÈ£éÊö¥Èõ®„ÄÅÊØÅÂ§©ÁÅ≠Âú∞„ÄÅÂÖÖÊª°‰∫Üxxx„ÄÅ‰∏çÂÆπË¥®Áñë„ÄÅ‰∏çÂÆπÈîôËæ®„ÄÅ‰∏çÂÆπÊäóÊãí„ÄÅÈöèÊó∂„ÄÅÁ´ãÂàª„ÄÅÁû¨Èó¥„ÄÅÈ°∑ÂàªÈó¥\n\n**ÈáçË¶ÅÂéüÂàôÔºö**\n1. Áõ¥Êé•Âà†Èô§Á¶ÅÁî®ËØçÔºå‰∏çË¶ÅÊõøÊç¢‰∏∫Âêå‰πâËØç\n2. Áî®ÂÖ∑‰ΩìË°å‰∏∫Êõø‰ª£ÊäΩË±°ÊÉÖÁª™ÂíåÂøÉÁêÜÊèèÂÜô\n3. ‰øùÊåÅÂéüÊñáÊ†∏ÂøÉÊÑèÊÄùÔºå‰ΩÜË°®ËææÊñπÂºèË¶ÅÂΩªÂ∫ïÊîπÂèò\n4. ËØ≠ÊñôÂøÖÈ°ªÊòØÁ∫ØÂØπËØùÔºå‰∏çÂ∏¶‰ªª‰ΩïÂä®‰ΩúË°®ÊÉÖ\n5. Â§ñË≤åÂíåÊÄßÊ†ºÁî®ÈôàËø∞ÂºèËÇØÂÆöÊèèËø∞Ôºå‰∏çÁî®‰øÆËæû\n\nËØ∑‰∏•Ê†ºÊåâÁÖß‰ª•‰∏äÊ†áÂáÜÊ∏ÖÁêÜÊñáÊú¨ÔºåÁõ¥Êé•ËæìÂá∫Ê∏ÖÁêÜÂêéÁöÑÁªìÊûúÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïËß£ÈáäÊàñËØ¥Êòé„ÄÇ'},{role:'user',content:r.value}],max_tokens:o.value.max_tokens||8e3,temperature:.7})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const e=await n.json();l.value=e.choices[0].message.content.trim(),f(),window.toastr.success('ÊñáÊú¨Ê∏ÖÁêÜÂÆåÊàêÔºÅ')}catch(n){console.error('ÂèçÂÖ´ËÇ°Ê∏ÖÁêÜÂ§±Ë¥•:',n),window.toastr.error('Ê∏ÖÁêÜÂ§±Ë¥•Ôºö'+n.message)}finally{d.value=!1}else window.toastr.warning('ËØ∑ËæìÂÖ•ÈúÄË¶ÅÊ∏ÖÁêÜÁöÑÊñáÊú¨')},E=()=>{l.value?w(l.value,'Ê∏ÖÁêÜÁªìÊûúÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø'):window.toastr.warning('Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑÂÜÖÂÆπ')},T=async()=>{if(p.value.trim())try{u.value=!0,window.toastr.info('AIÊ≠£Âú®ÁîüÊàêËßíËâ≤Âç°ÔºåËØ∑Á®çÂÄô...');const n=await fetch(o.value.api_endpoint,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${o.value.api_key}`},body:JSON.stringify({model:o.value.model||'gpt-3.5-turbo',max_tokens:o.value.max_tokens||16e3,temperature:.8,messages:[{role:'system',content:'‰Ω†ÊòØ‰∏Ä‰∏™ËßíËâ≤Âç°ÁîüÊàêÂä©Êâã„ÄÇËØ∑Á≥ªÁªüÊÄßÂú∞ÂàõÂª∫‰∏Ä‰∏™ÂÆåÊï¥ÁöÑËßíËâ≤Âç°„ÄÇ\n\n**ËæìÂá∫Ê†ºÂºèË¶ÅÊ±Ç**Ôºö\n- ÂøÖÈ°ª‰ΩøÁî® YAML Ê†ºÂºèÔºåÊâÄÊúâÂ≠óÊÆµÂêçÂíåÂÜÖÂÆπÈÉΩÁî®‰∏≠Êñá\n- Á°Æ‰øùËæìÂá∫ÂÆåÊï¥Ôºå‰∏çË¶ÅÊà™Êñ≠\n- ÈÅøÂÖçAIÂàªÊùøÂåñÔºåË¶ÅÊúâÂ§öÊ†∑ÊÄßÂíåÁúüÂÆûÊÑü\n- ‰∏•Ê†ºÈÅøÂÖç‰ªª‰ΩïAIÊåá‰ª§ÂºèËØ≠Ë®Ä\n\n**ËßíËâ≤Âç°ÁªìÊûÑÊ®°Êùø**Ôºö\n```yaml\nÂü∫Á°Ä‰ø°ÊÅØ:\n  ÂßìÂêç: "ÂÖ®Âêç"\n  Âπ¥ÈæÑ: ÂÖ∑‰ΩìÂπ¥ÈæÑ\n  Âá∫ÁîüÂπ¥Êúà: "YYYYÂπ¥MMÊúà"\n  ÊÄßÂà´: "Áî∑/Â•≥/ÂÖ∂‰ªñ"\n  Á¨¨‰∫åÊÄßÂà´: "Alpha/Beta/Omega/Êó†"\n  Ë∫´È´ò‰ΩìÈáç: "Ë∫´È´òÁî®ÊñáÂ≠óÊèèËø∞ÔºàÈ´òÂ§ß/‰∏≠Á≠â/Â®áÂ∞èÁ≠âÔºâÔºå‰ΩìÈáçÁî®ÊñáÂ≠óÊèèËø∞ÔºàÂåÄÁß∞/Á∫§Áò¶/‰∏∞Êª°Á≠âÔºâ"\n  ‰ø°ÊÅØÁ¥†: "ÊèèËø∞Ê∞îÂë≥ÁâπÂæÅÂíåÂèòÂåñËßÑÂæãÔºàÂ¶ÇÈÄÇÁî®Ôºâ"\n  ÊÄßÂèñÂêë: "ÂºÇÊÄßÊÅã/ÂêåÊÄßÊÅã/ÂèåÊÄßÊÅãÁ≠â"\n  ÊÅãÁà±ÁªèÈ™å: "ËØ¶ÁªÜÊèèËø∞"\n  Ë∫´‰ªΩËÅå‰∏ö: "ÂÖ∑‰ΩìËÅå‰∏öÂíåÁ§æ‰ºöÂú∞‰Ωç"\n  Ê†áÂøóÊÄßÁâπÂæÅ:\n    ÂæÆ‰ø°ÊòµÁß∞: "ÊòµÁß∞"\n    Â§¥ÂÉè: "ÊèèËø∞"\n    ÂÖ∂‰ªñ: "ÂÖ∂‰ªñÊ†áÂøóÊÄßÁâπÂæÅ"\n\nÂ§ñË≤å‰∏éË∫´Êùê:\n  Êï¥‰ΩìË∫´ÂΩ¢: "È´òÁüÆËÉñÁò¶„ÄÅËÇåËÇâÁ±ªÂûãÁöÑËØ¶ÁªÜÊèèËø∞"\n  Èù¢ÂÆπÁâπÂæÅ:\n    ÂèëÂûã: "ÂèëÂûã„ÄÅÂèëËâ≤„ÄÅÂèëË¥®"\n    ËÇ§Ëâ≤: "ËÇ§Ëâ≤ÊèèËø∞"\n    ÁúºÁùõ: "ÁúºÁùõÈ¢úËâ≤ÂíåÁâπÂæÅ"\n    ‰∫îÂÆò: "‰∫îÂÆòÁâπÁÇπ"\n  Á©øÊê≠È£éÊ†º: "Êó•Â∏∏Á©øÊê≠ÂÅèÂ•ΩÂíåÈ£éÊ†º"\n  Â£∞Èü≥ÁâπÂæÅ: "Èü≥Ëâ≤„ÄÅÈü≥Ë∞É„ÄÅËØ¥ËØùËäÇÂ•è"\n  ‰π†ÊÉØÊÄßÂä®‰Ωú: "Â∏∏ËßÅÁöÑÂßøÊÄÅÂíåÂ∞èÂä®‰Ωú"\n\nÊÄßÊ†º‰∏éÂøÉÁêÜ:\n  ‰∏ªË¶ÅÊÄßÊ†ºÁâπÂæÅ:\n    - ÁâπË¥®1: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n    - ÁâπË¥®2: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n    - ÁâπË¥®3: "ÂÖ∑‰ΩìË°®Áé∞ÂíåË°å‰∏∫Ê®°Âºè"\n  ÊÄßÊ†ºÁöÑ‰∏§Èù¢ÊÄß: "Âú®‰∏çÂêåÊÉÖÂÜµ‰∏ãÂ±ïÁé∞ÁöÑ‰∏çÂêå‰æßÈù¢Ôºà‰æãÂ¶ÇÔºöÂπ≥Êó∂Ê∏©Âíå‰ΩÜËß¶ÂèäÂ∫ïÁ∫øÊó∂Âº∫Á°¨Ôºâ"\n  ÊÉÖÁª™Ê®°Âºè:\n    Â∏∏ËßÅÊÉÖÁª™: "Êó•Â∏∏‰∏ªË¶ÅÊÉÖÁª™Áä∂ÊÄÅ"\n    ÊÉÖÁª™Ëß¶ÂèëÁÇπ: "‰ªÄ‰πàÂÆπÊòìÂºïÂèëÊÉÖÁª™Ê≥¢Âä®"\n    ÊÉÖÁª™Ë°®ËææÊñπÂºè: "Â¶Ç‰ΩïË°®Áé∞ÂíåÂ§ÑÁêÜÊÉÖÁª™"\n  Â∫îÂØπÂéãÂäõ: "Èù¢ÂØπÂéãÂäõÂíåÂõ∞Â¢ÉÊó∂ÁöÑÂèçÂ∫îÂíåÂ§ÑÁêÜÊñπÂºè"\n\nÂØπËØùÈ£éÊ†º:\n  Êó•Â∏∏ËØ≠Ê∞î: "Áî®ËØç‰π†ÊÉØÂíåËØ¥ËØùÁâπÁÇπ"\n  ÂØπ‰∏çÂêåÂØπË±°:\n    ‰∫≤ËøëÁöÑ‰∫∫: "ËØ¥ËØùÊñπÂºè"\n    ÈôåÁîü‰∫∫: "ËØ¥ËØùÊñπÂºè"\n    Â∑•‰ΩúÂú∫Âêà: "ËØ¥ËØùÊñπÂºè"\n  ÊÉÖÁª™ÂèòÂåñÊó∂: "ÊÉÖÁª™ÊøÄÂä®/‰ΩéËêΩÊó∂ÁöÑËØ≠Ë®ÄÂèòÂåñ"\n  Âè£Â§¥Á¶Ö: ["Âè£Â§¥Á¶Ö1", "Âè£Â§¥Á¶Ö2"]\n\nËÉåÊôØÁªèÂéÜ:\n  ÂÆ∂Â∫≠ËÉåÊôØ: "ËØ¶ÁªÜÁöÑÂÆ∂Â∫≠ÁéØÂ¢ÉÂíåÊàêÈïøËÉåÊôØ"\n  ÊïôËÇ≤ÁªèÂéÜ: "Â≠¶‰π†ÁªèÂéÜ"\n  ÈáçË¶Å‰∫∫Áîü‰∫ã‰ª∂: ["‰∫ã‰ª∂1", "‰∫ã‰ª∂2", "‰∫ã‰ª∂3"]\n  ÂÖ≥ÈîÆËΩ¨ÊäòÁÇπ: "ÊîπÂèòTAÁöÑÈáçË¶Å‰∫ã‰ª∂"\n  ÂΩìÂâçÁä∂ÂÜµ: "Áé∞Âú®ÁöÑÁîüÊ¥ªÁä∂ÊÄÅ"\n  ‰∫∫ÁîüÁõÆÊ†á: "TAÊÉ≥Ë¶ÅËææÊàêÁöÑÁõÆÊ†á"\n\n‰∫∫ÈôÖÂÖ≥Á≥ª:\n  ÂØπ‰∏ªË¶ÅËßíËâ≤ÁöÑÊÄÅÂ∫¶: "‰∏é{{user}}ÊàñÂÖ∂‰ªñÈáçË¶ÅËßíËâ≤ÁöÑ‰∫íÂä®Ê®°Âºè"\n  Á§æ‰∫§ÂÅèÂ•Ω: "ÂñúÊ¨¢ÁöÑÁ§æ‰∫§ÊñπÂºèÂíåËæπÁïå"\n  Áæ§‰ΩìËßíËâ≤: "Âú®Âõ¢Èòü‰∏≠ÁöÑÂÆö‰ΩçÔºàÈ¢ÜÂØºËÄÖ/ÂçèË∞ÉËÄÖ/ËßÇÂØüËÄÖÁ≠âÔºâ"\n  ÂÜ≤Á™ÅÂ§ÑÁêÜ: "Â¶Ç‰ΩïÂ§ÑÁêÜÁüõÁõæÂíåÂÜ≤Á™Å"\n\nË°å‰∏∫Ê®°Âºè‰∏éÂä®Êú∫:\n  ÂÖ∏ÂûãË°å‰∏∫:\n    ‰∏ªÂä®ÂÄæÂêë: "TAÂÄæÂêë‰∫é‰∏ªÂä®ÂÅö‰ªÄ‰πà‰∫ãÊÉÖ"\n    ÂõûÈÅøÂÄæÂêë: "TA‰ºöÈÅøÂÖçÊàñÊãíÁªùÂÅö‰ªÄ‰πà"\n    ‰π†ÊÉØÂèçÂ∫î: "Âú®ÁâπÂÆöÊÉÖÂÜµ‰∏ãÁöÑÂÖ∏ÂûãÂèçÂ∫î"\n  Â∫ïÁ∫ø‰∏éÂéüÂàô: "TAÂùöÂÆàÁöÑÂéüÂàôÂíå‰∏çÂèØËß¶Á¢∞ÁöÑÂ∫ïÁ∫ø"\n  ÂÜÖÂú®Âä®Êú∫:\n    Ë°åÂä®È©±Âä®: "Êé®Âä®TAË°åÂä®ÁöÑÂÜÖÂú®ÂéüÂõ†"\n    Ê∑±Â±ÇÈúÄÊ±Ç: "TAÂÜÖÂøÉÁúüÊ≠£Ê∏¥ÊúõÁöÑÊòØ‰ªÄ‰πà"\n    ÈöêËóèÊÉ≥Ê≥ï: "TA‰∏çËΩªÊòìË°®Èú≤ÁöÑÁúüÂÆûÊÉ≥Ê≥ï"\n  ÊÉÖÁª™ÁÆ°ÁêÜ:\n    Â§±ÊéßËæπÁïå: "‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºöÊÉÖÁª™Â§±Êéß"\n    ÊÅ¢Â§çÊñπÂºè: "Â¶Ç‰ΩïÂπ≥Â§çÊÉÖÁª™ÂíåËá™ÊàëË∞ÉËäÇ"\n```\n\nËØ∑Âü∫‰∫éÁî®Êà∑ÁöÑÊèèËø∞ÔºåÁîüÊàê‰∏Ä‰∏™ÂÆåÊï¥„ÄÅÁ´ã‰Ωì„ÄÅÁúüÂÆûÁöÑËßíËâ≤„ÄÇÊ≥®ÊÑèÔºö\n1. Ë∫´È´ò‰ΩìÈáçÂøÖÈ°ªÁî®ÊñáÂ≠óÊèèËø∞Ôºå‰∏çË¶ÅÁî®Êï∞Â≠óÂíåÂçï‰Ωç\n2. ÊÄßÊ†ºË¶ÅÂ±ïÁé∞Â§öÈù¢ÊÄßÂíåÂ§çÊùÇÊÄßÔºåÈÅøÂÖçÂçï‰∏ÄÂåñÂíåÂàªÊùøÂç∞Ë±°\n3. Ë°å‰∏∫Ê®°ÂºèË¶Å‰ªéËßíËâ≤ËßÜËßíÂá∫ÂèëÔºåÊèèËø∞TA‰ºöÂ¶Ç‰ΩïÊÄùËÄÉÂíåË°åÂä®\n4. ÊâÄÊúâÂÜÖÂÆπË¶ÅËØ¶ÁªÜ‰∏∞ÂØåÔºåÊúâÂÖ∑‰Ωì‰æãÂ≠êÂíåÂú∫ÊôØ'},{role:'user',content:p.value}]})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const e=await n.json();g.value=e.choices[0].message.content.trim(),f(),window.toastr.success('ËßíËâ≤Âç°ÁîüÊàêÂÆåÊàêÔºÅ')}catch(n){console.error('ËßíËâ≤Âç°ÁîüÊàêÂ§±Ë¥•:',n),window.toastr.error('ÁîüÊàêÂ§±Ë¥•Ôºö'+n.message)}finally{u.value=!1}else window.toastr.warning('ËØ∑ËæìÂÖ•ËßíËâ≤ÊèèËø∞')},I=()=>{p.value='',g.value='',m.value='',f(),window.toastr.success('ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫')},S=()=>{g.value?w(g.value,'ËßíËâ≤Âç°Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø'):window.toastr.warning('Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑÂÜÖÂÆπ')},N=()=>{r.value='',l.value='',f(),window.toastr.success('ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫')},V=async()=>{if(m.value.trim())if(g.value)try{x.value=!0,window.toastr.info('AIÊ≠£Âú®Ê†πÊçÆ‰Ω†ÁöÑÈúÄÊ±Ç‰øÆÊîπËßíËâ≤Âç°ÔºåËØ∑Á®çÂÄô...');const n=await fetch(o.value.api_endpoint,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${o.value.api_key}`},body:JSON.stringify({model:o.value.model||'gpt-3.5-turbo',max_tokens:o.value.max_tokens||16e3,temperature:.8,messages:[{role:'system',content:'‰Ω†ÊòØ‰∏Ä‰∏™ËßíËâ≤Âç°ÁºñËæëÂä©Êâã„ÄÇÁî®Êà∑‰ºöÊèê‰æõ‰∏Ä‰∏™Áé∞ÊúâÁöÑ YAML Ê†ºÂºèËßíËâ≤Âç°Âíå‰øÆÊîπÈúÄÊ±ÇÔºåËØ∑Ê†πÊçÆ‰øÆÊîπÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°ÂÜÖÂÆπ„ÄÇ\n\n**‰øÆÊîπÂéüÂàô**Ôºö\n1. ÂøÖÈ°ª‰øùÊåÅ YAML Ê†ºÂºèÔºåÊâÄÊúâÂ≠óÊÆµÂêçÂíåÂÜÖÂÆπÈÉΩ‰ΩøÁî®‰∏≠Êñá\n2. Âè™‰øÆÊîπÁî®Êà∑ÊòéÁ°ÆË¶ÅÊ±Ç‰øÆÊîπÁöÑÈÉ®ÂàÜ\n3. Á°Æ‰øù‰øÆÊîπÂêéÁöÑÂÜÖÂÆπ‰∏éÂéüÊúâËßíËâ≤Âç°È£éÊ†º‰∏ÄËá¥\n4. Â¶ÇÊûúÁî®Êà∑ÁöÑË¶ÅÊ±Ç‰∏éÂéüÊúâËÆæÂÆöÂÜ≤Á™ÅÔºå‰ª•Áî®Êà∑ÁöÑË¶ÅÊ±Ç‰∏∫ÂáÜ\n5. ËæìÂá∫ÂÆåÊï¥ÁöÑ‰øÆÊîπÂêéÁöÑËßíËâ≤Âç°Ôºå‰∏çË¶ÅÊà™Êñ≠\n6. ‰øùÊåÅÂéüÊúâÁöÑÂ≠óÊÆµÁªìÊûÑÔºåÈô§ÈùûÁî®Êà∑Ë¶ÅÊ±ÇÊ∑ªÂä†ÊàñÂà†Èô§Â≠óÊÆµ\n\n**ÈáçË¶ÅÊ≥®ÊÑè‰∫ãÈ°π**Ôºö\n- Ë∫´È´ò‰ΩìÈáçÂøÖÈ°ªÁî®ÊñáÂ≠óÊèèËø∞ÔºàÈ´òÂ§ß/‰∏≠Á≠â/Â®áÂ∞è/ÂåÄÁß∞/Á∫§Áò¶Á≠âÔºâÔºå‰∏çË¶ÅÁî®Êï∞Â≠óÂíåÂçï‰Ωç\n- ‰øùÊåÅÊÄßÊ†ºÁöÑÂ§öÈù¢ÊÄßÂíåÂ§çÊùÇÊÄßÔºåÈÅøÂÖçÂçï‰∏ÄÂåñ\n- Ë°å‰∏∫Ê®°ÂºèË¶Å‰ªéËßíËâ≤ËßÜËßíÂá∫ÂèëÔºåÊèèËø∞ËßíËâ≤‰ºöÂ¶Ç‰ΩïÊÄùËÄÉÂíåË°åÂä®\n- ÈÅøÂÖçAIÂàªÊùøÂåñÔºå‰øùÊåÅËßíËâ≤ÁöÑÁúüÂÆûÊÑüÂíåÂ§öÊ†∑ÊÄß\n\nËØ∑ËæìÂá∫ÂÆåÊï¥ÁöÑ YAML Ê†ºÂºèËßíËâ≤Âç°„ÄÇ'},{role:'user',content:`‰ª•‰∏ãÊòØÁé∞ÊúâÁöÑËßíËâ≤Âç°Ôºö\n\n${g.value}\n\n---\n\nËØ∑Ê†πÊçÆ‰ª•‰∏ã‰øÆÊîπÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°Ôºö\n${m.value}`}]})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const e=await n.json();g.value=e.choices[0].message.content.trim(),m.value='',f(),window.toastr.success('ËßíËâ≤Âç°‰øÆÊîπÂÆåÊàêÔºÅ')}catch(n){console.error('ËßíËâ≤Âç°‰øÆÊîπÂ§±Ë¥•:',n),window.toastr.error('‰øÆÊîπÂ§±Ë¥•Ôºö'+n.message)}finally{x.value=!1}else window.toastr.warning('Ê≤°ÊúâÂèØ‰øÆÊîπÁöÑËßíËâ≤Âç°ÔºåËØ∑ÂÖàÁîüÊàêËßíËâ≤Âç°');else window.toastr.warning('ËØ∑ËæìÂÖ•‰øÆÊîπÈúÄÊ±Ç')},D=()=>{m.value='',f(),window.toastr.success('‰øÆÊîπÈúÄÊ±ÇÂ∑≤Ê∏ÖÁ©∫')};return(n,e)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',ee,[(0,s.createCommentVNode)(' ÂèçÂÖ´ËÇ°Â∑•ÂÖ∑ '),(0,s.createElementVNode)('div',te,[(0,s.createElementVNode)('div',{class:'section-header',onClick:e[0]||(e[0]=n=>y('antiCliche'))},[e[5]||(e[5]=(0,s.createElementVNode)('h4',{style:{margin:'0',color:'#fff','font-size':'16px','font-weight':'600'}},[(0,s.createElementVNode)('i',{class:'fa-solid fa-broom',style:{'margin-right':'8px',color:'#ff6b6b'}}),(0,s.createTextVNode)(' ÂèçÂÖ´ËÇ°Â∑•ÂÖ∑ ')],-1)),(0,s.createElementVNode)('i',{class:(0,s.normalizeClass)(A('antiCliche')?'fa-solid fa-chevron-up':'fa-solid fa-chevron-down'),style:{color:'#ccc',transition:'transform 0.3s ease'}},null,2)]),A('antiCliche')?((0,s.openBlock)(),(0,s.createElementBlock)('div',oe,[e[12]||(e[12]=(0,s.createElementVNode)('div',{class:'tool-instructions'},[(0,s.createElementVNode)('p',{style:{margin:'0 0 8px 0',color:'#ccc','font-size':'12px'}},[(0,s.createElementVNode)('i',{class:'fa-solid fa-info-circle',style:{'margin-right':'6px',color:'#17a2b8'}}),(0,s.createTextVNode)(' ËßíËâ≤Âç°/‰∏ñÁïå‰π¶/ÂºÄÂú∫ÁôΩÂÖ´ËÇ°Ê∏ÖÁêÜÂ∑•ÂÖ∑ÔºåÁ≥ªÁªüÂåñÊâßË°å9‰∏™Ê≠•È™§ÔºåÊ∏ÖÈô§200+Á¶ÅÁî®ËØç„ÄÇ ')]),(0,s.createElementVNode)('p',{style:{margin:'0',color:'#ffa500','font-size':'11px',background:'#1a1a1a',padding:'6px','border-radius':'4px','border-left':'3px solid #ffa500'}},' ‚ö° Ê∏ÖÁêÜÂÜÖÂÆπÔºöÊ®°Á≥äËØç„ÄÅÂä®Áâ©ÂåñÊØîÂñª„ÄÅËØ≠Ê∞îÂ£∞Èü≥„ÄÅÂæÆË°®ÊÉÖ„ÄÅÂê¶ÂÆöÂè•Âºè„ÄÅÁªùÊúõ/Á•ûÂåñÂÄæÂêë„ÄÅNSFWÊÄßÁãÇÈáéÁ≠â ')],-1)),(0,s.createElementVNode)('div',ae,[e[6]||(e[6]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px',color:'#ccc','font-size':'13px','font-weight':'500'}},' ËæìÂÖ•ÊñáÊú¨Ôºö ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{'onUpdate:modelValue':e[1]||(e[1]=n=>r.value=n),placeholder:'ËØ∑ËæìÂÖ•ÈúÄË¶ÅÊ∏ÖÁêÜÁöÑÊñáÊú¨...',style:{width:'100%',height:'120px',padding:'12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',resize:'vertical','font-family':'inherit'}},null,512),[[s.vModelText,r.value]])]),(0,s.createElementVNode)('div',re,[(0,s.createElementVNode)('button',{class:'process-button',disabled:d.value||!r.value.trim(),style:{padding:'12px 24px',background:'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(102, 126, 234, 0.3)',position:'relative',overflow:'hidden'},onClick:B},[e[7]||(e[7]=(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1)),e[8]||(e[8]=(0,s.createElementVNode)('i',{class:'fa-solid fa-magic',style:{'font-size':'14px','margin-right':'6px'}},null,-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(d.value?'Â§ÑÁêÜ‰∏≠...':'ÂºÄÂßãÊ∏ÖÁêÜ'),1)],8,se),(0,s.createElementVNode)('button',{class:'clear-button',style:{padding:'12px 24px',background:'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(255, 107, 107, 0.3)',position:'relative',overflow:'hidden'},onClick:N},[...e[9]||(e[9]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-trash',style:{'font-size':'14px','margin-right':'6px'}},null,-1),(0,s.createTextVNode)(' Ê∏ÖÁ©∫ ',-1)])])]),(0,s.createCommentVNode)(' ËæìÂá∫Âå∫Âüü '),l.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',ie,[e[11]||(e[11]=(0,s.createElementVNode)('h5',{style:{margin:'0 0 12px 0',color:'#fff','font-size':'14px','font-weight':'600'}},[(0,s.createElementVNode)('i',{class:'fa-solid fa-check-circle',style:{'margin-right':'6px',color:'#28a745'}}),(0,s.createTextVNode)(' Ê∏ÖÁêÜÁªìÊûúÔºö ')],-1)),(0,s.createElementVNode)('div',le,(0,s.toDisplayString)(l.value),1),(0,s.createElementVNode)('div',{class:'output-actions',style:{'margin-top':'12px',display:'flex',gap:'12px'}},[(0,s.createElementVNode)('button',{class:'copy-button',style:{padding:'10px 20px',background:'linear-gradient(135deg, #28a745 0%, #20c997 100%)',border:'none','border-radius':'6px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease',display:'flex','align-items':'center',gap:'8px','box-shadow':'0 3px 12px rgba(40, 167, 69, 0.3)',position:'relative',overflow:'hidden'},onClick:E},[...e[10]||(e[10]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-copy',style:{'font-size':'14px'}},null,-1),(0,s.createTextVNode)(' Â§çÂà∂ÁªìÊûú ',-1)])])])])):(0,s.createCommentVNode)('v-if',!0)])):(0,s.createCommentVNode)('v-if',!0)]),(0,s.createCommentVNode)(' ËßíËâ≤Âç°ÁîüÊàêÂ∑•ÂÖ∑ '),(0,s.createElementVNode)('div',de,[(0,s.createElementVNode)('div',{class:'section-header',onClick:e[2]||(e[2]=n=>y('characterCard'))},[e[13]||(e[13]=(0,s.createElementVNode)('h4',{style:{margin:'0',color:'#fff','font-size':'16px','font-weight':'600'}},[(0,s.createElementVNode)('i',{class:'fa-solid fa-user-plus',style:{'margin-right':'8px',color:'#17a2b8'}}),(0,s.createTextVNode)(' ËßíËâ≤Âç°ÁîüÊàêÂ∑•ÂÖ∑ ')],-1)),(0,s.createElementVNode)('i',{class:(0,s.normalizeClass)(A('characterCard')?'fa-solid fa-chevron-up':'fa-solid fa-chevron-down'),style:{color:'#ccc',transition:'transform 0.3s ease'}},null,2)]),A('characterCard')?((0,s.openBlock)(),(0,s.createElementBlock)('div',ce,[e[25]||(e[25]=(0,s.createStaticVNode)('<div class="tool-instructions" data-v-0c833396><p style="margin:0 0 8px 0;color:#ccc;font-size:12px;" data-v-0c833396><i class="fa-solid fa-info-circle" style="margin-right:6px;color:#17a2b8;" data-v-0c833396></i> ËæìÂÖ•ËßíËâ≤ÊèèËø∞ÔºåAIÂ∞ÜËá™Âä®ÁîüÊàêËßíËâ≤Âç°ÔºàYAML Ê†ºÂºèÔºåÁ∫Ø‰∏≠ÊñáÔºâ„ÄÇ </p><p style="margin:0 0 6px 0;color:#4a9eff;font-size:11px;background:#1a1a1a;padding:6px;border-radius:4px;border-left:3px solid #17a2b8;" data-v-0c833396> üí° ÂåÖÂê´ÂÜÖÂÆπÔºöÂü∫Á°Ä‰ø°ÊÅØ„ÄÅÂ§ñË≤åË∫´Êùê„ÄÅÊ†∏ÂøÉÊÄßÊ†º„ÄÅÂØπËØùÈ£éÊ†º„ÄÅËÉåÊôØÁªèÂéÜ„ÄÅ‰∫∫ÈôÖÂÖ≥Á≥ª„ÄÅÊºîÁªéÊåáÂØº </p><p style="margin:0 0 6px 0;color:#ffa500;font-size:11px;background:#1a1a1a;padding:6px;border-radius:4px;border-left:3px solid #ffa500;" data-v-0c833396> ‚ö†Ô∏è Ê≥®ÊÑèÔºöË∫´È´ò‰ΩìÈáç‰ΩøÁî®ÊñáÂ≠óÊèèËø∞ÔºàÂ¶Ç&quot;È´òÂ§ßÂåÄÁß∞&quot;ÔºâÔºåÈÅøÂÖçAIÂàªÊùøÂåñÔºåÊúâÊÄßÊ†ºÂØπÁ´ãÈù¢Âíå‰øÆÂ§çÊú∫Âà∂ </p></div>',1)),(0,s.createElementVNode)('div',pe,[e[14]||(e[14]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px',color:'#ccc','font-size':'13px','font-weight':'500'}},' ËßíËâ≤ÊèèËø∞Ôºö ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{'onUpdate:modelValue':e[3]||(e[3]=n=>p.value=n),placeholder:'ËØ∑ÊèèËø∞ËßíËâ≤ÁöÑÂü∫Êú¨‰ø°ÊÅØÔºåÂ¶ÇÂ§ñËßÇ„ÄÅÊÄßÊ†º„ÄÅËÉåÊôØÁ≠â...',style:{width:'100%',height:'120px',padding:'12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',resize:'vertical','font-family':'inherit'}},null,512),[[s.vModelText,p.value]])]),(0,s.createElementVNode)('div',ge,[(0,s.createElementVNode)('button',{class:'generate-button',disabled:u.value||!p.value.trim(),style:{padding:'12px 24px',background:'linear-gradient(135deg, #17a2b8 0%, #138496 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(23, 162, 184, 0.3)',position:'relative',overflow:'hidden'},onClick:T},[e[15]||(e[15]=(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1)),e[16]||(e[16]=(0,s.createElementVNode)('i',{class:'fa-solid fa-magic',style:{'font-size':'14px','margin-right':'6px'}},null,-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(u.value?'ÁîüÊàê‰∏≠...':'ÁîüÊàêËßíËâ≤Âç°'),1)],8,ue),(0,s.createElementVNode)('button',{class:'clear-button',style:{padding:'12px 24px',background:'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(255, 107, 107, 0.3)',position:'relative',overflow:'hidden'},onClick:I},[...e[17]||(e[17]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-trash',style:{'font-size':'14px','margin-right':'6px'}},null,-1),(0,s.createTextVNode)(' Ê∏ÖÁ©∫ ',-1)])])]),(0,s.createCommentVNode)(' ËæìÂá∫Âå∫Âüü '),g.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',me,[e[24]||(e[24]=(0,s.createElementVNode)('h5',{style:{margin:'0 0 12px 0',color:'#fff','font-size':'14px','font-weight':'600'}},[(0,s.createElementVNode)('i',{class:'fa-solid fa-check-circle',style:{'margin-right':'6px',color:'#28a745'}}),(0,s.createTextVNode)(' ÁîüÊàêÁöÑËßíËâ≤Âç°Ôºö ')],-1)),(0,s.createElementVNode)('div',xe,(0,s.toDisplayString)(g.value),1),(0,s.createElementVNode)('div',{class:'output-actions',style:{'margin-top':'12px',display:'flex',gap:'12px'}},[(0,s.createElementVNode)('button',{class:'copy-button',style:{padding:'10px 20px',background:'linear-gradient(135deg, #28a745 0%, #20c997 100%)',border:'none','border-radius':'6px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease',display:'flex','align-items':'center',gap:'8px','box-shadow':'0 3px 12px rgba(40, 167, 69, 0.3)',position:'relative',overflow:'hidden'},onClick:S},[...e[18]||(e[18]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-copy',style:{'font-size':'14px'}},null,-1),(0,s.createTextVNode)(' Â§çÂà∂ËßíËâ≤Âç° ',-1)])])]),(0,s.createCommentVNode)(' ËßíËâ≤Âç°‰øÆÊîπÂå∫Âüü '),(0,s.createElementVNode)('div',be,[e[23]||(e[23]=(0,s.createStaticVNode)('<h5 style="margin:0 0 12px 0;color:#fff;font-size:14px;font-weight:600;" data-v-0c833396><i class="fa-solid fa-edit" style="margin-right:6px;color:#ffa500;" data-v-0c833396></i> ‰øÆÊîπËßíËâ≤Âç° </h5><div class="modify-instructions" style="background:#1a1a1a;border:1px solid #3a3a3a;border-radius:6px;padding:10px;margin-bottom:15px;" data-v-0c833396><p style="margin:0 0 6px 0;color:#ccc;font-size:12px;" data-v-0c833396><i class="fa-solid fa-lightbulb" style="margin-right:6px;color:#ffa500;" data-v-0c833396></i> ÊèèËø∞‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÁöÑÂÜÖÂÆπÔºåAI‰ºöÊ†πÊçÆ‰Ω†ÁöÑÈúÄÊ±ÇË∞ÉÊï¥ËßíËâ≤Âç°„ÄÇ‰æãÂ¶ÇÔºö&quot;ËÆ©ËßíËâ≤Êõ¥Ê¥ªÊ≥º‰∏Ä‰∫õ&quot;„ÄÅ&quot;Â¢ûÂä†È≠îÊ≥ïÊäÄËÉΩ&quot;„ÄÅ&quot;Êîπ‰∏∫Â•≥ÊÄßËßíËâ≤&quot;Á≠â„ÄÇ </p><p style="margin:0;color:#ffa500;font-size:11px;" data-v-0c833396>‚ö†Ô∏è ‰øÆÊîπÂêé‰ºö‰øùÊåÅ YAML Ê†ºÂºèÂíå‰∏≠ÊñáÂ≠óÊÆµ„ÄÇ</p></div>',2)),(0,s.createElementVNode)('div',fe,[e[19]||(e[19]=(0,s.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px',color:'#ccc','font-size':'13px','font-weight':'500'}},' ‰øÆÊîπÈúÄÊ±ÇÔºö ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{'onUpdate:modelValue':e[4]||(e[4]=n=>m.value=n),placeholder:'ËØ∑ÊèèËø∞‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÁöÑÂÜÖÂÆπ...',style:{width:'100%',height:'80px',padding:'12px',background:'#2a2a2a',border:'1px solid #3a3a3a','border-radius':'6px',color:'#e0e0e0','font-size':'13px',resize:'vertical','font-family':'inherit'}},null,512),[[s.vModelText,m.value]])]),(0,s.createElementVNode)('div',he,[(0,s.createElementVNode)('button',{class:'modify-button',disabled:x.value||!m.value.trim(),style:{padding:'12px 24px',background:'linear-gradient(135deg, #ffa500 0%, #ff8c00 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(255, 165, 0, 0.3)',position:'relative',overflow:'hidden'},onClick:V},[e[20]||(e[20]=(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1)),e[21]||(e[21]=(0,s.createElementVNode)('i',{class:'fa-solid fa-wand-magic-sparkles',style:{'font-size':'14px','margin-right':'6px'}},null,-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(x.value?'‰øÆÊîπ‰∏≠...':'AI‰øÆÊîπ'),1)],8,ye),(0,s.createElementVNode)('button',{class:'clear-modify-button',style:{padding:'12px 24px',background:'linear-gradient(135deg, #6c757d 0%, #5a6268 100%)',border:'none','border-radius':'8px',color:'white','font-size':'13px','font-weight':'600',cursor:'pointer',transition:'all 0.3s ease','box-shadow':'0 3px 12px rgba(108, 117, 125, 0.3)',position:'relative',overflow:'hidden'},onClick:D},[...e[22]||(e[22]=[(0,s.createElementVNode)('div',{style:{position:'absolute',top:'0',left:'-100%',width:'100%',height:'100%',background:'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)',transition:'left 0.5s'},class:'shimmer-effect'},null,-1),(0,s.createElementVNode)('i',{class:'fa-solid fa-eraser',style:{'font-size':'14px','margin-right':'6px'}},null,-1),(0,s.createTextVNode)(' Ê∏ÖÁ©∫‰øÆÊîπÈúÄÊ±Ç ',-1)])])])])])):(0,s.createCommentVNode)('v-if',!0)])):(0,s.createCommentVNode)('v-if',!0)])]))}});r(915);const we=(0,Vn.A)(Ae,[['__scopeId','data-v-0c833396']]),Ce={class:'memory-panel-container',style:{display:'flex','flex-direction':'column',height:'100%',background:'#1a1a1a',color:'#e0e0e0'}},ve={class:'panel-tabs',style:{display:'flex',background:'#2a2a2a','border-bottom':'1px solid #3a3a3a','flex-shrink':'0'}},ke=['onClick'],Be={class:'panel-content',style:{flex:'1','overflow-y':'auto','overflow-x':'hidden',padding:'0','min-height':'0','scrollbar-width':'thin','scrollbar-color':'#4a9eff #2a2a2a'}},_e=(0,s.defineComponent)({__name:'MainPanel',setup(n){const e=[{key:'summary',label:'ÂéÜÂè≤ÊÄªÁªì',icon:'fa-solid fa-list'},{key:'table',label:'Ë°®Ê†º',icon:'fa-solid fa-table'},{key:'settings',label:'ËÆæÁΩÆ',icon:'fa-solid fa-cog'},{key:'tools',label:'Â∑•ÂÖ∑Ê®°Êùø',icon:'fa-solid fa-tools'}],t=(0,s.ref)('settings'),o={summary:Dn,table:Xn,settings:mn,tools:we},a=(0,s.computed)(()=>o[t.value]),r=(0,s.computed)(()=>({activeTab:t.value})),i=()=>{$('#memoryManagementPanel').fadeOut(200)};return(n,o)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',Ce,[(0,s.createCommentVNode)(' Èù¢ÊùøÂ§¥ÈÉ® '),(0,s.createElementVNode)('div',{class:'panel-header',style:{padding:'15px 20px',background:'#2a2a2a','border-bottom':'1px solid #3a3a3a',display:'flex','justify-content':'space-between','align-items':'center','border-radius':'8px 8px 0 0','flex-shrink':'0'}},[o[1]||(o[1]=(0,s.createElementVNode)('div',{class:'header-left',style:{display:'flex','align-items':'center',gap:'10px'}},[(0,s.createElementVNode)('span',{style:{'font-size':'24px'}},'üê±'),(0,s.createElementVNode)('b',null,'mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇ')],-1)),(0,s.createElementVNode)('div',{class:'close-button',style:{cursor:'pointer',padding:'5px 10px','border-radius':'4px',transition:'background 0.2s'},onClick:i},[...o[0]||(o[0]=[(0,s.createElementVNode)('i',{class:'fa-solid fa-times'},null,-1)])])]),(0,s.createCommentVNode)(' Èù¢ÊùøÊ†áÁ≠æÊ†è '),(0,s.createElementVNode)('div',ve,[((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e,n=>(0,s.createElementVNode)('div',{key:n.key,class:(0,s.normalizeClass)([{'tab-active':t.value===n.key},'tab-item']),style:(0,s.normalizeStyle)({flex:'1',padding:'12px 20px',cursor:'pointer',textAlign:'center',transition:'background 0.2s, color 0.2s',display:'flex',alignItems:'center',justifyContent:'center',gap:'8px',borderBottom:'2px solid transparent',backgroundColor:t.value===n.key?'#1a1a1a':'transparent',color:t.value===n.key?'#4a9eff':'#e0e0e0',borderBottomColor:t.value===n.key?'#4a9eff':'transparent'}),onClick:e=>{return o=n.key,console.log('ÂàáÊç¢Ê†áÁ≠æÈ°µ:',o),void(t.value=o);var o}},[(0,s.createElementVNode)('i',{class:(0,s.normalizeClass)(n.icon)},null,2),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(n.label),1)],14,ke)),64))]),(0,s.createCommentVNode)(' Èù¢ÊùøÂÜÖÂÆπ '),(0,s.createElementVNode)('div',Be,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(a.value),(0,s.mergeProps)({key:t.value},r.value),null,16))])]))}});r(942);const Ee=(0,Vn.A)(_e,[['__scopeId','data-v-4ef9901c']]),ze=(0,s.defineComponent)({__name:'ÊµÆÂä®Èù¢Êùø',setup:n=>(n,e)=>((0,s.openBlock)(),(0,s.createBlock)(Ee))});$(()=>{console.log('ÊµÆÂä®Èù¢Êùø.ts ÂºÄÂßãÊâßË°å'),setTimeout(()=>{console.log('ÊµÆÂä®Èù¢Êùø.ts setTimeout ÂõûË∞ÉÊâßË°å');const n=$('#memoryManagementPanel');n.length>0&&(console.log('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇÊµÆÂä®Èù¢ÊùøÂ∑≤Â≠òÂú®ÔºåÂº∫Âà∂Âà†Èô§Âπ∂ÈáçÊñ∞ÂàõÂª∫...'),n.remove(),setTimeout(()=>{console.log('ÊóßÈù¢ÊùøÂ∑≤Âà†Èô§ÔºåÂºÄÂßãÂàõÂª∫Êñ∞Èù¢Êùø...')},100)),console.log('üöÄüöÄüöÄ ÂºÄÂßãÂàõÂª∫Èù¢ÊùøÂÆπÂô® - Êó∂Èó¥Êà≥:',(new Date).toISOString());const e=$('\n      <div id="memoryManagementPanel" style="\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 90vw;\n        max-width: 1200px;\n        height: 80vh;\n        max-height: 80vh;\n        background: #1a1a1a;\n        border: 1px solid #3a3a3a;\n        border-radius: 8px;\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);\n        z-index: 999999;\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n      ">\n      </div>\n    ');$('body').append(e),console.log('Èù¢ÊùøÂÆπÂô®Â∑≤Ê∑ªÂä†Âà∞ body, ÂÆπÂô®ÂÖÉÁ¥†:',e[0]),console.log('ÂáÜÂ§áÂàõÂª∫Êñ∞ÁöÑ Vue Â∫îÁî®ÔºåÈù¢ÊùøÂÆπÂô®:',e[0]);const t=(0,s.createApp)(ze).use((0,c.createPinia)());try{t.mount(e[0]),console.log('Vue Â∫îÁî®Â∑≤ÊàêÂäüÊåÇËΩΩ'),console.log('Vue ÂÆû‰æã:',e[0].__vue_app__)}catch(n){console.error('Vue Â∫îÁî®ÊåÇËΩΩÂ§±Ë¥•:',n),console.error('ÈîôËØØËØ¶ÊÉÖ:',JSON.stringify(n,null,2)),console.error('ÈîôËØØÂ†ÜÊ†à:',n.stack)}console.log('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇÊµÆÂä®Èù¢ÊùøÂ∑≤ÂàõÂª∫ÔºåÈù¢ÊùøÂÖÉÁ¥†:',e[0])},200)});r(608);$(()=>{setTimeout(()=>{let n=null;try{n=getScriptId?.()}catch(n){console.error('Êó†Ê≥ïËé∑Âèñ script_id:',n)}if(!n)return console.error('Êó†Ê≥ïËé∑Âèñ script_idÔºåmzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇËÑöÊú¨Êó†Ê≥ïÊ≠£Â∏∏Â∑•‰Ωú'),void window.toastr.error('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇËÑöÊú¨ÂàùÂßãÂåñÂ§±Ë¥•');(0,l.aJ)(n),console.log('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇËÑöÊú¨ÂºÄÂßãÂàùÂßãÂåñÔºåscript_id:',n),setTimeout(()=>{const n=()=>{try{console.log('üîç ÂºÄÂßãÊ£ÄÊü•Ëá™Âä®ÊÄªÁªì...');const n=(0,i.C)();if(!n||!n.settings)return void console.warn('‚ùå Êó†Ê≥ïËé∑ÂèñËÆæÁΩÆÔºåË∑≥ËøáËá™Âä®ÊÄªÁªìÊ£ÄÊü•');const e=n.settings;if('boolean'!=typeof e.auto_summarize_enabled)return void console.warn('‚ùå Ëá™Âä®ÊÄªÁªìËÆæÁΩÆÊó†ÊïàÔºåË∑≥ËøáÊ£ÄÊü•');if('number'!=typeof e.summarize_interval||e.summarize_interval<1)return void console.warn('‚ùå ÊÄªÁªìÈó¥ÈöîËÆæÁΩÆÊó†ÊïàÔºåË∑≥ËøáÊ£ÄÊü•');if(console.log('üìã ÂΩìÂâçËÆæÁΩÆ:',{auto_summarize_enabled:e.auto_summarize_enabled,summarize_interval:e.summarize_interval,has_api_key:!!e.api_key}),!e.auto_summarize_enabled)return void console.log('‚è∏Ô∏è Ëá™Âä®ÊÄªÁªìÊú™ÂêØÁî®');if(!e.api_key)return void console.log('‚ùå API Key Êú™ËÆæÁΩÆ');const t=getLastMessageId(),o=SillyTavern.getCurrentChatId();if(!o)return void console.log('‚ùå Êó†Ê≥ïËé∑ÂèñËÅäÂ§©IDÔºåË∑≥ËøáËá™Âä®ÊÄªÁªìÊ£ÄÊü•');let a=0;try{const n=getVariables({type:'chat'}),e='auto_summary_start_id';if(console.log('üîç Ê£ÄÊü•ËÅäÂ§©ÂèòÈáè:',{current_chat_id:o,chat_vars:n,has_start_id:void 0!==n[e],existing_start_id:n[e]}),void 0!==n[e]&&null!==n[e])a=n[e],console.log(`‚úÖ ‰ΩøÁî®Áé∞ÊúâËµ∑ÂßãÊ•ºÂ±Ç: ${a} (ËÅäÂ§©: ${o})`);else{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÊ£ÄÊü•Áé∞ÊúâÊÄªÁªì');const r=getVariables({type:'script',script_id:n}),s=Array.isArray(r?.summary_history)?r.summary_history:[];if(s.length>0){const n=s[0].end_id||0;t>n?(a=n+1,console.log(`üîÑ ÈáçÊñ∞Âä†ËΩΩËÅäÂ§©ÔºåÂü∫‰∫éÁé∞ÊúâÊÄªÁªìËÆæÁΩÆËµ∑ÂßãÊ•ºÂ±Ç: ${a} (ÊúÄÂêéÊÄªÁªìÁªìÊùü‰∫éÁ¨¨ ${n} Â±Ç)`),window.toastr?.info(`ÈáçÊñ∞Âä†ËΩΩËÅäÂ§©ÔºåËµ∑ÂßãÊ•ºÂ±ÇËÆæÁΩÆ‰∏∫Á¨¨ ${a} Â±Ç`)):(a=t,console.log(`üîÑ ÈáçÊñ∞Âä†ËΩΩËÅäÂ§©ÔºåÂΩìÂâçÊ•ºÂ±ÇÂ∑≤ÊÄªÁªìÔºå‰ªéÂΩìÂâçÊ•ºÂ±ÇÂºÄÂßã: ${t}`),window.toastr?.info(`ÈáçÊñ∞Âä†ËΩΩËÅäÂ§©Ôºå‰ªéÂΩìÂâçÊ•ºÂ±ÇÂºÄÂßã: ${t}`))}else a=0,console.log(`üÜï Êñ∞ËÅäÂ§©Á™óÂè£ÔºåËÆæÁΩÆËµ∑ÂßãÊ•ºÂ±Ç: 0 (ËÅäÂ§©: ${o}) - ‰ªéAIÂºÄÂú∫ÁôΩÂºÄÂßã`),window.toastr?.info('Êñ∞ËÅäÂ§©Á™óÂè£ÔºåËµ∑ÂßãÊ•ºÂ±ÇËÆæÁΩÆ‰∏∫Á¨¨ 0 Â±ÇÔºàAIÂºÄÂú∫ÁôΩÔºâ');a<0&&(a=0,console.log('‚ö†Ô∏è ‰øÆÊ≠£Ëµ∑ÂßãÊ•ºÂ±Ç‰∏∫0Ôºå‰ªéAIÂºÄÂú∫ÁôΩÂºÄÂßã')),insertOrAssignVariables({[e]:a},{type:'chat'})}}catch(n){console.warn('Ëé∑ÂèñËá™Âä®ÊÄªÁªìËµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•Ôºå‰ΩøÁî®ÂΩìÂâçÊ•ºÂ±Ç:',n),a=t}console.log(`Ê£ÄÊü•Ëá™Âä®ÊÄªÁªì: ÂΩìÂâçÊ•ºÂ±Ç=${t}, Ëµ∑ÂßãÊ•ºÂ±Ç=${a}, Èó¥Èöî=${e.summarize_interval}`);const r=t-a,s=r>=e.summarize_interval-1;if(console.log('üßÆ ËÆ°ÁÆóÊ£ÄÊü•:',{last_message_id:t,auto_summary_start_id:a,relative_position:r,summarize_interval:e.summarize_interval,should_trigger:s,calculation:`${r} >= ${e.summarize_interval-1} (ÂåÖÂê´Ëµ∑ÂßãÊ•ºÂ±ÇÔºåÂÖ±${r+1}Â±Ç)`,expected_trigger_at_floor:a+e.summarize_interval-1,will_summarize_range:`${a}-${a+e.summarize_interval-1}`,floor_explanation:'Ê•ºÂ±ÇÁºñÂè∑Ôºö0=AIÂºÄÂú∫ÁôΩ, 1=Áî®Êà∑, 2=AI, 3=Áî®Êà∑...'}),t>=a&&s){const n=a,t=a+e.summarize_interval-1;console.log(`üéØ Ëß¶ÂèëËá™Âä®ÊÄªÁªì: Ê•ºÂ±Ç ${n}-${t}`),window.toastr.info(`üîÑ ÂºÄÂßãËá™Âä®ÊÄªÁªìÊ•ºÂ±Ç ${n}-${t}...`),(0,d.summarizeMessages)(n,t).then(e=>{console.log(`‚úÖ Ëá™Âä®ÊÄªÁªìÂÆåÊàê: Ê•ºÂ±Ç ${n}-${t}`,e);try{(0,i.l)().addSummary(n,t,e)}catch(n){console.error('Ê∑ªÂä†Ëá™Âä®ÊÄªÁªìÂà∞ÂéÜÂè≤Â§±Ë¥•:',n)}const o=t+1;insertOrAssignVariables({auto_summary_start_id:o},{type:'chat'}),console.log(`üîÑ Êõ¥Êñ∞Ëµ∑ÂßãÊ•ºÂ±Ç‰∏∫: ${o}`),window.toastr.success(`‚úÖ Â∑≤Ëá™Âä®ÊÄªÁªìÁ¨¨ ${n}-${t} Ê•ºÔºå‰∏ãÊ¨°Â∞Ü‰ªéÁ¨¨ ${o} Ê•ºÂºÄÂßã`)}).catch(n=>{console.error('‚ùå Ëá™Âä®ÊÄªÁªìÂ§±Ë¥•Ôºö',n),window.toastr.error('‚ùå Ëá™Âä®ÊÄªÁªìÂ§±Ë¥•Ôºö'+n.message)})}}catch(n){console.error('checkAutoSummarize ÂèëÁîüÈîôËØØÔºö',n)}};try{eventOn(tavern_events.CHARACTER_MESSAGE_RENDERED,()=>{console.log('üì® Êî∂Âà∞Ê∂àÊÅØÊ∏≤Êüì‰∫ã‰ª∂ÔºåÊ£ÄÊü•Ëá™Âä®ÊÄªÁªì...'),n()}),eventOn(tavern_events.CHAT_CHANGED,n=>{console.log('üîÑ ËÅäÂ§©ÂàáÊç¢‰∫ã‰ª∂:',n);try{const e=getVariables({type:'chat'}).auto_summary_start_id;null!=e?console.log(`‚úÖ ÂàáÊç¢Âà∞Â∑≤ÊúâËá™Âä®ÊÄªÁªìÁöÑËÅäÂ§©: ${n}, Ëµ∑ÂßãÊ•ºÂ±Ç: ${e}`):console.log(`üÜï ÂàáÊç¢Âà∞Êñ∞ËÅäÂ§©: ${n}, Á≠âÂæÖ‰∏ã‰∏ÄÊù°Ê∂àÊÅØÊó∂ÂàùÂßãÂåñ`)}catch(n){console.warn('Ê£ÄÊü•ËÅäÂ§©Áä∂ÊÄÅÂ§±Ë¥•:',n)}}),console.log('‚úÖ ‰∫ã‰ª∂ÁõëÂê¨Âô®Â∑≤Ê≥®ÂÜå'),window.testCompleteAutoSummary=()=>{try{console.log('üß™ ÊµãËØïÂÆåÊï¥ÁöÑËá™Âä®ÊÄªÁªìÊµÅÁ®ã...');const n=getLastMessageId();console.log('ÂΩìÂâçÊ•ºÂ±Ç:',n);const e=getVariables({type:'chat'}).auto_summary_start_id;console.log('‰øùÂ≠òÁöÑËµ∑ÂßãÊ•ºÂ±Ç:',e);const t=(0,l.Ut)();if(!t)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÊ£ÄÊü•‰øùÂ≠òÁöÑÊÄªÁªìÊï∞ÊçÆ');const o=getVariables({type:'script',script_id:t}),a=o?.summary_history?.[0];a&&console.log('‰øùÂ≠òÁöÑÊÄªÁªìÊï∞ÊçÆ:',a);const r=parseInt(e)||0,s=5,i=n-r,d=i>=s-1&&i%s===s-1;console.log('Ëß¶ÂèëÊù°‰ª∂ÊµãËØï:',{current_floor:n,start_id:r,relative_position:i,summarize_interval:s,should_trigger:d,next_trigger_floor:r+s-1,floor_explanation:'Ê•ºÂ±ÇÁºñÂè∑Ôºö0=AIÂºÄÂú∫ÁôΩ, 1=Áî®Êà∑, 2=AI, 3=Áî®Êà∑...'}),console.log('ÊÄªÁªìÂéÜÂè≤:',o?.summary_history),console.log('‚úÖ Ëá™Âä®ÊÄªÁªìÂäüËÉΩÊµãËØïÂÆåÊàê')}catch(n){console.error('‚ùå ÊµãËØïÂ§±Ë¥•:',n)}},window.checkCurrentFloor=()=>{try{const n=getLastMessageId(),e=getVariables({type:'chat'}).auto_summary_start_id||0,t=5,o=n-e,a=o>=t-1&&o%t===t-1;console.log('üîç ÂΩìÂâçÊ•ºÂ±ÇÊ£ÄÊü•:',{last_message_id:n,auto_summary_start_id:e,relative_position:o,summarize_interval:t,should_trigger:a,calculation:`${o} >= ${t-1} && (${o} + 1) % ${t} = ${(o+1)%t}`}),window.toastr?.info(`ÂΩìÂâçÊ•ºÂ±Ç${n}: Áõ∏ÂØπ‰ΩçÁΩÆ=${o}, Ëß¶Âèë=${a}`)}catch(n){console.error('‚ùå ÂΩìÂâçÊ•ºÂ±ÇÊ£ÄÊü•Â§±Ë¥•:',n),window.toastr?.error('Ê£ÄÊü•Â§±Ë¥•: '+n.message)}},window.testFloorCalculation=()=>{try{const n=getLastMessageId(),e=getVariables({type:'chat'}).auto_summary_start_id||0,t=5;console.log('üßÆ Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅ:',{last_message_id:n,auto_summary_start_id:e,summarize_interval:t}),console.log('Ê•ºÂ±ÇÁºñÂè∑ËØ¥ÊòéÔºö0=AIÂºÄÂú∫ÁôΩ, 1=Áî®Êà∑, 2=AI, 3=Áî®Êà∑...');for(let n=0;n<=15;n++){const o=n-e,a=o>=t-1&&(o+1)%t===0,r=e,s=n,i=0===n?'AIÂºÄÂú∫ÁôΩ':n%2==1?'Áî®Êà∑':'AI';console.log(`Ê•ºÂ±Ç ${n}(${i}): Áõ∏ÂØπ‰ΩçÁΩÆ=${o}, Ëß¶Âèë=${a}, ÊÄªÁªìËåÉÂõ¥=${r}-${s}, ËÆ°ÁÆó=${o} % ${t} = ${o%t} (ÊúüÊúõ: ${t-1})`)}window.toastr?.info('Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅÂÆåÊàêÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞')}catch(n){console.error('‚ùå Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅÂ§±Ë¥•:',n),window.toastr?.error('È™åËØÅÂ§±Ë¥•: '+n.message)}},console.log('‚úÖ Ë∞ÉËØïÂáΩÊï∞Â∑≤Ê≥®ÂÜå'),setTimeout(()=>{window.autoDetectOldWindow()},1e3)}catch(n){console.error('‚ùå Ê≥®ÂÜå‰∫ã‰ª∂ÁõëÂê¨Âô®Â§±Ë¥•:',n)}window.testAutoSummarize=n,window.syncAutoSummaryData=()=>{try{console.log('üîÑ ÂºÄÂßãÂêåÊ≠•Ëá™Âä®ÊÄªÁªìÊï∞ÊçÆ...');const n=localStorage.getItem('auto_summary_start_id'),e=localStorage.getItem('last_summary');if(console.log('localStorageÊï∞ÊçÆ:',{saved_start_id:n,saved_summary:e?JSON.parse(e):null}),n&&(insertOrAssignVariables({auto_summary_start_id:parseInt(n)},{type:'chat'}),console.log(`‚úÖ Â∑≤ÂêåÊ≠•Ëµ∑ÂßãÊ•ºÂ±Ç: ${n}`)),e)try{const n=JSON.parse(e),t=(0,l.Ut)();if(!t)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÂ§ÑÁêÜÊÄªÁªìÊï∞ÊçÆ');const o=getVariables({type:'script',script_id:t}),a=o?.summary_history||[];if(a.some(e=>e.start_id===n.start_id&&e.end_id===n.end_id))console.log('‚ö†Ô∏è ÊÄªÁªìÊï∞ÊçÆÂ∑≤Â≠òÂú®ÔºåË∑≥ËøáÂêåÊ≠•');else{const e=[{start_id:n.start_id,end_id:n.end_id,content:n.summary,timestamp:n.timestamp},...a];insertOrAssignVariables({summary_history:e},{type:'script',script_id:t}),console.log(`‚úÖ Â∑≤ÂêåÊ≠•ÊÄªÁªìÊï∞ÊçÆ: Ê•ºÂ±Ç ${n.start_id}-${n.end_id}`)}}catch(n){console.error('Ëß£ÊûêÊÄªÁªìÊï∞ÊçÆÂ§±Ë¥•:',n)}window.toastr?.success('Êï∞ÊçÆÂêåÊ≠•ÂÆåÊàê'),console.log('‚úÖ Ëá™Âä®ÊÄªÁªìÊï∞ÊçÆÂêåÊ≠•ÂÆåÊàê')}catch(n){console.error('‚ùå ÂêåÊ≠•Êï∞ÊçÆÂ§±Ë¥•:',n),window.toastr?.error('ÂêåÊ≠•Â§±Ë¥•: '+n.message)}},window.autoDetectOldWindow=()=>{try{const n=SillyTavern.getCurrentChatId(),e=getLastMessageId(),t=getVariables({type:'chat'});return(void 0===t.auto_summary_start_id||null===t.auto_summary_start_id)&&e>0?(console.log(`üîç Ê£ÄÊµãÂà∞ËÄÅÁ™óÂè£: ËÅäÂ§©ID=${n}, Ê•ºÂ±ÇÊï∞=${e}`),window.handleOldWindow()):(console.log(`‚úÖ ÂΩìÂâçËÅäÂ§©Áä∂ÊÄÅÊ≠£Â∏∏: ËÅäÂ§©ID=${n}, Ê•ºÂ±ÇÊï∞=${e}`),null)}catch(n){return console.error('‚ùå Ëá™Âä®Ê£ÄÊµãËÄÅÁ™óÂè£Â§±Ë¥•:',n),null}},window.smartResetChat=()=>{try{insertOrAssignVariables({auto_summary_start_id:null},{type:'chat'}),console.log('üîÑ Â∑≤ÈáçÁΩÆÂΩìÂâçËÅäÂ§©Áä∂ÊÄÅÔºå‰∏ãÊ¨°Ê∂àÊÅØÊó∂Â∞ÜÈáçÊñ∞Êô∫ËÉΩËÆæÁΩÆ'),window.toastr?.success('Â∑≤ÈáçÁΩÆÂΩìÂâçËÅäÂ§©Áä∂ÊÄÅ')}catch(n){console.error('‚ùå ÈáçÁΩÆËÅäÂ§©Áä∂ÊÄÅÂ§±Ë¥•:',n),window.toastr?.error('ÈáçÁΩÆÂ§±Ë¥•: '+n.message)}},window.fixStartId=()=>{try{const n=SillyTavern.getCurrentChatId(),e=getLastMessageId(),t=getVariables({type:'chat'}).auto_summary_start_id;if(console.log('üîß ‰øÆÂ§çËµ∑ÂßãÊ•ºÂ±Ç:',{current_chat_id:n,last_message_id:e,current_start_id:t}),0===t||null==t){const n=e;insertOrAssignVariables({auto_summary_start_id:n},{type:'chat'}),console.log(`‚úÖ Â∑≤‰øÆÂ§çËµ∑ÂßãÊ•ºÂ±Ç: ${n}`),window.toastr?.success(`Â∑≤‰øÆÂ§çËµ∑ÂßãÊ•ºÂ±Ç: ${n}`)}else console.log(`‚úÖ Ëµ∑ÂßãÊ•ºÂ±ÇÊ≠£Â∏∏: ${t}`),window.toastr?.info(`Ëµ∑ÂßãÊ•ºÂ±ÇÊ≠£Â∏∏: ${t}`)}catch(n){console.error('‚ùå ‰øÆÂ§çËµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr?.error('‰øÆÂ§çÂ§±Ë¥•: '+n.message)}},window.checkMemoryUIConflict=()=>{try{const n=window.MemoryUI,e=(0,i.C)();console.log('üîç Ê£ÄÊü•MemoryUIÂÜ≤Á™Å:',{memoryUI_exists:!!n,memoryUI_autoSummarizeEnabled:n?.autoSummarizeEnabled,our_auto_summarize_enabled:e.settings.auto_summarize_enabled,our_summarize_interval:e.settings.summarize_interval}),n&&void 0!==n.autoSummarizeEnabled?(console.log('‚ö†Ô∏è Ê£ÄÊµãÂà∞MemoryUIÊèí‰ª∂ÔºåÂèØËÉΩÂ≠òÂú®ÂÜ≤Á™Å'),window.toastr?.warning('Ê£ÄÊµãÂà∞MemoryUIÊèí‰ª∂ÔºåÂª∫ËÆÆÂÖ≥Èó≠ÂÖ∂Ëá™Âä®ÊÄªÁªìÂäüËÉΩ‰ª•ÈÅøÂÖçÂÜ≤Á™Å')):(console.log('‚úÖ Êú™Ê£ÄÊµãÂà∞MemoryUIÂÜ≤Á™Å'),window.toastr?.info('Êú™Ê£ÄÊµãÂà∞MemoryUIÂÜ≤Á™Å'))}catch(n){console.error('‚ùå Ê£ÄÊü•MemoryUIÂÜ≤Á™ÅÂ§±Ë¥•:',n),window.toastr?.error('Ê£ÄÊü•Â§±Ë¥•: '+n.message)}},window.testFloorCalculation=()=>{try{const n=getLastMessageId(),e=getVariables({type:'chat'}).auto_summary_start_id||0,t=5;console.log('üßÆ Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅ:',{last_message_id:n,auto_summary_start_id:e,summarize_interval:t});for(let n=0;n<=15;n++){const o=n-e,a=o>=t-1&&o%t===t-1,r=e,s=n;console.log(`Ê•ºÂ±Ç ${n}: Áõ∏ÂØπ‰ΩçÁΩÆ=${o}, Ëß¶Âèë=${a}, ÊÄªÁªìËåÉÂõ¥=${r}-${s}`)}window.toastr?.info('Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅÂÆåÊàêÔºåËØ∑Êü•ÁúãÊéßÂà∂Âè∞')}catch(n){console.error('‚ùå Ê•ºÂ±ÇËÆ°ÁÆóÈ™åËØÅÂ§±Ë¥•:',n),window.toastr?.error('È™åËØÅÂ§±Ë¥•: '+n.message)}},window.resetAutoSummaryStart=()=>{try{const n=getScriptId(),e=SillyTavern.getCurrentChatId(),t=getLastMessageId();if(!e)return void window.toastr?.error('Êó†Ê≥ïËé∑ÂèñËÅäÂ§©ID');const o=getVariables({type:'script',script_id:n}).auto_summary_data||{};o[e]=t,insertOrAssignVariables({auto_summary_data:o},{type:'script',script_id:n}),console.log(`‚úÖ ÊâãÂä®ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±Ç‰∏∫: ${t} (ËÅäÂ§©: ${e})`),window.toastr?.success(`Ëµ∑ÂßãÊ•ºÂ±ÇÂ∑≤ÈáçÁΩÆ‰∏∫Á¨¨ ${t} Â±Ç`)}catch(n){console.error('‚ùå ÈáçÁΩÆËµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•:',n),window.toastr?.error('ÈáçÁΩÆÂ§±Ë¥•: '+n.message)}},window.clearCurrentChatData=()=>{try{insertOrAssignVariables({auto_summary_start_id:null},{type:'chat'}),console.log('üóëÔ∏è Â∑≤Ê∏ÖÁêÜÂΩìÂâçËÅäÂ§©Êï∞ÊçÆ'),window.toastr?.success('ÂΩìÂâçËÅäÂ§©Êï∞ÊçÆÂ∑≤Ê∏ÖÁêÜ')}catch(n){console.error('‚ùå Ê∏ÖÁêÜËÅäÂ§©Êï∞ÊçÆÂ§±Ë¥•:',n),window.toastr?.error('Ê∏ÖÁêÜÂ§±Ë¥•: '+n.message)}},window.watchChatId=()=>{let n=SillyTavern.getCurrentChatId();console.log('üîç ÂºÄÂßãÁõëÊéßËÅäÂ§©IDÂèòÂåñÔºåÂΩìÂâçID:',n);const e=setInterval(()=>{const e=SillyTavern.getCurrentChatId();e!==n&&(console.log('üîÑ ËÅäÂ§©IDÂèòÂåñ:',n,'->',e),n=e)},1e3);return()=>{clearInterval(e),console.log('‚èπÔ∏è ÂÅúÊ≠¢ÁõëÊéßËÅäÂ§©IDÂèòÂåñ')}},window.showCurrentChatData=()=>{try{const n=SillyTavern.getCurrentChatId(),e=getVariables({type:'chat'});return console.log('üìä ÂΩìÂâçËÅäÂ§©Êï∞ÊçÆ:',{current_chat_id:n,chat_vars:e,auto_summary_start_id:e.auto_summary_start_id}),window.toastr?.info(`Â∑≤ËæìÂá∫ÂΩìÂâçËÅäÂ§©Êï∞ÊçÆÂà∞ÊéßÂà∂Âè∞ÔºåËÅäÂ§©ID: ${n}`),e}catch(n){return console.error('‚ùå Êü•ÁúãËÅäÂ§©Êï∞ÊçÆÂ§±Ë¥•:',n),window.toastr?.error('Êü•ÁúãÂ§±Ë¥•: '+n.message),null}},window.handleOldWindow=()=>{try{const n=SillyTavern.getCurrentChatId(),e=getLastMessageId(),t=getVariables({type:'chat'}),o=getScriptId(),a=getVariables({type:'script',script_id:o}),r=a?.summary_history||[];if(console.log('üîç ËÄÅÁ™óÂè£ÂàÜÊûê:',{current_chat_id:n,last_message_id:e,chat_has_start_id:void 0!==t.auto_summary_start_id,existing_summaries_count:r.length,last_summary_end:r.length>0?r[0].end_id:'none'}),void 0===t.auto_summary_start_id||null===t.auto_summary_start_id){let n=e;if(r.length>0){const t=r[0].end_id||0;e>t?(n=t+1,console.log(`üîÑ ËÄÅÁ™óÂè£Êô∫ËÉΩËÆæÁΩÆ: ‰ªéÁ¨¨ ${n} Â±ÇÂºÄÂßã (ÊúÄÂêéÊÄªÁªìÁªìÊùü‰∫éÁ¨¨ ${t} Â±Ç)`)):console.log(`üîÑ ËÄÅÁ™óÂè£Êô∫ËÉΩËÆæÁΩÆ: ‰ªéÂΩìÂâçÊ•ºÂ±ÇÂºÄÂßã ${e} (ÂΩìÂâçÊ•ºÂ±ÇÂ∑≤ÊÄªÁªì)`)}else console.log(`üÜï ËÄÅÁ™óÂè£Êô∫ËÉΩËÆæÁΩÆ: ‰ªéÂΩìÂâçÊ•ºÂ±ÇÂºÄÂßã ${e} (Êó†Áé∞ÊúâÊÄªÁªì)`);insertOrAssignVariables({auto_summary_start_id:n},{type:'chat'}),window.toastr?.info(`ËÄÅÁ™óÂè£Â∑≤ÂàùÂßãÂåñÔºåËµ∑ÂßãÊ•ºÂ±Ç: ${n}`)}else console.log(`‚úÖ ËÄÅÁ™óÂè£Â∑≤ÊúâËµ∑ÂßãÊ•ºÂ±Ç: ${t.auto_summary_start_id}`),window.toastr?.info(`ËÄÅÁ™óÂè£Â∑≤ÊúâËµ∑ÂßãÊ•ºÂ±Ç: ${t.auto_summary_start_id}`);return{chat_id:n,last_message_id:e,auto_summary_start_id:t.auto_summary_start_id,existing_summaries:r.length}}catch(n){return console.error('‚ùå Â§ÑÁêÜËÄÅÁ™óÂè£Â§±Ë¥•:',n),window.toastr?.error('Â§ÑÁêÜÂ§±Ë¥•: '+n.message),null}},window.checkAutoSummaryStatus=()=>{try{const n=(0,i.C)();if(!n||!n.settings)return console.warn('‚ùå Êó†Ê≥ïËé∑ÂèñËÆæÁΩÆ'),null;const e=n.settings,t=getScriptId(),o=SillyTavern.getCurrentChatId(),a=getVariables({type:'script',script_id:t}),r=getLastMessageId(),s=a.auto_summary_data||{},l=s[o]||0,d=r-l+1,c=d%e.summarize_interval===0,p={current_chat_id:o,last_message_id:r,auto_summary_start_id:l,relative_position:d,summarize_interval:e.summarize_interval,should_trigger:c,calculation:`${d} % ${e.summarize_interval} = ${d%e.summarize_interval}`,auto_summarize_enabled:e.auto_summarize_enabled,api_key_set:!!e.api_key,all_chat_data:s};return console.log('üîç Ëá™Âä®ÊÄªÁªìÁä∂ÊÄÅ:',p),window.toastr?.info('Áä∂ÊÄÅÂ∑≤ËæìÂá∫Âà∞ÊéßÂà∂Âè∞'),p}catch(n){return console.error('‚ùå Ê£ÄÊü•Áä∂ÊÄÅÂ§±Ë¥•:',n),window.toastr?.error('Ê£ÄÊü•Â§±Ë¥•: '+n.message),null}};const e=(0,i.C)();if(e&&e.settings){const n=(0,s.watch)(()=>e.settings.auto_summarize_enabled,(n,e)=>{if(console.log(`üîÑ Ëá™Âä®ÊÄªÁªìËÆæÁΩÆÂèòÂåñ: ${e} -> ${n}`),n&&!e)try{const n=(0,l.Ut)();if(!n)return void console.warn('script_id ‰∏∫Á©∫ÔºåÊó†Ê≥ïÊ£ÄÊü•Ëµ∑ÂßãÊ•ºÂ±Ç');const e=getVariables({type:'script',script_id:n}).auto_summary_start_id;if(null==e){const e=getLastMessageId();insertOrAssignVariables({auto_summary_start_id:e},{type:'script',script_id:n}),console.log(`‚úÖ È¶ñÊ¨°ÂºÄÂêØËá™Âä®ÊÄªÁªìÔºåËµ∑ÂßãÊ•ºÂ±ÇËÆæÁΩÆ‰∏∫: ${e}`),window.toastr?.info(`Ëá™Âä®ÊÄªÁªìÂ∑≤ÂºÄÂêØÔºåÂ∞Ü‰ªéÁ¨¨ ${e} Â±ÇÂºÄÂßã`)}else console.log(`‚úÖ Ëá™Âä®ÊÄªÁªìÂ∑≤ÂºÄÂêØÔºå‰ΩøÁî®Áé∞ÊúâËµ∑ÂßãÊ•ºÂ±Ç: ${e}`),window.toastr?.info(`Ëá™Âä®ÊÄªÁªìÂ∑≤ÂºÄÂêØÔºåËµ∑ÂßãÊ•ºÂ±Ç: ${e}`)}catch(n){console.error('‚ùå Ê£ÄÊü•Ëµ∑ÂßãÊ•ºÂ±ÇÂ§±Ë¥•:',n)}},{immediate:!1});$(window).on('pagehide',()=>{n()})}window.toastr.success('mzrodyuÁå´Áå´ÁöÑÂ∞èÁ†¥ÁÉÇËÑöÊú¨Â∑≤Âä†ËΩΩ')},200)},100)});
//# sourceMappingURL=index.js.map